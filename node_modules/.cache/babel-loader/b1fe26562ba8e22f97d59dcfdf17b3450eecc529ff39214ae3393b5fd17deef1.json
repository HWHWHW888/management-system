{"ast":null,"code":"var _jsxFileName = \"/Users/user/Desktop/Cursor New Management System/management-system-1/Junket Management System Source Code/src/components/common/PhotoDisplay.tsx\";\nimport React from 'react';\nimport { Badge } from '../ui/badge';\nimport { ImageWithFallback } from '../figma/ImageWithFallback';\nimport { X, Download } from 'lucide-react';\n\n// CSS 样式用于自定义滚动条\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst scrollbarStyles = `\n  .photo-scroll-container::-webkit-scrollbar {\n    width: 6px;\n  }\n  .photo-scroll-container::-webkit-scrollbar-track {\n    background: #f7fafc;\n    border-radius: 3px;\n  }\n  .photo-scroll-container::-webkit-scrollbar-thumb {\n    background: #cbd5e0;\n    border-radius: 3px;\n  }\n  .photo-scroll-container::-webkit-scrollbar-thumb:hover {\n    background: #a0aec0;\n  }\n`;\n\n// 将样式注入到页面中\nif (typeof document !== 'undefined' && !document.getElementById('photo-scroll-styles')) {\n  const style = document.createElement('style');\n  style.id = 'photo-scroll-styles';\n  style.textContent = scrollbarStyles;\n  document.head.appendChild(style);\n}\nexport const PhotoDisplay = ({\n  photos,\n  type = 'transaction',\n  size = 'medium',\n  maxPhotos = 4,\n  onPhotoClick,\n  onPhotoDelete,\n  showDelete = true,\n  showDownload = false,\n  userRole = '',\n  customerName = ''\n}) => {\n  // 统一的照片数据验证\n  const isValidPhotoData = photoData => {\n    if (!photoData) return false;\n    return photoData.startsWith('data:image/') && !photoData.includes('base64,test') && photoData.length > 100;\n  };\n\n  // 过滤有效照片\n  const validPhotos = photos.filter(photo => {\n    var _photo$photo;\n    return ((_photo$photo = photo.photo) === null || _photo$photo === void 0 ? void 0 : _photo$photo.data) && isValidPhotoData(photo.photo.data);\n  });\n\n  // 显示的照片（限制数量）\n  const displayPhotos = validPhotos.slice(0, maxPhotos);\n\n  // 统一的尺寸样式\n  const getSizeClasses = () => {\n    switch (size) {\n      case 'small':\n        return 'h-20 w-full';\n      // 小尺寸：固定高度，全宽\n      case 'medium':\n        return 'h-24 w-full';\n      // 中尺寸：固定高度，全宽\n      case 'large':\n        return 'h-32 w-full';\n      // 大尺寸：固定高度，全宽\n      default:\n        return 'h-24 w-full';\n    }\n  };\n\n  // 网格布局类 - 移动优先设计\n  const getGridClasses = () => {\n    if (size === 'large') {\n      // 大尺寸照片 (ProjectManagement)\n      if (validPhotos.length === 1) return 'grid-cols-1';\n      return 'grid-cols-1 sm:grid-cols-2 lg:grid-cols-3';\n    } else {\n      // 中小尺寸照片 (StaffSelfService)\n      if (validPhotos.length === 1) return 'grid-cols-1';\n      return 'grid-cols-1 sm:grid-cols-2';\n    }\n  };\n\n  // 状态颜色\n  const getStatusBadgeClass = status => {\n    switch (status) {\n      case 'approved':\n        return 'bg-green-100 text-green-800';\n      case 'rejected':\n        return 'bg-red-100 text-red-800';\n      case 'pending':\n      default:\n        return 'bg-yellow-100 text-yellow-800';\n    }\n  };\n\n  // 下载照片功能\n  const handlePhotoDownload = photo => {\n    if (userRole !== 'admin') {\n      alert('只有管理员可以下载照片');\n      return;\n    }\n    try {\n      // 创建下载链接\n      const link = document.createElement('a');\n      link.href = photo.photo.data;\n\n      // 生成文件名：CustomerName.Type.Date\n      const timestamp = photo.transaction_date ? new Date(photo.transaction_date).toISOString().split('T')[0] : new Date().toISOString().split('T')[0];\n\n      // 清理客户名称，移除特殊字符\n      const cleanCustomerName = customerName ? customerName.replace(/[^a-zA-Z0-9\\u4e00-\\u9fff]/g, '_') : 'Customer';\n\n      // 首字母大写的类型\n      const typeCapitalized = type.charAt(0).toUpperCase() + type.slice(1);\n      const filename = `${cleanCustomerName}.${typeCapitalized}.${timestamp}.jpg`;\n      link.download = filename;\n      link.style.display = 'none';\n\n      // 添加到页面，点击下载，然后移除\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      console.log('✅ Photo downloaded:', filename);\n    } catch (error) {\n      console.error('Download failed:', error);\n      alert('下载失败，请重试');\n    }\n  };\n\n  // 默认点击处理（打开模态框）\n  const handlePhotoClick = photo => {\n    if (onPhotoClick) {\n      onPhotoClick(photo);\n      return;\n    }\n\n    // 默认模态框实现\n    const modal = document.createElement('div');\n    modal.className = 'fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50';\n    modal.innerHTML = `\n      <div class=\"relative max-w-4xl max-h-4xl p-4\">\n        <img src=\"${photo.photo.data}\" class=\"max-w-full max-h-full object-contain rounded\" />\n        <button class=\"absolute top-2 right-2 text-white bg-black bg-opacity-50 rounded-full w-8 h-8 flex items-center justify-center hover:bg-opacity-75\">×</button>\n        <div class=\"absolute bottom-2 left-2 text-white bg-black bg-opacity-50 px-2 py-1 rounded text-sm\">\n          ${photo.upload_date ? new Date(photo.upload_date).toLocaleDateString() : ''} \n          ${photo.status ? `- ${photo.status}` : ''}\n          ${photo.photo.filename ? `- ${photo.photo.filename}` : ''}\n        </div>\n      </div>\n    `;\n    document.body.appendChild(modal);\n    modal.addEventListener('click', e => {\n      const target = e.target;\n      if (target === modal || (target === null || target === void 0 ? void 0 : target.textContent) === '×') {\n        document.body.removeChild(modal);\n      }\n    });\n  };\n  if (displayPhotos.length === 0) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `${getSizeClasses()} bg-gray-100 rounded border flex items-center justify-center`,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-6 h-6 mx-auto mb-1 opacity-30\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            fill: \"currentColor\",\n            viewBox: \"0 0 20 20\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              fillRule: \"evenodd\",\n              d: \"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z\",\n              clipRule: \"evenodd\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs text-gray-400\",\n          children: \"No photo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-3\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-h-64 overflow-y-auto photo-scroll-container\",\n      style: {\n        scrollbarWidth: 'thin',\n        scrollbarColor: '#CBD5E0 #F7FAFC'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `grid ${getGridClasses()} gap-4 p-1`,\n        children: validPhotos.map((photo, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative group\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow duration-200\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative\",\n              children: [/*#__PURE__*/_jsxDEV(ImageWithFallback, {\n                src: photo.photo.data,\n                alt: `${type} ${index + 1}`,\n                className: `${getSizeClasses()} object-cover cursor-pointer w-full`,\n                onClick: () => handlePhotoClick(photo)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 229,\n                columnNumber: 19\n              }, this), photo.status && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute top-2 left-2\",\n                children: /*#__PURE__*/_jsxDEV(Badge, {\n                  className: `text-xs ${getStatusBadgeClass(photo.status)} shadow-sm`,\n                  children: photo.status.charAt(0).toUpperCase() + photo.status.slice(1)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 239,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute top-2 right-2 flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200\",\n                children: [showDownload && userRole === 'admin' && /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: e => {\n                    e.stopPropagation();\n                    handlePhotoDownload(photo);\n                  },\n                  className: \"bg-blue-500 hover:bg-blue-600 text-white rounded-full p-2 shadow-lg backdrop-blur-sm z-10 transition-colors\",\n                  title: \"\\u4E0B\\u8F7D\\u7167\\u7247\",\n                  children: /*#__PURE__*/_jsxDEV(Download, {\n                    className: \"w-3 h-3\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 257,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 249,\n                  columnNumber: 23\n                }, this), showDelete && onPhotoDelete && /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: e => {\n                    e.stopPropagation();\n                    if (window.confirm('确定要删除这张照片吗？')) {\n                      onPhotoDelete(photo.id);\n                    }\n                  },\n                  className: \"bg-red-500 hover:bg-red-600 text-white rounded-full p-2 shadow-lg backdrop-blur-sm z-10 transition-colors\",\n                  title: \"\\u5220\\u9664\\u7167\\u7247\",\n                  children: /*#__PURE__*/_jsxDEV(X, {\n                    className: \"w-3 h-3\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 272,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 262,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 228,\n              columnNumber: 17\n            }, this), photo.transaction_date && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"px-3 py-2 bg-gray-50 border-t\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs text-gray-600 text-center font-medium\",\n                children: new Date(photo.transaction_date).toLocaleDateString('zh-CN', {\n                  year: 'numeric',\n                  month: '2-digit',\n                  day: '2-digit'\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 281,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 280,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 15\n          }, this)\n        }, photo.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 7\n    }, this), validPhotos.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center space-x-2 text-xs text-gray-500 bg-gray-50 rounded-md py-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"font-medium\",\n        children: validPhotos.length\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: validPhotos.length === 1 ? 'photo' : 'photos'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 213,\n    columnNumber: 5\n  }, this);\n};\n_c = PhotoDisplay;\nvar _c;\n$RefreshReg$(_c, \"PhotoDisplay\");","map":{"version":3,"names":["React","Badge","ImageWithFallback","X","Download","jsxDEV","_jsxDEV","scrollbarStyles","document","getElementById","style","createElement","id","textContent","head","appendChild","PhotoDisplay","photos","type","size","maxPhotos","onPhotoClick","onPhotoDelete","showDelete","showDownload","userRole","customerName","isValidPhotoData","photoData","startsWith","includes","length","validPhotos","filter","photo","_photo$photo","data","displayPhotos","slice","getSizeClasses","getGridClasses","getStatusBadgeClass","status","handlePhotoDownload","alert","link","href","timestamp","transaction_date","Date","toISOString","split","cleanCustomerName","replace","typeCapitalized","charAt","toUpperCase","filename","download","display","body","click","removeChild","console","log","error","handlePhotoClick","modal","className","innerHTML","upload_date","toLocaleDateString","addEventListener","e","target","children","fill","viewBox","fillRule","d","clipRule","fileName","_jsxFileName","lineNumber","columnNumber","scrollbarWidth","scrollbarColor","map","index","src","alt","onClick","stopPropagation","title","window","confirm","year","month","day","_c","$RefreshReg$"],"sources":["/Users/user/Desktop/Cursor New Management System/management-system-1/Junket Management System Source Code/src/components/common/PhotoDisplay.tsx"],"sourcesContent":["import React from 'react';\nimport { Badge } from '../ui/badge';\nimport { ImageWithFallback } from '../figma/ImageWithFallback';\nimport { X, Download } from 'lucide-react';\n\n// CSS 样式用于自定义滚动条\nconst scrollbarStyles = `\n  .photo-scroll-container::-webkit-scrollbar {\n    width: 6px;\n  }\n  .photo-scroll-container::-webkit-scrollbar-track {\n    background: #f7fafc;\n    border-radius: 3px;\n  }\n  .photo-scroll-container::-webkit-scrollbar-thumb {\n    background: #cbd5e0;\n    border-radius: 3px;\n  }\n  .photo-scroll-container::-webkit-scrollbar-thumb:hover {\n    background: #a0aec0;\n  }\n`;\n\n// 将样式注入到页面中\nif (typeof document !== 'undefined' && !document.getElementById('photo-scroll-styles')) {\n  const style = document.createElement('style');\n  style.id = 'photo-scroll-styles';\n  style.textContent = scrollbarStyles;\n  document.head.appendChild(style);\n}\n\ninterface PhotoDisplayProps {\n  photos: Array<{\n    id: string;\n    photo: {\n      data: string;\n      filename?: string;\n      size?: number;\n      type?: string;\n    };\n    status?: string;\n    upload_date?: string;\n    transaction_date?: string;\n  }>;\n  type?: 'passport' | 'transaction' | 'rolling';\n  size?: 'small' | 'medium' | 'large';\n  maxPhotos?: number;\n  onPhotoClick?: (photo: any) => void;\n  onPhotoDelete?: (photoId: string) => void;\n  showDelete?: boolean;\n  showDownload?: boolean;\n  userRole?: string;\n  customerName?: string;\n}\n\nexport const PhotoDisplay: React.FC<PhotoDisplayProps> = ({\n  photos,\n  type = 'transaction',\n  size = 'medium',\n  maxPhotos = 4,\n  onPhotoClick,\n  onPhotoDelete,\n  showDelete = true,\n  showDownload = false,\n  userRole = '',\n  customerName = ''\n}) => {\n  // 统一的照片数据验证\n  const isValidPhotoData = (photoData: string) => {\n    if (!photoData) return false;\n    return photoData.startsWith('data:image/') && \n           !photoData.includes('base64,test') && \n           photoData.length > 100;\n  };\n\n  // 过滤有效照片\n  const validPhotos = photos.filter(photo => \n    photo.photo?.data && isValidPhotoData(photo.photo.data)\n  );\n\n  // 显示的照片（限制数量）\n  const displayPhotos = validPhotos.slice(0, maxPhotos);\n\n  // 统一的尺寸样式\n  const getSizeClasses = () => {\n    switch (size) {\n      case 'small':\n        return 'h-20 w-full'; // 小尺寸：固定高度，全宽\n      case 'medium':\n        return 'h-24 w-full'; // 中尺寸：固定高度，全宽\n      case 'large':\n        return 'h-32 w-full'; // 大尺寸：固定高度，全宽\n      default:\n        return 'h-24 w-full';\n    }\n  };\n\n  // 网格布局类 - 移动优先设计\n  const getGridClasses = () => {\n    if (size === 'large') {\n      // 大尺寸照片 (ProjectManagement)\n      if (validPhotos.length === 1) return 'grid-cols-1';\n      return 'grid-cols-1 sm:grid-cols-2 lg:grid-cols-3';\n    } else {\n      // 中小尺寸照片 (StaffSelfService)\n      if (validPhotos.length === 1) return 'grid-cols-1';\n      return 'grid-cols-1 sm:grid-cols-2';\n    }\n  };\n\n  // 状态颜色\n  const getStatusBadgeClass = (status?: string) => {\n    switch (status) {\n      case 'approved':\n        return 'bg-green-100 text-green-800';\n      case 'rejected':\n        return 'bg-red-100 text-red-800';\n      case 'pending':\n      default:\n        return 'bg-yellow-100 text-yellow-800';\n    }\n  };\n\n  // 下载照片功能\n  const handlePhotoDownload = (photo: any) => {\n    if (userRole !== 'admin') {\n      alert('只有管理员可以下载照片');\n      return;\n    }\n\n    try {\n      // 创建下载链接\n      const link = document.createElement('a');\n      link.href = photo.photo.data;\n      \n      // 生成文件名：CustomerName.Type.Date\n      const timestamp = photo.transaction_date ? \n        new Date(photo.transaction_date).toISOString().split('T')[0] : \n        new Date().toISOString().split('T')[0];\n      \n      // 清理客户名称，移除特殊字符\n      const cleanCustomerName = customerName ? \n        customerName.replace(/[^a-zA-Z0-9\\u4e00-\\u9fff]/g, '_') : \n        'Customer';\n      \n      // 首字母大写的类型\n      const typeCapitalized = type.charAt(0).toUpperCase() + type.slice(1);\n      \n      const filename = `${cleanCustomerName}.${typeCapitalized}.${timestamp}.jpg`;\n      \n      link.download = filename;\n      link.style.display = 'none';\n      \n      // 添加到页面，点击下载，然后移除\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      \n      console.log('✅ Photo downloaded:', filename);\n    } catch (error) {\n      console.error('Download failed:', error);\n      alert('下载失败，请重试');\n    }\n  };\n\n  // 默认点击处理（打开模态框）\n  const handlePhotoClick = (photo: any) => {\n    if (onPhotoClick) {\n      onPhotoClick(photo);\n      return;\n    }\n\n    // 默认模态框实现\n    const modal = document.createElement('div');\n    modal.className = 'fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50';\n    modal.innerHTML = `\n      <div class=\"relative max-w-4xl max-h-4xl p-4\">\n        <img src=\"${photo.photo.data}\" class=\"max-w-full max-h-full object-contain rounded\" />\n        <button class=\"absolute top-2 right-2 text-white bg-black bg-opacity-50 rounded-full w-8 h-8 flex items-center justify-center hover:bg-opacity-75\">×</button>\n        <div class=\"absolute bottom-2 left-2 text-white bg-black bg-opacity-50 px-2 py-1 rounded text-sm\">\n          ${photo.upload_date ? new Date(photo.upload_date).toLocaleDateString() : ''} \n          ${photo.status ? `- ${photo.status}` : ''}\n          ${photo.photo.filename ? `- ${photo.photo.filename}` : ''}\n        </div>\n      </div>\n    `;\n    \n    document.body.appendChild(modal);\n    modal.addEventListener('click', (e) => {\n      const target = e.target as HTMLElement;\n      if (target === modal || target?.textContent === '×') {\n        document.body.removeChild(modal);\n      }\n    });\n  };\n\n  if (displayPhotos.length === 0) {\n    return (\n      <div className={`${getSizeClasses()} bg-gray-100 rounded border flex items-center justify-center`}>\n        <div className=\"text-center\">\n          <div className=\"w-6 h-6 mx-auto mb-1 opacity-30\">\n            <svg fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fillRule=\"evenodd\" d=\"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z\" clipRule=\"evenodd\" />\n            </svg>\n          </div>\n          <p className=\"text-xs text-gray-400\">No photo</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-3\">\n      {/* 照片网格区域 */}\n      <div \n        className=\"max-h-64 overflow-y-auto photo-scroll-container\" \n        style={{\n          scrollbarWidth: 'thin',\n          scrollbarColor: '#CBD5E0 #F7FAFC'\n        }}\n      >\n        <div className={`grid ${getGridClasses()} gap-4 p-1`}>\n          {validPhotos.map((photo, index) => (\n            <div key={photo.id} className=\"relative group\">\n              {/* 照片卡片 */}\n              <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow duration-200\">\n                {/* 照片主体 */}\n                <div className=\"relative\">\n                  <ImageWithFallback\n                    src={photo.photo.data}\n                    alt={`${type} ${index + 1}`}\n                    className={`${getSizeClasses()} object-cover cursor-pointer w-full`}\n                    onClick={() => handlePhotoClick(photo)}\n                  />\n                  \n                  {/* 状态徽章 */}\n                  {photo.status && (\n                    <div className=\"absolute top-2 left-2\">\n                      <Badge className={`text-xs ${getStatusBadgeClass(photo.status)} shadow-sm`}>\n                        {photo.status.charAt(0).toUpperCase() + photo.status.slice(1)}\n                      </Badge>\n                    </div>\n                  )}\n                  \n                  {/* 操作按钮组 */}\n                  <div className=\"absolute top-2 right-2 flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200\">\n                    {/* 下载按钮 */}\n                    {showDownload && userRole === 'admin' && (\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          handlePhotoDownload(photo);\n                        }}\n                        className=\"bg-blue-500 hover:bg-blue-600 text-white rounded-full p-2 shadow-lg backdrop-blur-sm z-10 transition-colors\"\n                        title=\"下载照片\"\n                      >\n                        <Download className=\"w-3 h-3\" />\n                      </button>\n                    )}\n                    {/* 删除按钮 */}\n                    {showDelete && onPhotoDelete && (\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          if (window.confirm('确定要删除这张照片吗？')) {\n                            onPhotoDelete(photo.id);\n                          }\n                        }}\n                        className=\"bg-red-500 hover:bg-red-600 text-white rounded-full p-2 shadow-lg backdrop-blur-sm z-10 transition-colors\"\n                        title=\"删除照片\"\n                      >\n                        <X className=\"w-3 h-3\" />\n                      </button>\n                    )}\n                  </div>\n                </div>\n                \n                {/* 照片信息栏 */}\n                {photo.transaction_date && (\n                  <div className=\"px-3 py-2 bg-gray-50 border-t\">\n                    <div className=\"text-xs text-gray-600 text-center font-medium\">\n                      {new Date(photo.transaction_date).toLocaleDateString('zh-CN', {\n                        year: 'numeric',\n                        month: '2-digit',\n                        day: '2-digit'\n                      })}\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n      \n      {/* 照片统计信息 */}\n      {validPhotos.length > 0 && (\n        <div className=\"flex items-center justify-center space-x-2 text-xs text-gray-500 bg-gray-50 rounded-md py-2\">\n          <span className=\"font-medium\">{validPhotos.length}</span>\n          <span>{validPhotos.length === 1 ? 'photo' : 'photos'}</span>\n        </div>\n      )}\n    </div>\n  );\n};\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,KAAK,QAAQ,aAAa;AACnC,SAASC,iBAAiB,QAAQ,4BAA4B;AAC9D,SAASC,CAAC,EAAEC,QAAQ,QAAQ,cAAc;;AAE1C;AAAA,SAAAC,MAAA,IAAAC,OAAA;AACA,MAAMC,eAAe,GAAG;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,IAAI,OAAOC,QAAQ,KAAK,WAAW,IAAI,CAACA,QAAQ,CAACC,cAAc,CAAC,qBAAqB,CAAC,EAAE;EACtF,MAAMC,KAAK,GAAGF,QAAQ,CAACG,aAAa,CAAC,OAAO,CAAC;EAC7CD,KAAK,CAACE,EAAE,GAAG,qBAAqB;EAChCF,KAAK,CAACG,WAAW,GAAGN,eAAe;EACnCC,QAAQ,CAACM,IAAI,CAACC,WAAW,CAACL,KAAK,CAAC;AAClC;AA0BA,OAAO,MAAMM,YAAyC,GAAGA,CAAC;EACxDC,MAAM;EACNC,IAAI,GAAG,aAAa;EACpBC,IAAI,GAAG,QAAQ;EACfC,SAAS,GAAG,CAAC;EACbC,YAAY;EACZC,aAAa;EACbC,UAAU,GAAG,IAAI;EACjBC,YAAY,GAAG,KAAK;EACpBC,QAAQ,GAAG,EAAE;EACbC,YAAY,GAAG;AACjB,CAAC,KAAK;EACJ;EACA,MAAMC,gBAAgB,GAAIC,SAAiB,IAAK;IAC9C,IAAI,CAACA,SAAS,EAAE,OAAO,KAAK;IAC5B,OAAOA,SAAS,CAACC,UAAU,CAAC,aAAa,CAAC,IACnC,CAACD,SAAS,CAACE,QAAQ,CAAC,aAAa,CAAC,IAClCF,SAAS,CAACG,MAAM,GAAG,GAAG;EAC/B,CAAC;;EAED;EACA,MAAMC,WAAW,GAAGf,MAAM,CAACgB,MAAM,CAACC,KAAK;IAAA,IAAAC,YAAA;IAAA,OACrC,EAAAA,YAAA,GAAAD,KAAK,CAACA,KAAK,cAAAC,YAAA,uBAAXA,YAAA,CAAaC,IAAI,KAAIT,gBAAgB,CAACO,KAAK,CAACA,KAAK,CAACE,IAAI,CAAC;EAAA,CACzD,CAAC;;EAED;EACA,MAAMC,aAAa,GAAGL,WAAW,CAACM,KAAK,CAAC,CAAC,EAAElB,SAAS,CAAC;;EAErD;EACA,MAAMmB,cAAc,GAAGA,CAAA,KAAM;IAC3B,QAAQpB,IAAI;MACV,KAAK,OAAO;QACV,OAAO,aAAa;MAAE;MACxB,KAAK,QAAQ;QACX,OAAO,aAAa;MAAE;MACxB,KAAK,OAAO;QACV,OAAO,aAAa;MAAE;MACxB;QACE,OAAO,aAAa;IACxB;EACF,CAAC;;EAED;EACA,MAAMqB,cAAc,GAAGA,CAAA,KAAM;IAC3B,IAAIrB,IAAI,KAAK,OAAO,EAAE;MACpB;MACA,IAAIa,WAAW,CAACD,MAAM,KAAK,CAAC,EAAE,OAAO,aAAa;MAClD,OAAO,2CAA2C;IACpD,CAAC,MAAM;MACL;MACA,IAAIC,WAAW,CAACD,MAAM,KAAK,CAAC,EAAE,OAAO,aAAa;MAClD,OAAO,4BAA4B;IACrC;EACF,CAAC;;EAED;EACA,MAAMU,mBAAmB,GAAIC,MAAe,IAAK;IAC/C,QAAQA,MAAM;MACZ,KAAK,UAAU;QACb,OAAO,6BAA6B;MACtC,KAAK,UAAU;QACb,OAAO,yBAAyB;MAClC,KAAK,SAAS;MACd;QACE,OAAO,+BAA+B;IAC1C;EACF,CAAC;;EAED;EACA,MAAMC,mBAAmB,GAAIT,KAAU,IAAK;IAC1C,IAAIT,QAAQ,KAAK,OAAO,EAAE;MACxBmB,KAAK,CAAC,aAAa,CAAC;MACpB;IACF;IAEA,IAAI;MACF;MACA,MAAMC,IAAI,GAAGrC,QAAQ,CAACG,aAAa,CAAC,GAAG,CAAC;MACxCkC,IAAI,CAACC,IAAI,GAAGZ,KAAK,CAACA,KAAK,CAACE,IAAI;;MAE5B;MACA,MAAMW,SAAS,GAAGb,KAAK,CAACc,gBAAgB,GACtC,IAAIC,IAAI,CAACf,KAAK,CAACc,gBAAgB,CAAC,CAACE,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAC5D,IAAIF,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;;MAExC;MACA,MAAMC,iBAAiB,GAAG1B,YAAY,GACpCA,YAAY,CAAC2B,OAAO,CAAC,4BAA4B,EAAE,GAAG,CAAC,GACvD,UAAU;;MAEZ;MACA,MAAMC,eAAe,GAAGpC,IAAI,CAACqC,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,GAAGtC,IAAI,CAACoB,KAAK,CAAC,CAAC,CAAC;MAEpE,MAAMmB,QAAQ,GAAG,GAAGL,iBAAiB,IAAIE,eAAe,IAAIP,SAAS,MAAM;MAE3EF,IAAI,CAACa,QAAQ,GAAGD,QAAQ;MACxBZ,IAAI,CAACnC,KAAK,CAACiD,OAAO,GAAG,MAAM;;MAE3B;MACAnD,QAAQ,CAACoD,IAAI,CAAC7C,WAAW,CAAC8B,IAAI,CAAC;MAC/BA,IAAI,CAACgB,KAAK,CAAC,CAAC;MACZrD,QAAQ,CAACoD,IAAI,CAACE,WAAW,CAACjB,IAAI,CAAC;MAE/BkB,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEP,QAAQ,CAAC;IAC9C,CAAC,CAAC,OAAOQ,KAAK,EAAE;MACdF,OAAO,CAACE,KAAK,CAAC,kBAAkB,EAAEA,KAAK,CAAC;MACxCrB,KAAK,CAAC,UAAU,CAAC;IACnB;EACF,CAAC;;EAED;EACA,MAAMsB,gBAAgB,GAAIhC,KAAU,IAAK;IACvC,IAAIb,YAAY,EAAE;MAChBA,YAAY,CAACa,KAAK,CAAC;MACnB;IACF;;IAEA;IACA,MAAMiC,KAAK,GAAG3D,QAAQ,CAACG,aAAa,CAAC,KAAK,CAAC;IAC3CwD,KAAK,CAACC,SAAS,GAAG,4EAA4E;IAC9FD,KAAK,CAACE,SAAS,GAAG;AACtB;AACA,oBAAoBnC,KAAK,CAACA,KAAK,CAACE,IAAI;AACpC;AACA;AACA,YAAYF,KAAK,CAACoC,WAAW,GAAG,IAAIrB,IAAI,CAACf,KAAK,CAACoC,WAAW,CAAC,CAACC,kBAAkB,CAAC,CAAC,GAAG,EAAE;AACrF,YAAYrC,KAAK,CAACQ,MAAM,GAAG,KAAKR,KAAK,CAACQ,MAAM,EAAE,GAAG,EAAE;AACnD,YAAYR,KAAK,CAACA,KAAK,CAACuB,QAAQ,GAAG,KAAKvB,KAAK,CAACA,KAAK,CAACuB,QAAQ,EAAE,GAAG,EAAE;AACnE;AACA;AACA,KAAK;IAEDjD,QAAQ,CAACoD,IAAI,CAAC7C,WAAW,CAACoD,KAAK,CAAC;IAChCA,KAAK,CAACK,gBAAgB,CAAC,OAAO,EAAGC,CAAC,IAAK;MACrC,MAAMC,MAAM,GAAGD,CAAC,CAACC,MAAqB;MACtC,IAAIA,MAAM,KAAKP,KAAK,IAAI,CAAAO,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAE7D,WAAW,MAAK,GAAG,EAAE;QACnDL,QAAQ,CAACoD,IAAI,CAACE,WAAW,CAACK,KAAK,CAAC;MAClC;IACF,CAAC,CAAC;EACJ,CAAC;EAED,IAAI9B,aAAa,CAACN,MAAM,KAAK,CAAC,EAAE;IAC9B,oBACEzB,OAAA;MAAK8D,SAAS,EAAE,GAAG7B,cAAc,CAAC,CAAC,8DAA+D;MAAAoC,QAAA,eAChGrE,OAAA;QAAK8D,SAAS,EAAC,aAAa;QAAAO,QAAA,gBAC1BrE,OAAA;UAAK8D,SAAS,EAAC,iCAAiC;UAAAO,QAAA,eAC9CrE,OAAA;YAAKsE,IAAI,EAAC,cAAc;YAACC,OAAO,EAAC,WAAW;YAAAF,QAAA,eAC1CrE,OAAA;cAAMwE,QAAQ,EAAC,SAAS;cAACC,CAAC,EAAC,4FAA4F;cAACC,QAAQ,EAAC;YAAS;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC1I;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eACN9E,OAAA;UAAG8D,SAAS,EAAC,uBAAuB;UAAAO,QAAA,EAAC;QAAQ;UAAAM,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC9C;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAEV;EAEA,oBACE9E,OAAA;IAAK8D,SAAS,EAAC,WAAW;IAAAO,QAAA,gBAExBrE,OAAA;MACE8D,SAAS,EAAC,iDAAiD;MAC3D1D,KAAK,EAAE;QACL2E,cAAc,EAAE,MAAM;QACtBC,cAAc,EAAE;MAClB,CAAE;MAAAX,QAAA,eAEFrE,OAAA;QAAK8D,SAAS,EAAE,QAAQ5B,cAAc,CAAC,CAAC,YAAa;QAAAmC,QAAA,EAClD3C,WAAW,CAACuD,GAAG,CAAC,CAACrD,KAAK,EAAEsD,KAAK,kBAC5BlF,OAAA;UAAoB8D,SAAS,EAAC,gBAAgB;UAAAO,QAAA,eAE5CrE,OAAA;YAAK8D,SAAS,EAAC,qHAAqH;YAAAO,QAAA,gBAElIrE,OAAA;cAAK8D,SAAS,EAAC,UAAU;cAAAO,QAAA,gBACvBrE,OAAA,CAACJ,iBAAiB;gBAChBuF,GAAG,EAAEvD,KAAK,CAACA,KAAK,CAACE,IAAK;gBACtBsD,GAAG,EAAE,GAAGxE,IAAI,IAAIsE,KAAK,GAAG,CAAC,EAAG;gBAC5BpB,SAAS,EAAE,GAAG7B,cAAc,CAAC,CAAC,qCAAsC;gBACpEoD,OAAO,EAAEA,CAAA,KAAMzB,gBAAgB,CAAChC,KAAK;cAAE;gBAAA+C,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACxC,CAAC,EAGDlD,KAAK,CAACQ,MAAM,iBACXpC,OAAA;gBAAK8D,SAAS,EAAC,uBAAuB;gBAAAO,QAAA,eACpCrE,OAAA,CAACL,KAAK;kBAACmE,SAAS,EAAE,WAAW3B,mBAAmB,CAACP,KAAK,CAACQ,MAAM,CAAC,YAAa;kBAAAiC,QAAA,EACxEzC,KAAK,CAACQ,MAAM,CAACa,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,GAAGtB,KAAK,CAACQ,MAAM,CAACJ,KAAK,CAAC,CAAC;gBAAC;kBAAA2C,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACxD;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACL,CACN,eAGD9E,OAAA;gBAAK8D,SAAS,EAAC,yGAAyG;gBAAAO,QAAA,GAErHnD,YAAY,IAAIC,QAAQ,KAAK,OAAO,iBACnCnB,OAAA;kBACEqF,OAAO,EAAGlB,CAAC,IAAK;oBACdA,CAAC,CAACmB,eAAe,CAAC,CAAC;oBACnBjD,mBAAmB,CAACT,KAAK,CAAC;kBAC5B,CAAE;kBACFkC,SAAS,EAAC,6GAA6G;kBACvHyB,KAAK,EAAC,0BAAM;kBAAAlB,QAAA,eAEZrE,OAAA,CAACF,QAAQ;oBAACgE,SAAS,EAAC;kBAAS;oBAAAa,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC1B,CACT,EAEA7D,UAAU,IAAID,aAAa,iBAC1BhB,OAAA;kBACEqF,OAAO,EAAGlB,CAAC,IAAK;oBACdA,CAAC,CAACmB,eAAe,CAAC,CAAC;oBACnB,IAAIE,MAAM,CAACC,OAAO,CAAC,aAAa,CAAC,EAAE;sBACjCzE,aAAa,CAACY,KAAK,CAACtB,EAAE,CAAC;oBACzB;kBACF,CAAE;kBACFwD,SAAS,EAAC,2GAA2G;kBACrHyB,KAAK,EAAC,0BAAM;kBAAAlB,QAAA,eAEZrE,OAAA,CAACH,CAAC;oBAACiE,SAAS,EAAC;kBAAS;oBAAAa,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACnB,CACT;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACE,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC,EAGLlD,KAAK,CAACc,gBAAgB,iBACrB1C,OAAA;cAAK8D,SAAS,EAAC,+BAA+B;cAAAO,QAAA,eAC5CrE,OAAA;gBAAK8D,SAAS,EAAC,+CAA+C;gBAAAO,QAAA,EAC3D,IAAI1B,IAAI,CAACf,KAAK,CAACc,gBAAgB,CAAC,CAACuB,kBAAkB,CAAC,OAAO,EAAE;kBAC5DyB,IAAI,EAAE,SAAS;kBACfC,KAAK,EAAE,SAAS;kBAChBC,GAAG,EAAE;gBACP,CAAC;cAAC;gBAAAjB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACC;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CACN;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE;QAAC,GAlEElD,KAAK,CAACtB,EAAE;UAAAqE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAmEb,CACN;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,EAGLpD,WAAW,CAACD,MAAM,GAAG,CAAC,iBACrBzB,OAAA;MAAK8D,SAAS,EAAC,6FAA6F;MAAAO,QAAA,gBAC1GrE,OAAA;QAAM8D,SAAS,EAAC,aAAa;QAAAO,QAAA,EAAE3C,WAAW,CAACD;MAAM;QAAAkD,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAO,CAAC,eACzD9E,OAAA;QAAAqE,QAAA,EAAO3C,WAAW,CAACD,MAAM,KAAK,CAAC,GAAG,OAAO,GAAG;MAAQ;QAAAkD,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAO,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACzD,CACN;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV,CAAC;AAACe,EAAA,GAzPWnF,YAAyC;AAAA,IAAAmF,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}