{"ast":null,"code":"import React from'react';import{Badge}from'../ui/badge';import{ImageWithFallback}from'../figma/ImageWithFallback';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const PhotoDisplay=_ref=>{let{photos,type='transaction',size='medium',maxPhotos=4,onPhotoClick}=_ref;// 统一的照片数据验证\nconst isValidPhotoData=photoData=>{if(!photoData)return false;return photoData.startsWith('data:image/')&&!photoData.includes('base64,test')&&photoData.length>100;};// 过滤有效照片\nconst validPhotos=photos.filter(photo=>{var _photo$photo;return((_photo$photo=photo.photo)===null||_photo$photo===void 0?void 0:_photo$photo.data)&&isValidPhotoData(photo.photo.data);});// 显示的照片（限制数量）\nconst displayPhotos=validPhotos.slice(0,maxPhotos);// 统一的尺寸样式\nconst getSizeClasses=()=>{switch(size){case'small':return'h-16 w-16';// 64px x 64px\ncase'medium':return'h-24 w-24';// 96px x 96px  \ncase'large':return'h-32 w-32';// 128px x 128px\ndefault:return'h-24 w-24';}};// 网格布局类\nconst getGridClasses=()=>{if(displayPhotos.length===1)return'grid-cols-1';if(displayPhotos.length<=2)return'grid-cols-2';return'grid-cols-2';};// 状态颜色\nconst getStatusBadgeClass=status=>{switch(status){case'approved':return'bg-green-100 text-green-800';case'rejected':return'bg-red-100 text-red-800';case'pending':default:return'bg-yellow-100 text-yellow-800';}};// 默认点击处理（打开模态框）\nconst handlePhotoClick=photo=>{if(onPhotoClick){onPhotoClick(photo);return;}// 默认模态框实现\nconst modal=document.createElement('div');modal.className='fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50';modal.innerHTML=\"\\n      <div class=\\\"relative max-w-4xl max-h-4xl p-4\\\">\\n        <img src=\\\"\".concat(photo.photo.data,\"\\\" class=\\\"max-w-full max-h-full object-contain rounded\\\" />\\n        <button class=\\\"absolute top-2 right-2 text-white bg-black bg-opacity-50 rounded-full w-8 h-8 flex items-center justify-center hover:bg-opacity-75\\\">\\xD7</button>\\n        <div class=\\\"absolute bottom-2 left-2 text-white bg-black bg-opacity-50 px-2 py-1 rounded text-sm\\\">\\n          \").concat(photo.upload_date?new Date(photo.upload_date).toLocaleDateString():'',\" \\n          \").concat(photo.status?\"- \".concat(photo.status):'',\"\\n          \").concat(photo.photo.filename?\"- \".concat(photo.photo.filename):'',\"\\n        </div>\\n      </div>\\n    \");document.body.appendChild(modal);modal.addEventListener('click',e=>{const target=e.target;if(target===modal||(target===null||target===void 0?void 0:target.textContent)==='×'){document.body.removeChild(modal);}});};if(displayPhotos.length===0){return/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(getSizeClasses(),\" bg-gray-100 rounded border flex items-center justify-center\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-6 h-6 mx-auto mb-1 opacity-30\",children:/*#__PURE__*/_jsx(\"svg\",{fill:\"currentColor\",viewBox:\"0 0 20 20\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z\",clipRule:\"evenodd\"})})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400\",children:\"No photo\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid \".concat(getGridClasses(),\" gap-2\"),children:displayPhotos.map((photo,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"relative group cursor-pointer\",children:[/*#__PURE__*/_jsx(ImageWithFallback,{src:photo.photo.data,alt:\"\".concat(type,\" \").concat(index+1),className:\"\".concat(getSizeClasses(),\" object-cover rounded border hover:border-blue-300 transition-colors\"),onClick:()=>handlePhotoClick(photo)}),photo.status&&/*#__PURE__*/_jsx(Badge,{className:\"absolute bottom-1 right-1 text-xs \".concat(getStatusBadgeClass(photo.status)),children:photo.status.charAt(0).toUpperCase()+photo.status.slice(1)})]},photo.id))}),validPhotos.length>maxPhotos&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500 text-center\",children:[\"+\",validPhotos.length-maxPhotos,\" more photos\"]})]});};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}