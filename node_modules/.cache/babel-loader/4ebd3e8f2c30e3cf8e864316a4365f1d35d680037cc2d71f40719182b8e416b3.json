{"ast":null,"code":"import _objectSpread from\"/Users/user/Desktop/Cursor New Management System/management-system-1/Junket Management System Source Code/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback}from'react';import{Button}from'./ui/button';import{Input}from'./ui/input';import{Label}from'./ui/label';import{Card,CardContent,CardDescription,CardHeader,CardTitle}from'./ui/card';import{Dialog,DialogContent,DialogDescription,DialogHeader,DialogTitle,DialogTrigger}from'./ui/dialog';import{Badge}from'./ui/badge';import{Textarea}from'./ui/textarea';import{Tabs,TabsContent,TabsList,TabsTrigger}from'./ui/tabs';import{Database,Clock,CheckCircle,XCircle,RefreshCw,LogIn,LogOut,Activity,AlertCircle,Info,BarChart3,Calendar}from'lucide-react';import{ImageWithFallback}from'./figma/ImageWithFallback';import{StaffRollingRecorder}from'./StaffRollingRecorder';import{StaffRollingHistory}from'./StaffRollingHistory';import{withErrorHandler}from'./withErrorHandler';import{db}from'../utils/api/databaseWrapper';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";// Real-time refresh interval (30 seconds)\nconst REAL_TIME_REFRESH_INTERVAL=30000;function StaffPortalComponent(_ref){var _currentStaffMember$c;let{user,showError,clearError}=_ref;const[staff,setStaff]=useState([]);const[shifts,setShifts]=useState([]);const[customers,setCustomers]=useState([]);const[gameTypes,setGameTypes]=useState([]);const[currentStaffMember,setCurrentStaffMember]=useState(null);const[isCheckInDialogOpen,setIsCheckInDialogOpen]=useState(false);const[isCheckOutDialogOpen,setIsCheckOutDialogOpen]=useState(false);const[checkInPhoto,setCheckInPhoto]=useState(null);const[checkOutPhoto,setCheckOutPhoto]=useState(null);const[checkInNotes,setCheckInNotes]=useState('');const[checkOutNotes,setCheckOutNotes]=useState('');const[isLoadingData,setIsLoadingData]=useState(true);const[lastDataUpdate,setLastDataUpdate]=useState(null);const[isSaving,setIsSaving]=useState(false);// Load real-time data from Supabase\nconst loadRealTimeData=useCallback(async()=>{try{setIsLoadingData(true);clearError();console.log('🔄 Loading real-time staff portal data from Supabase...');// Load all required data in parallel\nconst[staffData,shiftsData,customersData,gameTypesData]=await Promise.all([db.get('staff',[]),db.get('staff_shifts',[]),db.get('customers',[]),db.get('game_types',[])]);setStaff(staffData);setShifts(shiftsData);setCustomers(customersData);setGameTypes(gameTypesData);setLastDataUpdate(new Date());// Find current staff member\nif(user.staffId){let staffMember=staffData.find(s=>s.id===user.staffId);if(!staffMember){// Create a new staff record for this user if it doesn't exist\nstaffMember={id:user.staffId,name:\"\".concat(user.username,\" (Auto-created)\"),email:\"\".concat(user.username,\"@casino.com\"),phone:'+852-0000-0000',position:'Staff Member',createdAt:new Date().toISOString().split('T')[0],isActive:true,attachments:[]};const updatedStaff=[...staffData,staffMember];await db.save('staff',updatedStaff);setStaff(updatedStaff);}// Check for current shift\nconst currentShift=shiftsData.find(shift=>shift.staffId===staffMember.id&&shift.status==='checked-in');if(currentShift){staffMember=_objectSpread(_objectSpread({},staffMember),{},{currentShift});}setCurrentStaffMember(staffMember);}console.log(\"\\u2705 Loaded real-time data: \".concat(staffData.length,\" staff, \").concat(customersData.length,\" customers, \").concat(shiftsData.length,\" shifts\"));}catch(error){console.error('❌ Error loading real-time staff portal data:',error);const errorMessage=error instanceof Error?error.message:'Unknown error occurred';showError(\"Failed to load staff portal data: \".concat(errorMessage));}finally{setIsLoadingData(false);}},[user.staffId,user.username,clearError,showError]);// Initial data load and real-time sync\nuseEffect(()=>{loadRealTimeData();// Set up real-time refresh interval\nconst refreshInterval=setInterval(()=>{console.log('🔄 Real-time staff portal refresh triggered');loadRealTimeData();},REAL_TIME_REFRESH_INTERVAL);return()=>{clearInterval(refreshInterval);};},[loadRealTimeData]);const saveStaffToSupabase=async updatedStaff=>{try{await db.save('staff',updatedStaff);setStaff(updatedStaff);console.log('✅ Staff data saved to Supabase');}catch(error){console.error('❌ Error saving staff data:',error);const errorMessage=error instanceof Error?error.message:'Unknown error occurred';showError(\"Failed to save staff data: \".concat(errorMessage));}};const saveShiftsToSupabase=async updatedShifts=>{try{await db.save('shifts',updatedShifts);setShifts(updatedShifts);console.log('✅ Shifts data saved to Supabase');}catch(error){console.error('❌ Error saving shifts data:',error);const errorMessage=error instanceof Error?error.message:'Unknown error occurred';showError(\"Failed to save shifts data: \".concat(errorMessage));}};const isCheckedIn=()=>{return(currentStaffMember===null||currentStaffMember===void 0?void 0:currentStaffMember.currentShift)&&currentStaffMember.currentShift.status==='checked-in';};const handleCheckIn=async()=>{if(!currentStaffMember||!checkInPhoto)return;setIsSaving(true);try{// Convert photo to base64\nconst reader=new FileReader();reader.onload=async e=>{try{var _e$target;const photoAttachment={id:\"photo_\".concat(Date.now()),name:checkInPhoto.name,size:checkInPhoto.size,type:checkInPhoto.type,data:(_e$target=e.target)===null||_e$target===void 0?void 0:_e$target.result,uploadedAt:new Date().toISOString(),uploadedBy:user.username};const newShift={id:\"shift_\".concat(Date.now()),staffId:currentStaffMember.id,checkInTime:new Date().toISOString(),checkInPhoto:photoAttachment,shiftDate:new Date().toISOString().split('T')[0],status:'checked-in',notes:checkInNotes};const updatedShifts=[...shifts,newShift];await saveShiftsToSupabase(updatedShifts);// Update staff current shift\nconst updatedStaff=staff.map(member=>member.id===currentStaffMember.id?_objectSpread(_objectSpread({},member),{},{currentShift:newShift}):member);await saveStaffToSupabase(updatedStaff);setCurrentStaffMember(_objectSpread(_objectSpread({},currentStaffMember),{},{currentShift:newShift}));setIsCheckInDialogOpen(false);setCheckInPhoto(null);setCheckInNotes('');// Refresh data after check-in\nawait loadRealTimeData();}catch(error){console.error('❌ Error during check-in:',error);const errorMessage=error instanceof Error?error.message:'Unknown error occurred';showError(\"Check-in failed: \".concat(errorMessage));}finally{setIsSaving(false);}};reader.readAsDataURL(checkInPhoto);}catch(error){console.error('❌ Error during check-in:',error);const errorMessage=error instanceof Error?error.message:'Unknown error occurred';showError(\"Check-in failed: \".concat(errorMessage));setIsSaving(false);}};const handleCheckOut=async()=>{if(!currentStaffMember||!checkOutPhoto||!currentStaffMember.currentShift)return;setIsSaving(true);try{// Convert photo to base64\nconst reader=new FileReader();reader.onload=async e=>{try{var _e$target2;const photoAttachment={id:\"photo_\".concat(Date.now()),name:checkOutPhoto.name,size:checkOutPhoto.size,type:checkOutPhoto.type,data:(_e$target2=e.target)===null||_e$target2===void 0?void 0:_e$target2.result,uploadedAt:new Date().toISOString(),uploadedBy:user.username};const updatedShift=_objectSpread(_objectSpread({},currentStaffMember.currentShift),{},{checkOutTime:new Date().toISOString(),checkOutPhoto:photoAttachment,status:'checked-out',notes:currentStaffMember.currentShift.notes+(checkOutNotes?\"\\nCheck-out: \".concat(checkOutNotes):'')});const updatedShifts=shifts.map(shift=>shift.id===updatedShift.id?updatedShift:shift);await saveShiftsToSupabase(updatedShifts);// Remove current shift from staff\nconst updatedStaff=staff.map(member=>member.id===currentStaffMember.id?_objectSpread(_objectSpread({},member),{},{currentShift:undefined}):member);await saveStaffToSupabase(updatedStaff);setCurrentStaffMember(_objectSpread(_objectSpread({},currentStaffMember),{},{currentShift:undefined}));setIsCheckOutDialogOpen(false);setCheckOutPhoto(null);setCheckOutNotes('');// Refresh data after check-out\nawait loadRealTimeData();}catch(error){console.error('❌ Error during check-out:',error);const errorMessage=error instanceof Error?error.message:'Unknown error occurred';showError(\"Check-out failed: \".concat(errorMessage));}finally{setIsSaving(false);}};reader.readAsDataURL(checkOutPhoto);}catch(error){console.error('❌ Error during check-out:',error);const errorMessage=error instanceof Error?error.message:'Unknown error occurred';showError(\"Check-out failed: \".concat(errorMessage));setIsSaving(false);}};const getMyShifts=()=>{if(!currentStaffMember)return[];return shifts.filter(shift=>shift.staffId===currentStaffMember.id).sort((a,b)=>new Date(b.checkInTime).getTime()-new Date(a.checkInTime).getTime()).slice(0,10);// Show last 10 shifts\n};const myShifts=getMyShifts();const handleRollingRecordSaved=async record=>{// Refresh real-time data after saving a rolling record\nawait loadRealTimeData();};// Show loading state\nif(isLoadingData&&!currentStaffMember){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-64\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Loading real-time staff portal data from Supabase...\"})]})});}if(!currentStaffMember){return/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-12 h-12 mx-auto text-red-400 mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-2\",children:\"Staff Record Not Found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 mb-4\",children:\"Your staff record could not be found or created automatically.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-left bg-gray-50 p-4 rounded-lg max-w-md mx-auto\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-sm text-gray-900 mb-2\",children:\"Debug Information:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-xs text-gray-600 space-y-1\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[\"User ID: \",user.id]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"Staff ID: \",user.staffId||'Not assigned']}),/*#__PURE__*/_jsxs(\"li\",{children:[\"Username: \",user.username]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"Role: \",user.role]})]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400 mt-4\",children:\"Please contact an administrator to create your staff record.\"})]})})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-green-50 border border-green-200 rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(Database,{className:\"w-4 h-4 text-green-600 mr-2\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-green-800\",children:\"\\u2705 Real-time Staff Portal Connected to Supabase\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-green-600\",children:[\"Customer data, shifts, and rolling records sync automatically with cloud database\",lastDataUpdate&&\" \\u2022 Last sync: \".concat(lastDataUpdate.toLocaleTimeString())]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[isSaving&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-blue-600\",children:[/*#__PURE__*/_jsx(Activity,{className:\"w-4 h-4 mr-1 animate-pulse\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs\",children:\"Saving...\"})]}),isLoadingData&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-orange-600\",children:[/*#__PURE__*/_jsx(RefreshCw,{className:\"w-4 h-4 mr-1 animate-spin\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs\",children:\"Syncing...\"})]}),/*#__PURE__*/_jsxs(Button,{variant:\"outline\",size:\"sm\",onClick:loadRealTimeData,disabled:isSaving||isLoadingData,className:\"text-xs\",children:[/*#__PURE__*/_jsx(RefreshCw,{className:\"w-3 h-3 mr-1\"}),\"Refresh\"]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold\",children:\"Staff Portal\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"Welcome, \",currentStaffMember.name,\" - \",currentStaffMember.position]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4 mt-1\",children:[/*#__PURE__*/_jsxs(Badge,{variant:\"outline\",className:\"text-xs\",children:[customers.filter(c=>c.isActive).length,\" Active Customers\"]}),/*#__PURE__*/_jsx(Badge,{variant:\"outline\",className:\"text-xs\",children:\"Okada Casino Only\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-3\",children:isCheckedIn()?/*#__PURE__*/_jsx(StaffRollingRecorder,{user:user,currentStaff:currentStaffMember,customers:customers,gameTypes:gameTypes,onRecordSaved:handleRollingRecordSaved,showError:showError,clearError:clearError}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Check in to record rolling amounts\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400\",children:\"Real-time customer data available after check-in\"})]})})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsxs(CardTitle,{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Clock,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Current Status\"}),isCheckedIn()&&/*#__PURE__*/_jsxs(Badge,{className:\"bg-green-100 text-green-800\",children:[/*#__PURE__*/_jsx(Activity,{className:\"w-3 h-3 mr-1\"}),\"Live Recording Available\"]})]})}),/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-4\",children:isCheckedIn()?/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col space-y-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(Badge,{className:\"bg-green-100 text-green-800 px-3 py-1\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4 mr-1\"}),\"On Duty\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-600\",children:[\"Since: \",new Date(currentStaffMember.currentShift.checkInTime).toLocaleString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[\"Shift Date: \",currentStaffMember.currentShift.shiftDate,\" | Duration: \",Math.floor((new Date().getTime()-new Date(currentStaffMember.currentShift.checkInTime).getTime())/(1000*60)),\" minutes\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-green-600\",children:\"\\u2705 Real-time rolling recording enabled with buy-in/buy-out tracking\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(Badge,{variant:\"secondary\",className:\"px-3 py-1\",children:[/*#__PURE__*/_jsx(XCircle,{className:\"w-4 h-4 mr-1\"}),\"Off Duty\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Ready to check in\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex space-x-2\",children:isCheckedIn()?/*#__PURE__*/_jsxs(Dialog,{open:isCheckOutDialogOpen,onOpenChange:setIsCheckOutDialogOpen,children:[/*#__PURE__*/_jsx(DialogTrigger,{asChild:true,children:/*#__PURE__*/_jsxs(Button,{variant:\"destructive\",disabled:isSaving,children:[/*#__PURE__*/_jsx(LogOut,{className:\"w-4 h-4 mr-2\"}),\"Check Out\"]})}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsxs(DialogHeader,{children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Check Out\"}),/*#__PURE__*/_jsx(DialogDescription,{children:\"Upload a photo as proof of check-out and add any end-of-shift notes. Data will be saved to Supabase.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"checkOutPhoto\",children:\"Check-out Photo (Required)\"}),/*#__PURE__*/_jsx(Input,{id:\"checkOutPhoto\",type:\"file\",accept:\"image/*\",onChange:e=>{var _e$target$files;return setCheckOutPhoto(((_e$target$files=e.target.files)===null||_e$target$files===void 0?void 0:_e$target$files[0])||null);},className:\"mt-1\",required:true,disabled:isSaving}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"\\uD83D\\uDCF8 Take a photo as proof of check-out (camera will open on mobile)\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"checkOutNotes\",children:\"End of Shift Notes (Optional)\"}),/*#__PURE__*/_jsx(Textarea,{id:\"checkOutNotes\",value:checkOutNotes,onChange:e=>setCheckOutNotes(e.target.value),placeholder:\"Any end-of-shift notes or handover information...\",rows:3,disabled:isSaving})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-2\",children:[/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"outline\",onClick:()=>setIsCheckOutDialogOpen(false),disabled:isSaving,children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handleCheckOut,disabled:!checkOutPhoto||isSaving,children:isSaving?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Activity,{className:\"w-4 h-4 mr-2 animate-spin\"}),\"Saving...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(LogOut,{className:\"w-4 h-4 mr-2\"}),\"Check Out\"]})})]})]})]})]}):/*#__PURE__*/_jsxs(Dialog,{open:isCheckInDialogOpen,onOpenChange:setIsCheckInDialogOpen,children:[/*#__PURE__*/_jsx(DialogTrigger,{asChild:true,children:/*#__PURE__*/_jsxs(Button,{disabled:isSaving,children:[/*#__PURE__*/_jsx(LogIn,{className:\"w-4 h-4 mr-2\"}),\"Check In\"]})}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsxs(DialogHeader,{children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Check In\"}),/*#__PURE__*/_jsx(DialogDescription,{children:\"Upload a photo as proof of check-in and add any notes for the shift. Data will be saved to Supabase.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"checkInPhoto\",children:\"Check-in Photo (Required)\"}),/*#__PURE__*/_jsx(Input,{id:\"checkInPhoto\",type:\"file\",accept:\"image/*\",onChange:e=>{var _e$target$files2;return setCheckInPhoto(((_e$target$files2=e.target.files)===null||_e$target$files2===void 0?void 0:_e$target$files2[0])||null);},className:\"mt-1\",required:true,disabled:isSaving}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"\\uD83D\\uDCF8 Take a photo as proof of check-in (camera will open on mobile)\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"checkInNotes\",children:\"Notes (Optional)\"}),/*#__PURE__*/_jsx(Textarea,{id:\"checkInNotes\",value:checkInNotes,onChange:e=>setCheckInNotes(e.target.value),placeholder:\"Any notes for this shift...\",rows:3,disabled:isSaving})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-2\",children:[/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"outline\",onClick:()=>setIsCheckInDialogOpen(false),disabled:isSaving,children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handleCheckIn,disabled:!checkInPhoto||isSaving,children:isSaving?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Activity,{className:\"w-4 h-4 mr-2 animate-spin\"}),\"Saving...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(LogIn,{className:\"w-4 h-4 mr-2\"}),\"Check In\"]})})]})]})]})]})})]}),isCheckedIn()&&((_currentStaffMember$c=currentStaffMember.currentShift)===null||_currentStaffMember$c===void 0?void 0:_currentStaffMember$c.notes)&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-3 bg-green-50 rounded-md\",children:[/*#__PURE__*/_jsx(Label,{className:\"text-sm font-medium text-green-700\",children:\"Current Shift Notes\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-green-600 mt-1\",children:currentStaffMember.currentShift.notes})]})]})]}),!isCheckedIn()&&/*#__PURE__*/_jsxs(Card,{className:\"border-blue-200 bg-blue-50\",children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsxs(CardTitle,{className:\"flex items-center space-x-2 text-blue-800\",children:[/*#__PURE__*/_jsx(Info,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Enhanced Staff Portal Features\"})]})}),/*#__PURE__*/_jsx(CardContent,{className:\"text-blue-700\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:\"Welcome to the enhanced Staff Portal with real-time capabilities:\"}),/*#__PURE__*/_jsxs(\"ol\",{className:\"text-sm space-y-2 list-decimal list-inside\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Check In:\"}),\" Click \\\"Check In\\\" and upload a photo as proof of arrival\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Real-time Rolling Recording:\"}),\" Record customer rolling amounts with mandatory buy-in/buy-out tracking\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Okada Casino Integration:\"}),\" All recordings are automatically tagged with Okada Casino venue\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Live Customer Data:\"}),\" Customer availability updates in real-time from cloud database\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Admin Oversight:\"}),\" Buy-in/buy-out amounts required for complete financial tracking\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Enhanced OCR:\"}),\" Upload receipts for automatic data extraction including cash flow\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 p-3 bg-blue-100 rounded-lg\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-blue-600\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Note:\"}),\" All data is immediately saved to Supabase cloud database for real-time synchronization across all systems and admin oversight.\"]})})]})})]}),/*#__PURE__*/_jsxs(Tabs,{defaultValue:\"shifts\",className:\"w-full\",children:[/*#__PURE__*/_jsxs(TabsList,{className:\"grid w-full grid-cols-2\",children:[/*#__PURE__*/_jsxs(TabsTrigger,{value:\"shifts\",className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Calendar,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Recent Shifts\"})]}),/*#__PURE__*/_jsxs(TabsTrigger,{value:\"rolling\",className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(BarChart3,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Rolling Records\"})]})]}),/*#__PURE__*/_jsx(TabsContent,{value:\"shifts\",className:\"mt-6\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(CardHeader,{children:[/*#__PURE__*/_jsxs(CardTitle,{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Calendar,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Recent Shifts\"}),/*#__PURE__*/_jsx(Badge,{variant:\"outline\",className:\"text-xs\",children:\"Real-time from Supabase\"})]}),/*#__PURE__*/_jsx(CardDescription,{children:\"Your last 10 shifts with real-time updates\"})]}),/*#__PURE__*/_jsx(CardContent,{children:myShifts.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsx(Clock,{className:\"w-12 h-12 mx-auto text-gray-400 mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"No shift history found.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400 mt-2\",children:\"Your shifts will appear here once you start checking in.\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:myShifts.map(shift=>/*#__PURE__*/_jsx(Card,{className:\"border-l-4 border-l-blue-400\",children:/*#__PURE__*/_jsxs(CardContent,{className:\"p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Calendar,{className:\"w-4 h-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:shift.shiftDate})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Badge,{className:shift.status==='checked-in'?'bg-green-100 text-green-800':'bg-gray-100 text-gray-800',children:shift.status==='checked-in'?'On Duty':'Completed'}),/*#__PURE__*/_jsx(Badge,{variant:\"outline\",className:\"text-xs\",children:\"Supabase\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{className:\"text-xs text-gray-500\",children:\"Check-in Time\"}),/*#__PURE__*/_jsx(\"p\",{children:new Date(shift.checkInTime).toLocaleString()}),shift.checkInPhoto&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2\",children:/*#__PURE__*/_jsx(ImageWithFallback,{src:shift.checkInPhoto.data,alt:\"Check-in proof\",className:\"w-16 h-16 object-cover rounded border\"})})]}),shift.checkOutTime&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{className:\"text-xs text-gray-500\",children:\"Check-out Time\"}),/*#__PURE__*/_jsx(\"p\",{children:new Date(shift.checkOutTime).toLocaleString()}),shift.checkOutPhoto&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2\",children:/*#__PURE__*/_jsx(ImageWithFallback,{src:shift.checkOutPhoto.data,alt:\"Check-out proof\",className:\"w-16 h-16 object-cover rounded border\"})})]})]}),shift.notes&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 p-2 bg-gray-50 rounded text-xs\",children:[/*#__PURE__*/_jsx(Label,{className:\"text-gray-500\",children:\"Notes\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 mt-1\",children:shift.notes})]})]})},shift.id))})})]})}),/*#__PURE__*/_jsx(TabsContent,{value:\"rolling\",className:\"mt-6\",children:/*#__PURE__*/_jsx(StaffRollingHistory,{user:user,currentStaff:currentStaffMember,showError:showError,clearError:clearError})})]})]});}// Export with error handler wrapper\nexport const StaffPortal=withErrorHandler(StaffPortalComponent);","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}