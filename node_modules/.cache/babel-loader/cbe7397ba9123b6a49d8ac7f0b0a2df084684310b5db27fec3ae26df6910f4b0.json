{"ast":null,"code":"var _jsxFileName = \"/Users/user/Desktop/Cursor New Management System/management-system-1/Junket Management System Source Code/src/components/StaffSelfService.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Label } from './ui/label';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from './ui/card';\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from './ui/dialog';\nimport { Badge } from './ui/badge';\nimport { Textarea } from './ui/textarea';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from './ui/tabs';\nimport { Clock, CheckCircle, XCircle, RefreshCw, LogIn, LogOut, Activity, Calendar, MapPin, Users, Camera, DollarSign, Loader2, ChevronUp, ChevronDown } from 'lucide-react';\nimport { ImageWithFallback } from './figma/ImageWithFallback';\nimport { PhotoDisplay } from './common/PhotoDisplay';\nimport { withErrorHandler } from './withErrorHandler';\nimport { apiClient } from '../utils/api/apiClient';\nimport { DSContainer, DSHeader, DSButton, DSNotification, iconSizes } from './common/DesignSystem';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction StaffSelfServiceComponent({\n  user,\n  showError,\n  clearError\n}) {\n  _s();\n  const [currentStaff, setCurrentStaff] = useState(null);\n  const [shifts, setShifts] = useState([]);\n  const [assignedTrips, setAssignedTrips] = useState([]);\n  const [isCheckInDialogOpen, setIsCheckInDialogOpen] = useState(false);\n  const [isCheckOutDialogOpen, setIsCheckOutDialogOpen] = useState(false);\n  const [checkInPhoto, setCheckInPhoto] = useState(null);\n  const [checkOutPhoto, setCheckOutPhoto] = useState(null);\n  const [checkInNotes, setCheckInNotes] = useState('');\n  const [checkOutNotes, setCheckOutNotes] = useState('');\n  const [isLoading, setIsLoading] = useState(true);\n  const [isSaving, setIsSaving] = useState(false);\n  const [selectedTripForUpload, setSelectedTripForUpload] = useState(null);\n  const [tripCustomers, setTripCustomers] = useState([]);\n  const [selectedCustomer, setSelectedCustomer] = useState(null);\n  const [uploadType, setUploadType] = useState('transaction');\n  const [uploadPhoto, setUploadPhoto] = useState(null);\n  const [uploadDate, setUploadDate] = useState(new Date().toISOString().split('T')[0]); // 设置默认日期为当日\n  const [isUploadDialogOpen, setIsUploadDialogOpen] = useState(false);\n  const [, setCustomerTransactions] = useState([]);\n  const [, setCustomerRolling] = useState([]);\n  const [expandedTripId, setExpandedTripId] = useState(null);\n  const [customerPhotos, setCustomerPhotos] = useState([]);\n  const [successMessage, setSuccessMessage] = useState('');\n\n  // Load staff data and shifts\n  const loadStaffData = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      clearError();\n\n      // Use staff_id from user object (user.id is users table ID, user.staff_id is staff table ID)\n      const staffId = user.staff_id || user.id;\n      console.log('Loading staff data for staff ID:', staffId, 'User ID:', user.id);\n\n      // Get current staff info\n      const staffResponse = await apiClient.get(`/staffs/${staffId}`);\n      if (staffResponse.success) {\n        setCurrentStaff(staffResponse.data);\n      }\n\n      // Get staff shifts history\n      const shiftsResponse = await apiClient.get(`/staffs/${staffId}/shifts`);\n      if (shiftsResponse.success) {\n        setShifts(shiftsResponse.data);\n      }\n\n      // Get assigned trips (staff can only see their assigned trips)\n      const tripsResponse = await apiClient.get('/trips/my-schedule');\n      if (tripsResponse.success) {\n        // Use trip data directly without trying to fetch customer stats\n        // Staff will see customer details when they click \"View Customers\"\n        const enrichedTrips = (tripsResponse.data || []).map(trip => ({\n          ...trip,\n          customers: [],\n          activecustomerscount: trip.activecustomerscount || 0\n        }));\n        setAssignedTrips(enrichedTrips);\n      } else {\n        setAssignedTrips([]);\n      }\n    } catch (error) {\n      console.error('Error loading staff data:', error);\n      showError('Failed to load staff data');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [user, clearError, showError]);\n  useEffect(() => {\n    loadStaffData();\n  }, [loadStaffData]);\n  const getCurrentShift = () => {\n    return shifts.find(shift => shift.status === 'checked-in');\n  };\n  const isCheckedIn = () => {\n    return getCurrentShift() !== undefined;\n  };\n  const handleCheckIn = async () => {\n    if (!checkInPhoto) return;\n    setIsSaving(true);\n    try {\n      // Convert photo to base64\n      const reader = new FileReader();\n      reader.onload = async e => {\n        try {\n          var _e$target;\n          const photoData = (_e$target = e.target) === null || _e$target === void 0 ? void 0 : _e$target.result;\n          const staffId = user.staff_id || user.id;\n          const response = await apiClient.post(`/staffs/${staffId}/check-in`, {\n            check_in_photo: photoData,\n            notes: checkInNotes\n          });\n          if (response.success) {\n            setIsCheckInDialogOpen(false);\n            setCheckInPhoto(null);\n            setCheckInNotes('');\n            setSuccessMessage('Check-in successful! You are now on duty.');\n            setTimeout(() => setSuccessMessage(''), 3000);\n            await loadStaffData(); // Refresh data\n          } else {\n            showError('Check-in failed: ' + response.message);\n          }\n        } catch (error) {\n          console.error('Check-in error:', error);\n          showError('Check-in failed');\n        } finally {\n          setIsSaving(false);\n        }\n      };\n      reader.readAsDataURL(checkInPhoto);\n    } catch (error) {\n      console.error('Check-in error:', error);\n      showError('Check-in failed');\n      setIsSaving(false);\n    }\n  };\n  const handleCheckOut = async () => {\n    if (!checkOutPhoto) return;\n    setIsSaving(true);\n    try {\n      const reader = new FileReader();\n      reader.onload = async e => {\n        try {\n          var _e$target2;\n          const photoData = (_e$target2 = e.target) === null || _e$target2 === void 0 ? void 0 : _e$target2.result;\n          const staffId = user.staff_id || user.id;\n          const response = await apiClient.post(`/staffs/${staffId}/check-out`, {\n            check_out_photo: photoData,\n            notes: checkOutNotes\n          });\n          if (response.success) {\n            setIsCheckOutDialogOpen(false);\n            setCheckOutPhoto(null);\n            setCheckOutNotes('');\n            setSuccessMessage('Check-out successful! Your shift has ended.');\n            setTimeout(() => setSuccessMessage(''), 3000);\n            await loadStaffData(); // Refresh data\n          } else {\n            showError('Check-out failed: ' + response.message);\n          }\n        } catch (error) {\n          console.error('Check-out error:', error);\n          showError('Check-out failed');\n        } finally {\n          setIsSaving(false);\n        }\n      };\n      reader.readAsDataURL(checkOutPhoto);\n    } catch (error) {\n      showError('Check-out failed');\n      setIsSaving(false);\n    }\n  };\n\n  // Load detailed trip data with customers and their transactions/rolling\n  const loadTripDetails = async trip => {\n    try {\n      // Try multiple approaches to get customer data\n      let customersLoaded = false;\n\n      // 添加客户数据结构转换函数\n      const normalizeCustomerData = customers => {\n        return customers.map(customer => {\n          // 检查所有可能的ID字段\n          const possibleIdFields = ['id', 'customer_id', 'customerId', 'ID', 'Id'];\n          const id = possibleIdFields.map(field => customer[field]).find(val => val) || 'unknown-id';\n\n          // 检查所有可能的名字字段\n          const possibleNameFields = ['name', 'customer_name', 'customerName', 'full_name', 'fullName', 'Name', 'first_name', 'firstName', 'last_name', 'lastName', 'display_name', 'displayName'];\n          let name = possibleNameFields.map(field => customer[field]).find(val => val && val.trim());\n\n          // 如果还是没有找到名字，尝试从嵌套对象中查找\n          if (!name && customer.customer) {\n            name = possibleNameFields.map(field => customer.customer[field]).find(val => val && val.trim());\n          }\n\n          // 最后的回退策略 - 使用ID作为显示名称\n          if (!name) {\n            name = `Customer ${id}`;\n          }\n\n          // 返回标准化的客户对象\n          return {\n            ...customer,\n            id,\n            name,\n            customer_id: id,\n            customer_name: name\n          };\n        });\n      };\n\n      // Approach 1: Try trip-specific customer stats (recommended)\n      try {\n        const customersResponse = await apiClient.get(`/trips/${trip.id}/customer-stats`);\n        if (customersResponse.success) {\n          // 应用标准化函数处理客户数据\n          const normalizedCustomers = normalizeCustomerData(customersResponse.data || []);\n          setTripCustomers(normalizedCustomers);\n          customersLoaded = true;\n        }\n      } catch (error) {\n        console.log('Trip-specific customer stats failed, trying trip customers endpoint');\n      }\n\n      // Approach 2: Try trip customers endpoint (more specific than customer-stats)\n      if (!customersLoaded) {\n        try {\n          const tripCustomersResponse = await apiClient.get(`/trips/${trip.id}/customers`);\n          if (tripCustomersResponse.success) {\n            // This should return only customers assigned to this specific trip\n            const normalizedCustomers = normalizeCustomerData(tripCustomersResponse.data || []);\n            setTripCustomers(normalizedCustomers);\n            customersLoaded = true;\n          }\n        } catch (error) {\n          console.log('Trip customers endpoint failed');\n        }\n      }\n\n      // Approach 3: Use any existing trip data as fallback\n      if (!customersLoaded && trip.customers) {\n        const normalizedCustomers = normalizeCustomerData(trip.customers || []);\n        setTripCustomers(normalizedCustomers);\n        customersLoaded = true;\n      }\n\n      // Load transactions, rolling records, and customer photos if we have customers\n      if (customersLoaded) {\n        try {\n          // 加载交易记录和滚码记录（旧API）\n          const [transactionsResponse, rollingResponse] = await Promise.all([apiClient.get(`/transactions?trip_id=${trip.id}`), apiClient.get(`/rolling-records?trip_id=${trip.id}`)]);\n          console.log('Transactions response:', transactionsResponse);\n          console.log('Rolling response:', rollingResponse);\n          if (transactionsResponse.success) {\n            setCustomerTransactions(transactionsResponse.data || []);\n          }\n          if (rollingResponse.success) {\n            setCustomerRolling(rollingResponse.data || []);\n          }\n\n          // 尝试加载客户照片（新API）\n          try {\n            const photosResponse = await apiClient.get(`/customer-photos?trip_id=${trip.id}`);\n            console.log('Customer photos response:', photosResponse);\n            if (photosResponse.success) {\n              setCustomerPhotos(photosResponse.data || []);\n            } else {\n              setCustomerPhotos([]);\n            }\n          } catch (error) {\n            console.log('Failed to load customer photos (new API may not be implemented yet):', error);\n            setCustomerPhotos([]);\n          }\n        } catch (error) {\n          console.log('Failed to load transactions/rolling:', error);\n          setCustomerTransactions([]);\n          setCustomerRolling([]);\n          setCustomerPhotos([]);\n        }\n      } else {\n        // No customers loaded, set empty arrays\n        console.log('No customers loaded, setting empty arrays');\n        setTripCustomers([]);\n        setCustomerTransactions([]);\n        setCustomerRolling([]);\n        setCustomerPhotos([]);\n      }\n\n      // Set the selected trip ID for the expandable section\n      setSelectedTripForUpload(trip);\n    } catch (error) {\n      console.error('Error loading trip details:', error);\n      showError('Failed to load trip details');\n\n      // Fallback: use any existing trip data\n      if (trip.customers) {\n        setTripCustomers(trip.customers);\n      }\n      setCustomerTransactions([]);\n      setCustomerRolling([]);\n      setCustomerPhotos([]);\n\n      // Close the expanded section on error\n      setExpandedTripId(null);\n    }\n  };\n\n  // Legacy functions kept for future compatibility (currently unused)\n  // const getCustomerTransactions = (customerId: string) => {\n  //   return customerTransactions.filter(t => \n  //     (t.customer_id === customerId || t.customerId === customerId)\n  //   );\n  // };\n\n  // const getCustomerRolling = (customerId: string) => {\n  //   return customerRolling.filter(r => \n  //     (r.customer_id === customerId || r.customerId === customerId)\n  //   );\n  // };\n\n  // Handle photo deletion\n  const handlePhotoDelete = async photoId => {\n    setIsSaving(true);\n    try {\n      const response = await apiClient.delete(`/customer-photos/${photoId}`);\n      if (response.success) {\n        console.log('✅ Photo deleted successfully:', photoId);\n        // Refresh customer photos - the UI will automatically update to show the photo is gone\n        if (selectedTripForUpload) {\n          await loadTripDetails(selectedTripForUpload);\n        }\n      } else {\n        // Handle different error types\n        const errorMessage = response.message || 'Unknown error occurred';\n        showError('Failed to delete photo: ' + errorMessage);\n      }\n    } catch (error) {\n      console.error('Photo deletion error:', error);\n\n      // Handle specific HTTP errors\n      if (error.message && error.message.includes('403')) {\n        showError('Permission denied: You do not have permission to delete this photo. Only the uploader or admin can delete photos.');\n      } else if (error.message && error.message.includes('404')) {\n        showError('Photo not found: This photo may have already been deleted.');\n      } else if (error.message && error.message.includes('401')) {\n        showError('Authentication required: Please log in again to delete photos.');\n      } else {\n        showError('Failed to delete photo: ' + (error.message || 'Network or server error'));\n      }\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  // Handle photo upload for transaction/rolling using customer_photos table\n  const handlePhotoUpload = async () => {\n    if (!uploadPhoto || !selectedCustomer || !uploadDate) {\n      showError('Please fill in all required fields');\n      return;\n    }\n    setIsSaving(true);\n    try {\n      const reader = new FileReader();\n      reader.onload = async e => {\n        try {\n          var _e$target3, _selectedCustomer$cus, _selectedCustomer$cus2;\n          const photoData = (_e$target3 = e.target) === null || _e$target3 === void 0 ? void 0 : _e$target3.result;\n\n          // 使用新的customer_photos表结构，照片存储为JSON格式\n          const photoJson = {\n            data: photoData,\n            // 照片数据\n            filename: uploadPhoto.name,\n            // 文件名\n            size: uploadPhoto.size,\n            // 文件大小\n            type: uploadPhoto.type,\n            // 文件类型\n            uploaded_at: new Date().toISOString()\n          };\n          const customerPhotoData = {\n            customer_id: (_selectedCustomer$cus = selectedCustomer.customer) === null || _selectedCustomer$cus === void 0 ? void 0 : _selectedCustomer$cus.id,\n            trip_id: selectedTripForUpload.id,\n            photo_type: uploadType,\n            // 'transaction' 或 'rolling'\n            photo: photoJson,\n            // 存储为JSON格式\n            uploaded_by: user.staff_id || user.id,\n            transaction_date: uploadDate // 交易日期\n            // status 字段由数据库默认设置为 'pending'，不需要手动指定\n          };\n\n          // 使用新的API端点\n          const endpoint = '/customer-photos';\n          console.log(`Uploading ${uploadType} photo for customer:`, selectedCustomer.customer_name || selectedCustomer.name);\n\n          // Debug log for selectedCustomer structure\n          console.log(\"🔍 Selected Customer Object:\", selectedCustomer);\n          console.log(\"🔍 Customer ID fields:\", {\n            \"selectedCustomer.id\": selectedCustomer.id,\n            \"selectedCustomer.customer_id\": selectedCustomer.customer_id,\n            \"selectedCustomer.customer?.id\": (_selectedCustomer$cus2 = selectedCustomer.customer) === null || _selectedCustomer$cus2 === void 0 ? void 0 : _selectedCustomer$cus2.id\n          });\n\n          // Debug log for photo upload payload\n          console.log(\"📸 Uploading photo payload:\", {\n            customer_id: customerPhotoData.customer_id,\n            trip_id: customerPhotoData.trip_id,\n            photo_type: customerPhotoData.photo_type,\n            photo: customerPhotoData.photo,\n            transaction_date: customerPhotoData.transaction_date\n          });\n          const response = await apiClient.post(endpoint, customerPhotoData);\n          if (response.success) {\n            setIsUploadDialogOpen(false);\n            setUploadPhoto(null);\n            setUploadDate(new Date().toISOString().split('T')[0]); // 重置日期为今天\n            setSelectedCustomer(null);\n\n            // 显示成功消息\n            setSuccessMessage(`${uploadType === 'transaction' ? 'Transaction' : 'Rolling'} photo uploaded successfully and pending approval`);\n            // 3秒后自动清除成功消息\n            setTimeout(() => setSuccessMessage(''), 3000);\n\n            // 刷新客户数据\n            await loadTripDetails(selectedTripForUpload);\n          } else {\n            showError(`Failed to upload ${uploadType} photo: ` + response.message);\n          }\n        } catch (error) {\n          console.error(`${uploadType} photo upload error:`, error);\n          showError(`Failed to upload ${uploadType} photo`);\n        } finally {\n          setIsSaving(false);\n        }\n      };\n      reader.readAsDataURL(uploadPhoto);\n    } catch (error) {\n      console.error(`${uploadType} upload error:`, error);\n      showError(`Failed to upload ${uploadType}`);\n      setIsSaving(false);\n    }\n  };\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center h-64\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 489,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-600\",\n          children: \"Loading staff information...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 490,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 488,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 487,\n      columnNumber: 7\n    }, this);\n  }\n  const currentShift = getCurrentShift();\n  return /*#__PURE__*/_jsxDEV(DSContainer, {\n    children: [successMessage && /*#__PURE__*/_jsxDEV(DSNotification, {\n      type: \"success\",\n      title: \"Success\",\n      message: successMessage,\n      onClose: () => setSuccessMessage('')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 502,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(DSHeader, {\n      title: \"Staff Self-Service\",\n      subtitle: `Welcome, ${(currentStaff === null || currentStaff === void 0 ? void 0 : currentStaff.name) || user.username}`,\n      badges: [{\n        text: `Staff ID: ${user.id}`,\n        variant: 'gray'\n      }, {\n        text: `${assignedTrips.length} Assigned Trips`,\n        variant: 'primary'\n      }],\n      actions: /*#__PURE__*/_jsxDEV(DSButton, {\n        variant: \"outline\",\n        size: \"mobile\",\n        onClick: loadStaffData,\n        disabled: isLoading,\n        icon: /*#__PURE__*/_jsxDEV(RefreshCw, {\n          className: iconSizes.sm\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 524,\n          columnNumber: 19\n        }, this),\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"hidden sm:inline\",\n          children: \"Refresh\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 526,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"sm:hidden\",\n          children: \"Refresh Data\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 527,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 519,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 511,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Card, {\n      children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n        className: \"pb-3 sm:pb-6\",\n        children: /*#__PURE__*/_jsxDEV(CardTitle, {\n          className: \"flex items-center space-x-2 text-base sm:text-lg\",\n          children: [/*#__PURE__*/_jsxDEV(Clock, {\n            className: \"w-4 h-4 sm:w-5 sm:h-5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 536,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Current Status\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 537,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 534,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n        className: \"pt-0\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-1 min-w-0\",\n            children: isCheckedIn() ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-2\",\n                children: [/*#__PURE__*/_jsxDEV(Badge, {\n                  className: \"bg-green-100 text-green-800 px-3 py-1 w-fit\",\n                  children: [/*#__PURE__*/_jsxDEV(CheckCircle, {\n                    className: \"w-3 h-3 sm:w-4 sm:h-4 mr-1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 547,\n                    columnNumber: 23\n                  }, this), \"On Duty\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 546,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-xs sm:text-sm text-gray-600\",\n                  children: [\"Since: \", new Date(currentShift.check_in_time).toLocaleString()]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 550,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 545,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs text-gray-500\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"sm:inline\",\n                  children: [\"Shift Date: \", currentShift.shift_date]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 555,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"sm:inline sm:ml-2\",\n                  children: [\"Duration: \", Math.floor((new Date().getTime() - new Date(currentShift.check_in_time).getTime()) / (1000 * 60)), \" min\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 556,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 554,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 544,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(Badge, {\n                variant: \"secondary\",\n                className: \"px-3 py-1 w-fit\",\n                children: [/*#__PURE__*/_jsxDEV(XCircle, {\n                  className: \"w-3 h-3 sm:w-4 sm:h-4 mr-1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 564,\n                  columnNumber: 21\n                }, this), \"Off Duty\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 563,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-xs sm:text-sm text-gray-600\",\n                children: \"Ready to check in\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 567,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 562,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 542,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col sm:flex-row gap-2 sm:space-x-2\",\n            children: isCheckedIn() ? /*#__PURE__*/_jsxDEV(Dialog, {\n              open: isCheckOutDialogOpen,\n              onOpenChange: setIsCheckOutDialogOpen,\n              children: [/*#__PURE__*/_jsxDEV(DialogTrigger, {\n                asChild: true,\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  variant: \"destructive\",\n                  disabled: isSaving,\n                  className: \"w-full sm:w-auto\",\n                  children: [/*#__PURE__*/_jsxDEV(LogOut, {\n                    className: \"w-3 h-3 sm:w-4 sm:h-4 mr-2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 577,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"hidden sm:inline\",\n                    children: \"Check Out\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 578,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"sm:hidden\",\n                    children: \"Check Out\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 579,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 576,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 575,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n                children: [/*#__PURE__*/_jsxDEV(DialogHeader, {\n                  children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n                    children: \"Check Out\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 584,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(DialogDescription, {\n                    children: \"Upload a photo as proof of check-out and add any end-of-shift notes.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 585,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 583,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-4\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(Label, {\n                      htmlFor: \"checkOutPhoto\",\n                      children: \"Check-out Photo (Required)\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 591,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(Input, {\n                      id: \"checkOutPhoto\",\n                      type: \"file\",\n                      accept: \"image/*\",\n                      onChange: e => {\n                        var _e$target$files;\n                        return setCheckOutPhoto(((_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0]) || null);\n                      },\n                      className: \"mt-1\",\n                      required: true,\n                      disabled: isSaving\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 592,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 590,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(Label, {\n                      htmlFor: \"checkOutNotes\",\n                      children: \"End of Shift Notes (Optional)\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 603,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(Textarea, {\n                      id: \"checkOutNotes\",\n                      value: checkOutNotes,\n                      onChange: e => setCheckOutNotes(e.target.value),\n                      placeholder: \"Any end-of-shift notes...\",\n                      rows: 3,\n                      disabled: isSaving\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 604,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 602,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex justify-end space-x-2\",\n                    children: [/*#__PURE__*/_jsxDEV(Button, {\n                      type: \"button\",\n                      variant: \"outline\",\n                      onClick: () => setIsCheckOutDialogOpen(false),\n                      disabled: isSaving,\n                      children: \"Cancel\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 614,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(Button, {\n                      onClick: handleCheckOut,\n                      disabled: !checkOutPhoto || isSaving,\n                      children: isSaving ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                        children: [/*#__PURE__*/_jsxDEV(Activity, {\n                          className: \"w-4 h-4 mr-2 animate-spin\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 620,\n                          columnNumber: 31\n                        }, this), \"Saving...\"]\n                      }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                        children: [/*#__PURE__*/_jsxDEV(LogOut, {\n                          className: \"w-4 h-4 mr-2\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 625,\n                          columnNumber: 31\n                        }, this), \"Check Out\"]\n                      }, void 0, true)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 617,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 613,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 589,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 582,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 574,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(Dialog, {\n              open: isCheckInDialogOpen,\n              onOpenChange: setIsCheckInDialogOpen,\n              children: [/*#__PURE__*/_jsxDEV(DialogTrigger, {\n                asChild: true,\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  disabled: isSaving,\n                  className: \"w-full sm:w-auto\",\n                  children: [/*#__PURE__*/_jsxDEV(LogIn, {\n                    className: \"w-3 h-3 sm:w-4 sm:h-4 mr-2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 638,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"hidden sm:inline\",\n                    children: \"Check In\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 639,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"sm:hidden\",\n                    children: \"Check In\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 640,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 637,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 636,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n                children: [/*#__PURE__*/_jsxDEV(DialogHeader, {\n                  children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n                    children: \"Check In\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 645,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(DialogDescription, {\n                    children: \"Upload a photo as proof of check-in and add any notes for the shift.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 646,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 644,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-4\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(Label, {\n                      htmlFor: \"checkInPhoto\",\n                      children: \"Check-in Photo (Required)\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 652,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(Input, {\n                      id: \"checkInPhoto\",\n                      type: \"file\",\n                      accept: \"image/*\",\n                      onChange: e => {\n                        var _e$target$files2;\n                        return setCheckInPhoto(((_e$target$files2 = e.target.files) === null || _e$target$files2 === void 0 ? void 0 : _e$target$files2[0]) || null);\n                      },\n                      className: \"mt-1\",\n                      required: true,\n                      disabled: isSaving\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 653,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 651,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(Label, {\n                      htmlFor: \"checkInNotes\",\n                      children: \"Notes (Optional)\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 664,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(Textarea, {\n                      id: \"checkInNotes\",\n                      value: checkInNotes,\n                      onChange: e => setCheckInNotes(e.target.value),\n                      placeholder: \"Any notes for this shift...\",\n                      rows: 3,\n                      disabled: isSaving\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 665,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 663,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex justify-end space-x-2\",\n                    children: [/*#__PURE__*/_jsxDEV(Button, {\n                      type: \"button\",\n                      variant: \"outline\",\n                      onClick: () => setIsCheckInDialogOpen(false),\n                      disabled: isSaving,\n                      children: \"Cancel\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 675,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(Button, {\n                      onClick: handleCheckIn,\n                      disabled: !checkInPhoto || isSaving,\n                      children: isSaving ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                        children: [/*#__PURE__*/_jsxDEV(Activity, {\n                          className: \"w-4 h-4 mr-2 animate-spin\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 681,\n                          columnNumber: 31\n                        }, this), \"Saving...\"]\n                      }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                        children: [/*#__PURE__*/_jsxDEV(LogIn, {\n                          className: \"w-4 h-4 mr-2\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 686,\n                          columnNumber: 31\n                        }, this), \"Check In\"]\n                      }, void 0, true)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 678,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 674,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 650,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 643,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 635,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 572,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 541,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 540,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 533,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Tabs, {\n      defaultValue: \"trips\",\n      className: \"w-full\",\n      children: [/*#__PURE__*/_jsxDEV(TabsList, {\n        className: \"grid w-full grid-cols-2 h-auto\",\n        children: [/*#__PURE__*/_jsxDEV(TabsTrigger, {\n          value: \"trips\",\n          className: \"flex items-center space-x-1 sm:space-x-2 py-2 sm:py-3\",\n          children: [/*#__PURE__*/_jsxDEV(MapPin, {\n            className: \"w-3 h-3 sm:w-4 sm:h-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 705,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs sm:text-sm\",\n            children: \"My Trips\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 706,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 704,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TabsTrigger, {\n          value: \"shifts\",\n          className: \"flex items-center space-x-1 sm:space-x-2 py-2 sm:py-3\",\n          children: [/*#__PURE__*/_jsxDEV(Calendar, {\n            className: \"w-3 h-3 sm:w-4 sm:h-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 709,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs sm:text-sm\",\n            children: \"My Shifts\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 710,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 708,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 703,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TabsContent, {\n        value: \"trips\",\n        className: \"mt-6\",\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n            className: \"pb-3 sm:pb-6\",\n            children: [/*#__PURE__*/_jsxDEV(CardTitle, {\n              className: \"flex items-center space-x-2 text-base sm:text-lg\",\n              children: [/*#__PURE__*/_jsxDEV(MapPin, {\n                className: \"w-4 h-4 sm:w-5 sm:h-5\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 718,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Assigned Trips\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 719,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 717,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(CardDescription, {\n              className: \"text-sm\",\n              children: \"Trips you are assigned to manage\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 721,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 716,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n            children: assignedTrips.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center py-8\",\n              children: [/*#__PURE__*/_jsxDEV(Users, {\n                className: \"w-12 h-12 mx-auto text-gray-400 mb-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 726,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-gray-500\",\n                children: \"No trips assigned.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 727,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 725,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-4\",\n              children: assignedTrips.map(trip => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mb-4\",\n                children: [/*#__PURE__*/_jsxDEV(Card, {\n                  className: \"border-l-4 border-l-blue-400\",\n                  children: /*#__PURE__*/_jsxDEV(CardContent, {\n                    className: \"p-3 sm:p-4\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0 mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex items-center space-x-2 min-w-0 flex-1\",\n                        children: /*#__PURE__*/_jsxDEV(\"h4\", {\n                          className: \"font-medium text-sm sm:text-base truncate\",\n                          children: trip.trip_name\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 737,\n                          columnNumber: 31\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 736,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(Badge, {\n                        className: `text-xs w-fit ${trip.status === 'active' ? 'bg-green-100 text-green-800' : trip.status === 'in-progress' ? 'bg-blue-100 text-blue-800' : 'bg-gray-100 text-gray-800'}`,\n                        children: trip.status\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 739,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 735,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 text-sm\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        children: [/*#__PURE__*/_jsxDEV(Label, {\n                          className: \"text-xs text-gray-500\",\n                          children: \"Destination\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 749,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                          className: \"text-sm\",\n                          children: trip.destination\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 750,\n                          columnNumber: 31\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 748,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        children: [/*#__PURE__*/_jsxDEV(Label, {\n                          className: \"text-xs text-gray-500\",\n                          children: \"Dates\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 753,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                          className: \"text-sm\",\n                          children: [new Date(trip.start_date).toLocaleDateString(), \" - \", new Date(trip.end_date).toLocaleDateString()]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 754,\n                          columnNumber: 31\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 752,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 747,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"mt-3 flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex flex-wrap gap-2\",\n                        children: /*#__PURE__*/_jsxDEV(Badge, {\n                          variant: \"outline\",\n                          className: \"text-xs\",\n                          children: [trip.activecustomerscount || 0, \" Active Customers\"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 759,\n                          columnNumber: 31\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 758,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex flex-col sm:flex-row gap-2 sm:space-x-2\",\n                        children: /*#__PURE__*/_jsxDEV(Button, {\n                          size: \"sm\",\n                          variant: \"outline\",\n                          onClick: () => {\n                            // Toggle expanded state for this trip\n                            setExpandedTripId(expandedTripId === trip.id ? null : trip.id);\n                            // Load customer data if expanding and not already loaded\n                            if (expandedTripId !== trip.id) {\n                              loadTripDetails(trip);\n                            }\n                          },\n                          className: \"text-xs w-full sm:w-auto\",\n                          children: expandedTripId === trip.id ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                            children: [/*#__PURE__*/_jsxDEV(ChevronUp, {\n                              className: \"w-3 h-3 mr-1\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 779,\n                              columnNumber: 37\n                            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                              className: \"hidden sm:inline\",\n                              children: \"Hide Customers\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 780,\n                              columnNumber: 37\n                            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                              className: \"sm:hidden\",\n                              children: \"Hide\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 781,\n                              columnNumber: 37\n                            }, this)]\n                          }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                            children: [/*#__PURE__*/_jsxDEV(ChevronDown, {\n                              className: \"w-3 h-3 mr-1\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 785,\n                              columnNumber: 37\n                            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                              className: \"hidden sm:inline\",\n                              children: \"View Customers\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 786,\n                              columnNumber: 37\n                            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                              className: \"sm:hidden\",\n                              children: \"View\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 787,\n                              columnNumber: 37\n                            }, this)]\n                          }, void 0, true)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 764,\n                          columnNumber: 31\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 763,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 757,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 734,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 733,\n                  columnNumber: 23\n                }, this), expandedTripId === trip.id && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"mt-3 pl-2 sm:pl-4 border-l-2 border-blue-200\",\n                  children: tripCustomers.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-center py-6 bg-gray-50 rounded\",\n                    children: [/*#__PURE__*/_jsxDEV(Users, {\n                      className: \"w-6 h-6 sm:w-8 sm:h-8 mx-auto text-gray-400 mb-2\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 801,\n                      columnNumber: 31\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-xs sm:text-sm text-gray-500\",\n                      children: \"Loading customers...\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 802,\n                      columnNumber: 31\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 800,\n                    columnNumber: 29\n                  }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"space-y-2 sm:space-y-3\",\n                    children: tripCustomers.map(customer => {\n                      var _customer$customer, _customer$customer2;\n                      // 使用正确的customer ID和name\n                      const customerId = ((_customer$customer = customer.customer) === null || _customer$customer === void 0 ? void 0 : _customer$customer.id) || customer.customer_id;\n                      const customerName = ((_customer$customer2 = customer.customer) === null || _customer$customer2 === void 0 ? void 0 : _customer$customer2.name) || customer.name;\n\n                      // 筛选当前客户的照片\n                      const customerSpecificPhotos = customerPhotos.filter(photo => photo.customer_id === customerId);\n\n                      // Debug: Photo matching (can be removed in production)\n                      // console.log(`🔍 Customer ${customerName} (${customerId}):`, {\n                      //   totalPhotos: customerPhotos.length,\n                      //   matchingPhotos: customerSpecificPhotos.length\n                      // });\n\n                      // 获取该客户最新的交易和滚码照片\n                      const transactionPhotos = customerSpecificPhotos.filter(p => p.photo_type === 'transaction');\n                      const rollingPhotos = customerSpecificPhotos.filter(p => p.photo_type === 'rolling');\n\n                      // Photo data available for future features (currently unused)\n                      // const latestTransactionPhoto = transactionPhotos.length > 0 ? \n                      //   [...transactionPhotos].sort((a, b) => {\n                      //     const dateA = new Date(a.upload_date);\n                      //     const dateB = new Date(b.upload_date);\n                      //     return dateB.getTime() - dateA.getTime();\n                      //   })[0] : null;\n\n                      // const latestRollingPhoto = rollingPhotos.length > 0 ? \n                      //   [...rollingPhotos].sort((a, b) => {\n                      //     const dateA = new Date(a.upload_date);\n                      //     const dateB = new Date(b.upload_date);\n                      //     return dateB.getTime() - dateA.getTime();\n                      //   })[0] : null;\n\n                      // Legacy data compatibility (currently unused)\n                      // const transactions = getCustomerTransactions(customerId);\n                      // const rolling = getCustomerRolling(customerId);\n\n                      // Fallback data for future use (currently unused but kept for potential features)\n                      // const fallbackTransaction = transactions.length > 0 ? \n                      //   [...transactions].sort((a, b) => {\n                      //     const dateA = new Date(a.created_at || a.timestamp);\n                      //     const dateB = new Date(b.created_at || b.timestamp);\n                      //     return dateB.getTime() - dateA.getTime();\n                      //   })[0] : null;\n\n                      // const fallbackRolling = rolling.length > 0 ? \n                      //   [...rolling].sort((a, b) => {\n                      //     const dateA = new Date(a.created_at || a.timestamp);\n                      //     const dateB = new Date(b.created_at || b.timestamp);\n                      //     return dateB.getTime() - dateA.getTime();\n                      //   })[0] : null;\n\n                      // Helper function for photo validation (available for future use)\n                      // const isValidPhotoData = (photoData: string) => {\n                      //   if (!photoData) return false;\n                      //   // Check if it's a valid base64 image data URL and not just \"test\"\n                      //   return photoData.startsWith('data:image/') && \n                      //          !photoData.includes('base64,test') && \n                      //          photoData.length > 100; // Reasonable minimum length for actual image data\n                      // };\n\n                      // Get valid photo data or null (currently unused but available for future features)\n                      // const validTransactionPhotoData = latestTransactionPhoto?.photo?.data && \n                      //   isValidPhotoData(latestTransactionPhoto.photo.data) ? \n                      //   latestTransactionPhoto.photo.data : null;\n\n                      // const validRollingPhotoData = latestRollingPhoto?.photo?.data && \n                      //   isValidPhotoData(latestRollingPhoto.photo.data) ? \n                      //   latestRollingPhoto.photo.data : null;\n\n                      // Debug: Photo display validation (can be removed in production)\n                      // console.log(`📷 ${customerName} photos:`, {\n                      //   validTransactionPhotoData: validTransactionPhotoData ? 'Valid' : 'Invalid/Missing',\n                      //   validRollingPhotoData: validRollingPhotoData ? 'Valid' : 'Invalid/Missing'\n                      // });\n\n                      return /*#__PURE__*/_jsxDEV(Card, {\n                        className: \"border-l-4 border-l-gray-300\",\n                        children: /*#__PURE__*/_jsxDEV(CardContent, {\n                          className: \"p-2 sm:p-3\",\n                          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"flex flex-col sm:flex-row sm:justify-between sm:items-center space-y-2 sm:space-y-0 mb-3\",\n                            children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                              className: \"text-sm sm:text-base font-medium truncate\",\n                              children: customerName || `Customer`\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 891,\n                              columnNumber: 41\n                            }, this), /*#__PURE__*/_jsxDEV(Badge, {\n                              variant: \"outline\",\n                              className: \"bg-green-50 text-green-700 border-green-200 text-xs w-fit\",\n                              children: \"Active\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 894,\n                              columnNumber: 41\n                            }, this)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 890,\n                            columnNumber: 39\n                          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4\",\n                            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                              className: \"border rounded p-2 sm:p-3\",\n                              children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n                                className: \"text-xs sm:text-sm font-medium mb-2\",\n                                children: \"Transaction\"\n                              }, void 0, false, {\n                                fileName: _jsxFileName,\n                                lineNumber: 902,\n                                columnNumber: 43\n                              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                                className: \"mb-3\",\n                                children: /*#__PURE__*/_jsxDEV(PhotoDisplay, {\n                                  photos: transactionPhotos,\n                                  type: \"transaction\",\n                                  size: \"medium\",\n                                  maxPhotos: 4,\n                                  onPhotoDelete: handlePhotoDelete,\n                                  showDelete: user.role === 'admin' || transactionPhotos.some(photo => photo.uploaded_by === user.staff_id),\n                                  showDownload: true,\n                                  userRole: user.role,\n                                  customerName: customerName\n                                }, void 0, false, {\n                                  fileName: _jsxFileName,\n                                  lineNumber: 904,\n                                  columnNumber: 45\n                                }, this)\n                              }, void 0, false, {\n                                fileName: _jsxFileName,\n                                lineNumber: 903,\n                                columnNumber: 43\n                              }, this), /*#__PURE__*/_jsxDEV(DSButton, {\n                                variant: \"outline\",\n                                size: \"mobile\",\n                                onClick: () => {\n                                  setSelectedCustomer(customer);\n                                  setUploadType('transaction');\n                                  setIsUploadDialogOpen(true);\n                                },\n                                icon: /*#__PURE__*/_jsxDEV(Camera, {\n                                  className: iconSizes.sm\n                                }, void 0, false, {\n                                  fileName: _jsxFileName,\n                                  lineNumber: 927,\n                                  columnNumber: 51\n                                }, this),\n                                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                                  className: \"hidden sm:inline\",\n                                  children: \"Upload Transaction Photo\"\n                                }, void 0, false, {\n                                  fileName: _jsxFileName,\n                                  lineNumber: 929,\n                                  columnNumber: 45\n                                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                                  className: \"sm:hidden\",\n                                  children: \"Upload Transaction\"\n                                }, void 0, false, {\n                                  fileName: _jsxFileName,\n                                  lineNumber: 930,\n                                  columnNumber: 45\n                                }, this)]\n                              }, void 0, true, {\n                                fileName: _jsxFileName,\n                                lineNumber: 919,\n                                columnNumber: 43\n                              }, this)]\n                            }, void 0, true, {\n                              fileName: _jsxFileName,\n                              lineNumber: 901,\n                              columnNumber: 41\n                            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                              className: \"border rounded p-2 sm:p-3\",\n                              children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n                                className: \"text-xs sm:text-sm font-medium mb-2\",\n                                children: \"Rolling\"\n                              }, void 0, false, {\n                                fileName: _jsxFileName,\n                                lineNumber: 936,\n                                columnNumber: 43\n                              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                                className: \"mb-3\",\n                                children: /*#__PURE__*/_jsxDEV(PhotoDisplay, {\n                                  photos: rollingPhotos,\n                                  type: \"rolling\",\n                                  size: \"medium\",\n                                  maxPhotos: 4,\n                                  onPhotoDelete: handlePhotoDelete,\n                                  showDelete: user.role === 'admin' || rollingPhotos.some(photo => photo.uploaded_by === user.staff_id),\n                                  showDownload: true,\n                                  userRole: user.role,\n                                  customerName: customerName\n                                }, void 0, false, {\n                                  fileName: _jsxFileName,\n                                  lineNumber: 938,\n                                  columnNumber: 45\n                                }, this)\n                              }, void 0, false, {\n                                fileName: _jsxFileName,\n                                lineNumber: 937,\n                                columnNumber: 43\n                              }, this), /*#__PURE__*/_jsxDEV(DSButton, {\n                                variant: \"outline\",\n                                size: \"mobile\",\n                                onClick: () => {\n                                  setSelectedCustomer(customer);\n                                  setUploadType('rolling');\n                                  setIsUploadDialogOpen(true);\n                                },\n                                icon: /*#__PURE__*/_jsxDEV(Camera, {\n                                  className: iconSizes.sm\n                                }, void 0, false, {\n                                  fileName: _jsxFileName,\n                                  lineNumber: 961,\n                                  columnNumber: 51\n                                }, this),\n                                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                                  className: \"hidden sm:inline\",\n                                  children: \"Upload Rolling Photo\"\n                                }, void 0, false, {\n                                  fileName: _jsxFileName,\n                                  lineNumber: 963,\n                                  columnNumber: 45\n                                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                                  className: \"sm:hidden\",\n                                  children: \"Upload Rolling\"\n                                }, void 0, false, {\n                                  fileName: _jsxFileName,\n                                  lineNumber: 964,\n                                  columnNumber: 45\n                                }, this)]\n                              }, void 0, true, {\n                                fileName: _jsxFileName,\n                                lineNumber: 953,\n                                columnNumber: 43\n                              }, this)]\n                            }, void 0, true, {\n                              fileName: _jsxFileName,\n                              lineNumber: 935,\n                              columnNumber: 41\n                            }, this)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 899,\n                            columnNumber: 39\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 889,\n                          columnNumber: 37\n                        }, this)\n                      }, customerId, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 888,\n                        columnNumber: 35\n                      }, this);\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 805,\n                    columnNumber: 29\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 798,\n                  columnNumber: 25\n                }, this)]\n              }, trip.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 732,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 730,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 723,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 715,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 714,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TabsContent, {\n        value: \"shifts\",\n        className: \"mt-4 sm:mt-6\",\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n            className: \"pb-3 sm:pb-6\",\n            children: [/*#__PURE__*/_jsxDEV(CardTitle, {\n              className: \"flex items-center space-x-2 text-base sm:text-lg\",\n              children: [/*#__PURE__*/_jsxDEV(Calendar, {\n                className: \"w-4 h-4 sm:w-5 sm:h-5\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 988,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Shift History\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 989,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 987,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(CardDescription, {\n              className: \"text-sm\",\n              children: \"Your recent shifts and attendance\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 991,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 986,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n            children: shifts.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center py-8\",\n              children: [/*#__PURE__*/_jsxDEV(Clock, {\n                className: \"w-12 h-12 mx-auto text-gray-400 mb-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 996,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-gray-500\",\n                children: \"No shift history found.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 997,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 995,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-4\",\n              children: shifts.sort((a, b) => {\n                // Sort by newest date/time first\n                const dateA = new Date(a.check_in_time || a.shift_date || a.checkInTime || a.shiftDate);\n                const dateB = new Date(b.check_in_time || b.shift_date || b.checkInTime || b.shiftDate);\n                return dateB.getTime() - dateA.getTime();\n              }).slice(0, 10).map(shift => /*#__PURE__*/_jsxDEV(Card, {\n                className: \"border-l-4 border-l-blue-400\",\n                children: /*#__PURE__*/_jsxDEV(CardContent, {\n                  className: \"p-3 sm:p-4\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0 mb-3\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex items-center space-x-2\",\n                      children: [/*#__PURE__*/_jsxDEV(Calendar, {\n                        className: \"w-3 h-3 sm:w-4 sm:h-4 text-gray-400\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1014,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"font-medium text-sm sm:text-base\",\n                        children: shift.shift_date\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1015,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1013,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(Badge, {\n                      className: `text-xs w-fit ${shift.status === 'checked-in' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}`,\n                      children: shift.status === 'checked-in' ? 'On Duty' : 'Completed'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1017,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1012,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 text-sm\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(Label, {\n                        className: \"text-xs text-gray-500\",\n                        children: \"Check-in Time\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1024,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                        children: new Date(shift.check_in_time).toLocaleString()\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1025,\n                        columnNumber: 29\n                      }, this), shift.check_in_photo && /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"mt-2\",\n                        children: /*#__PURE__*/_jsxDEV(ImageWithFallback, {\n                          src: shift.check_in_photo,\n                          alt: \"Check-in proof\",\n                          className: \"w-12 h-12 sm:w-16 sm:h-16 object-cover rounded border\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1028,\n                          columnNumber: 33\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1027,\n                        columnNumber: 31\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1023,\n                      columnNumber: 27\n                    }, this), shift.check_out_time && /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(Label, {\n                        className: \"text-xs text-gray-500\",\n                        children: \"Check-out Time\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1039,\n                        columnNumber: 31\n                      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                        children: new Date(shift.check_out_time).toLocaleString()\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1040,\n                        columnNumber: 31\n                      }, this), shift.check_out_photo && /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"mt-2\",\n                        children: /*#__PURE__*/_jsxDEV(ImageWithFallback, {\n                          src: shift.check_out_photo,\n                          alt: \"Check-out proof\",\n                          className: \"w-12 h-12 sm:w-16 sm:h-16 object-cover rounded border\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1043,\n                          columnNumber: 35\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1042,\n                        columnNumber: 33\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1038,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1022,\n                    columnNumber: 25\n                  }, this), shift.notes && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"mt-3 p-2 bg-gray-50 rounded text-xs\",\n                    children: [/*#__PURE__*/_jsxDEV(Label, {\n                      className: \"text-gray-500\",\n                      children: \"Notes\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1056,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-gray-700 mt-1\",\n                      children: shift.notes\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1057,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1055,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1011,\n                  columnNumber: 23\n                }, this)\n              }, shift.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1010,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1000,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 993,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 985,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 984,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 702,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: isUploadDialogOpen,\n      onOpenChange: setIsUploadDialogOpen,\n      children: /*#__PURE__*/_jsxDEV(DialogContent, {\n        className: \"max-w-md\",\n        children: [/*#__PURE__*/_jsxDEV(DialogHeader, {\n          children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n            className: \"flex items-center space-x-2\",\n            children: [uploadType === 'transaction' ? /*#__PURE__*/_jsxDEV(DollarSign, {\n              className: \"w-5 h-5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1076,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(Camera, {\n              className: \"w-5 h-5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1078,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"Upload \", uploadType === 'transaction' ? 'Transaction' : 'Rolling', \" Photo\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1080,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1074,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(DialogDescription, {\n            children: [\"Upload proof photo for \", selectedTripForUpload === null || selectedTripForUpload === void 0 ? void 0 : selectedTripForUpload.trip_name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1082,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1073,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: [selectedCustomer && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-3 bg-blue-50 rounded border\",\n            children: [/*#__PURE__*/_jsxDEV(Label, {\n              className: \"text-sm font-medium text-blue-800\",\n              children: \"Selected Customer\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1091,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-1\",\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"font-medium\",\n                children: selectedCustomer.customer_name || selectedCustomer.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1093,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1092,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1090,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(Label, {\n              htmlFor: \"uploadDate\",\n              children: \"Date (Required)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1100,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Input, {\n              id: \"uploadDate\",\n              type: \"date\",\n              value: uploadDate,\n              onChange: e => setUploadDate(e.target.value),\n              disabled: isSaving,\n              required: true,\n              className: \"mb-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1101,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1099,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(Label, {\n              htmlFor: \"uploadPhoto\",\n              children: \"Upload Photo\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1114,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Input, {\n              id: \"uploadPhoto\",\n              type: \"file\",\n              accept: \"image/*\",\n              onChange: e => {\n                if (e.target.files && e.target.files[0]) {\n                  setUploadPhoto(e.target.files[0]);\n                }\n              },\n              disabled: isSaving,\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1115,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1113,\n            columnNumber: 13\n          }, this), uploadPhoto && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-2\",\n            children: [/*#__PURE__*/_jsxDEV(Label, {\n              className: \"text-sm mb-1 block\",\n              children: \"Photo Preview\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1132,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"border rounded p-2 bg-gray-50\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: URL.createObjectURL(uploadPhoto),\n                alt: \"Preview\",\n                className: \"max-h-40 mx-auto object-contain\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1134,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1133,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1131,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-end space-x-2\",\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              type: \"button\",\n              variant: \"outline\",\n              onClick: () => setIsUploadDialogOpen(false),\n              disabled: isSaving,\n              children: \"Cancel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1146,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              onClick: handlePhotoUpload,\n              disabled: !uploadPhoto || !uploadDate || isSaving,\n              children: isSaving ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(Loader2, {\n                  className: \"mr-2 h-4 w-4 animate-spin\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1160,\n                  columnNumber: 21\n                }, this), \"Uploading...\"]\n              }, void 0, true) : 'Upload'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1154,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1145,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1087,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1072,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1071,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 499,\n    columnNumber: 5\n  }, this);\n}\n_s(StaffSelfServiceComponent, \"ZuVukrgl/SSLMilwLGSa91ZW0dI=\");\n_c = StaffSelfServiceComponent;\nexport const StaffSelfService = withErrorHandler(StaffSelfServiceComponent);\n_c2 = StaffSelfService;\nvar _c, _c2;\n$RefreshReg$(_c, \"StaffSelfServiceComponent\");\n$RefreshReg$(_c2, \"StaffSelfService\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","Button","Input","Label","Card","CardContent","CardDescription","CardHeader","CardTitle","Dialog","DialogContent","DialogDescription","DialogHeader","DialogTitle","DialogTrigger","Badge","Textarea","Tabs","TabsContent","TabsList","TabsTrigger","Clock","CheckCircle","XCircle","RefreshCw","LogIn","LogOut","Activity","Calendar","MapPin","Users","Camera","DollarSign","Loader2","ChevronUp","ChevronDown","ImageWithFallback","PhotoDisplay","withErrorHandler","apiClient","DSContainer","DSHeader","DSButton","DSNotification","iconSizes","jsxDEV","_jsxDEV","Fragment","_Fragment","StaffSelfServiceComponent","user","showError","clearError","_s","currentStaff","setCurrentStaff","shifts","setShifts","assignedTrips","setAssignedTrips","isCheckInDialogOpen","setIsCheckInDialogOpen","isCheckOutDialogOpen","setIsCheckOutDialogOpen","checkInPhoto","setCheckInPhoto","checkOutPhoto","setCheckOutPhoto","checkInNotes","setCheckInNotes","checkOutNotes","setCheckOutNotes","isLoading","setIsLoading","isSaving","setIsSaving","selectedTripForUpload","setSelectedTripForUpload","tripCustomers","setTripCustomers","selectedCustomer","setSelectedCustomer","uploadType","setUploadType","uploadPhoto","setUploadPhoto","uploadDate","setUploadDate","Date","toISOString","split","isUploadDialogOpen","setIsUploadDialogOpen","setCustomerTransactions","setCustomerRolling","expandedTripId","setExpandedTripId","customerPhotos","setCustomerPhotos","successMessage","setSuccessMessage","loadStaffData","staffId","staff_id","id","console","log","staffResponse","get","success","data","shiftsResponse","tripsResponse","enrichedTrips","map","trip","customers","activecustomerscount","error","getCurrentShift","find","shift","status","isCheckedIn","undefined","handleCheckIn","reader","FileReader","onload","e","_e$target","photoData","target","result","response","post","check_in_photo","notes","setTimeout","message","readAsDataURL","handleCheckOut","_e$target2","check_out_photo","loadTripDetails","customersLoaded","normalizeCustomerData","customer","possibleIdFields","field","val","possibleNameFields","name","trim","customer_id","customer_name","customersResponse","normalizedCustomers","tripCustomersResponse","transactionsResponse","rollingResponse","Promise","all","photosResponse","handlePhotoDelete","photoId","delete","errorMessage","includes","handlePhotoUpload","_e$target3","_selectedCustomer$cus","_selectedCustomer$cus2","photoJson","filename","size","type","uploaded_at","customerPhotoData","trip_id","photo_type","photo","uploaded_by","transaction_date","endpoint","className","children","fileName","_jsxFileName","lineNumber","columnNumber","currentShift","title","onClose","subtitle","username","badges","text","variant","length","actions","onClick","disabled","icon","sm","check_in_time","toLocaleString","shift_date","Math","floor","getTime","open","onOpenChange","asChild","htmlFor","accept","onChange","_e$target$files","files","required","value","placeholder","rows","_e$target$files2","defaultValue","trip_name","destination","start_date","toLocaleDateString","end_date","_customer$customer","_customer$customer2","customerId","customerName","customerSpecificPhotos","filter","transactionPhotos","p","rollingPhotos","photos","maxPhotos","onPhotoDelete","showDelete","role","some","showDownload","userRole","sort","a","b","dateA","checkInTime","shiftDate","dateB","slice","src","alt","check_out_time","URL","createObjectURL","_c","StaffSelfService","_c2","$RefreshReg$"],"sources":["/Users/user/Desktop/Cursor New Management System/management-system-1/Junket Management System Source Code/src/components/StaffSelfService.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Label } from './ui/label';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from './ui/card';\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from './ui/dialog';\nimport { Badge } from './ui/badge';\nimport { Textarea } from './ui/textarea';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from './ui/tabs';\nimport { User, Staff, StaffShift } from '../types';\nimport { Clock, CheckCircle, XCircle, RefreshCw, LogIn, LogOut, Activity, Calendar, MapPin, Users, Camera, DollarSign, Loader2, ChevronUp, ChevronDown } from 'lucide-react';\nimport { ImageWithFallback } from './figma/ImageWithFallback';\nimport { PhotoDisplay } from './common/PhotoDisplay';\nimport { withErrorHandler, WithErrorHandlerProps } from './withErrorHandler';\nimport { apiClient } from '../utils/api/apiClient';\nimport { \n  DSContainer, \n  DSHeader, \n  DSCard, \n  DSButton, \n  DSBadge, \n  DSNotification,\n  DSFormLayout,\n  spacing,\n  typography,\n  iconSizes,\n  buttonSizes\n} from './common/DesignSystem';\n\ninterface StaffSelfServiceProps extends WithErrorHandlerProps {\n  user: User;\n}\n\nfunction StaffSelfServiceComponent({ user, showError, clearError }: StaffSelfServiceProps) {\n  const [currentStaff, setCurrentStaff] = useState<Staff | null>(null);\n  const [shifts, setShifts] = useState<StaffShift[]>([]);\n  const [assignedTrips, setAssignedTrips] = useState<any[]>([]);\n  const [isCheckInDialogOpen, setIsCheckInDialogOpen] = useState(false);\n  const [isCheckOutDialogOpen, setIsCheckOutDialogOpen] = useState(false);\n  const [checkInPhoto, setCheckInPhoto] = useState<File | null>(null);\n  const [checkOutPhoto, setCheckOutPhoto] = useState<File | null>(null);\n  const [checkInNotes, setCheckInNotes] = useState('');\n  const [checkOutNotes, setCheckOutNotes] = useState('');\n  const [isLoading, setIsLoading] = useState(true);\n  const [isSaving, setIsSaving] = useState(false);\n  const [selectedTripForUpload, setSelectedTripForUpload] = useState<any>(null);\n  const [tripCustomers, setTripCustomers] = useState<any[]>([]);\n  const [selectedCustomer, setSelectedCustomer] = useState<any>(null);\n  const [uploadType, setUploadType] = useState<'transaction' | 'rolling'>('transaction');\n  const [uploadPhoto, setUploadPhoto] = useState<File | null>(null);\n  const [uploadDate, setUploadDate] = useState(new Date().toISOString().split('T')[0]); // 设置默认日期为当日\n  const [isUploadDialogOpen, setIsUploadDialogOpen] = useState(false);\n  const [, setCustomerTransactions] = useState<any[]>([]);\n  const [, setCustomerRolling] = useState<any[]>([]);\n  const [expandedTripId, setExpandedTripId] = useState<string | null>(null);\n  const [customerPhotos, setCustomerPhotos] = useState<any[]>([]);\n  const [successMessage, setSuccessMessage] = useState<string>('');\n\n  // Load staff data and shifts\n  const loadStaffData = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      clearError();\n\n      // Use staff_id from user object (user.id is users table ID, user.staff_id is staff table ID)\n      const staffId = (user as any).staff_id || user.id;\n      console.log('Loading staff data for staff ID:', staffId, 'User ID:', user.id);\n\n      // Get current staff info\n      const staffResponse = await apiClient.get(`/staffs/${staffId}`);\n      if (staffResponse.success) {\n        setCurrentStaff(staffResponse.data);\n      }\n\n      // Get staff shifts history\n      const shiftsResponse = await apiClient.get(`/staffs/${staffId}/shifts`);\n      if (shiftsResponse.success) {\n        setShifts(shiftsResponse.data);\n      }\n\n      // Get assigned trips (staff can only see their assigned trips)\n      const tripsResponse = await apiClient.get('/trips/my-schedule');\n      if (tripsResponse.success) {\n        // Use trip data directly without trying to fetch customer stats\n        // Staff will see customer details when they click \"View Customers\"\n        const enrichedTrips = (tripsResponse.data || []).map((trip: any) => ({\n          ...trip,\n          customers: [],\n          activecustomerscount: trip.activecustomerscount || 0\n        }));\n        setAssignedTrips(enrichedTrips);\n      } else {\n        setAssignedTrips([]);\n      }\n\n    } catch (error) {\n      console.error('Error loading staff data:', error);\n      showError('Failed to load staff data');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [user, clearError, showError]);\n\n  useEffect(() => {\n    loadStaffData();\n  }, [loadStaffData]);\n\n  const getCurrentShift = () => {\n    return shifts.find(shift => shift.status === 'checked-in');\n  };\n\n  const isCheckedIn = () => {\n    return getCurrentShift() !== undefined;\n  };\n\n  const handleCheckIn = async () => {\n    if (!checkInPhoto) return;\n\n    setIsSaving(true);\n    try {\n      // Convert photo to base64\n      const reader = new FileReader();\n      reader.onload = async (e) => {\n        try {\n          const photoData = e.target?.result as string;\n          \n          const staffId = (user as any).staff_id || user.id;\n          const response = await apiClient.post(`/staffs/${staffId}/check-in`, {\n            check_in_photo: photoData,\n            notes: checkInNotes\n          });\n\n          if (response.success) {\n            setIsCheckInDialogOpen(false);\n            setCheckInPhoto(null);\n            setCheckInNotes('');\n            setSuccessMessage('Check-in successful! You are now on duty.');\n            setTimeout(() => setSuccessMessage(''), 3000);\n            await loadStaffData(); // Refresh data\n          } else {\n            showError('Check-in failed: ' + response.message);\n          }\n        } catch (error) {\n          console.error('Check-in error:', error);\n          showError('Check-in failed');\n        } finally {\n          setIsSaving(false);\n        }\n      };\n      reader.readAsDataURL(checkInPhoto);\n    } catch (error) {\n      console.error('Check-in error:', error);\n      showError('Check-in failed');\n      setIsSaving(false);\n    }\n  };\n\n  const handleCheckOut = async () => {\n    if (!checkOutPhoto) return;\n\n    setIsSaving(true);\n    try {\n      const reader = new FileReader();\n      reader.onload = async (e) => {\n        try {\n          const photoData = e.target?.result as string;\n          \n          const staffId = (user as any).staff_id || user.id;\n          const response = await apiClient.post(`/staffs/${staffId}/check-out`, {\n            check_out_photo: photoData,\n            notes: checkOutNotes\n          });\n\n          if (response.success) {\n            setIsCheckOutDialogOpen(false);\n            setCheckOutPhoto(null);\n            setCheckOutNotes('');\n            setSuccessMessage('Check-out successful! Your shift has ended.');\n            setTimeout(() => setSuccessMessage(''), 3000);\n            await loadStaffData(); // Refresh data\n          } else {\n            showError('Check-out failed: ' + response.message);\n          }\n        } catch (error) {\n          console.error('Check-out error:', error);\n          showError('Check-out failed');\n        } finally {\n          setIsSaving(false);\n        }\n      };\n      reader.readAsDataURL(checkOutPhoto);\n    } catch (error) {\n      showError('Check-out failed');\n      setIsSaving(false);\n    }\n  };\n\n  // Load detailed trip data with customers and their transactions/rolling\n  const loadTripDetails = async (trip: any) => {\n    try {\n      \n      // Try multiple approaches to get customer data\n      let customersLoaded = false;\n      \n      \n      // 添加客户数据结构转换函数\n      const normalizeCustomerData = (customers: any[]) => {\n        return customers.map((customer) => {\n          // 检查所有可能的ID字段\n          const possibleIdFields = ['id', 'customer_id', 'customerId', 'ID', 'Id'];\n          const id = possibleIdFields.map(field => customer[field]).find(val => val) || 'unknown-id';\n          \n          // 检查所有可能的名字字段\n          const possibleNameFields = [\n            'name', 'customer_name', 'customerName', 'full_name', 'fullName', 'Name',\n            'first_name', 'firstName', 'last_name', 'lastName', 'display_name', 'displayName'\n          ];\n          \n          let name = possibleNameFields.map(field => customer[field]).find(val => val && val.trim());\n          \n          // 如果还是没有找到名字，尝试从嵌套对象中查找\n          if (!name && customer.customer) {\n            name = possibleNameFields.map(field => customer.customer[field]).find(val => val && val.trim());\n          }\n          \n          // 最后的回退策略 - 使用ID作为显示名称\n          if (!name) {\n            name = `Customer ${id}`;\n          }\n          \n          // 返回标准化的客户对象\n          return {\n            ...customer,\n            id,\n            name,\n            customer_id: id,\n            customer_name: name\n          };\n        });\n      };\n      \n      // Approach 1: Try trip-specific customer stats (recommended)\n      try {\n        const customersResponse = await apiClient.get(`/trips/${trip.id}/customer-stats`);\n        if (customersResponse.success) {\n          // 应用标准化函数处理客户数据\n          const normalizedCustomers = normalizeCustomerData(customersResponse.data || []);\n          setTripCustomers(normalizedCustomers);\n          customersLoaded = true;\n        }\n      } catch (error) {\n        console.log('Trip-specific customer stats failed, trying trip customers endpoint');\n      }\n      \n      // Approach 2: Try trip customers endpoint (more specific than customer-stats)\n      if (!customersLoaded) {\n        try {\n          const tripCustomersResponse = await apiClient.get(`/trips/${trip.id}/customers`);\n          if (tripCustomersResponse.success) {\n            // This should return only customers assigned to this specific trip\n            const normalizedCustomers = normalizeCustomerData(tripCustomersResponse.data || []);\n            setTripCustomers(normalizedCustomers);\n            customersLoaded = true;\n          }\n        } catch (error) {\n          console.log('Trip customers endpoint failed');\n        }\n      }\n      \n      // Approach 3: Use any existing trip data as fallback\n      if (!customersLoaded && trip.customers) {\n        const normalizedCustomers = normalizeCustomerData(trip.customers || []);\n        setTripCustomers(normalizedCustomers);\n        customersLoaded = true;\n      }\n      \n      // Load transactions, rolling records, and customer photos if we have customers\n      if (customersLoaded) {\n        try {\n          // 加载交易记录和滚码记录（旧API）\n          const [transactionsResponse, rollingResponse] = await Promise.all([\n            apiClient.get(`/transactions?trip_id=${trip.id}`),\n            apiClient.get(`/rolling-records?trip_id=${trip.id}`)\n          ]);\n          \n          console.log('Transactions response:', transactionsResponse);\n          console.log('Rolling response:', rollingResponse);\n          \n          if (transactionsResponse.success) {\n            setCustomerTransactions(transactionsResponse.data || []);\n          }\n          \n          if (rollingResponse.success) {\n            setCustomerRolling(rollingResponse.data || []);\n          }\n          \n          // 尝试加载客户照片（新API）\n          try {\n            const photosResponse = await apiClient.get(`/customer-photos?trip_id=${trip.id}`);\n            console.log('Customer photos response:', photosResponse);\n            if (photosResponse.success) {\n              setCustomerPhotos(photosResponse.data || []);\n            } else {\n              setCustomerPhotos([]);\n            }\n          } catch (error) {\n            console.log('Failed to load customer photos (new API may not be implemented yet):', error);\n            setCustomerPhotos([]);\n          }\n          \n        } catch (error) {\n          console.log('Failed to load transactions/rolling:', error);\n          setCustomerTransactions([]);\n          setCustomerRolling([]);\n          setCustomerPhotos([]);\n        }\n      } else {\n        // No customers loaded, set empty arrays\n        console.log('No customers loaded, setting empty arrays');\n        setTripCustomers([]);\n        setCustomerTransactions([]);\n        setCustomerRolling([]);\n        setCustomerPhotos([]);\n      }\n      \n      // Set the selected trip ID for the expandable section\n      setSelectedTripForUpload(trip);\n      \n    } catch (error) {\n      console.error('Error loading trip details:', error);\n      showError('Failed to load trip details');\n      \n      // Fallback: use any existing trip data\n      if (trip.customers) {\n        setTripCustomers(trip.customers);\n      }\n      setCustomerTransactions([]);\n      setCustomerRolling([]);\n      setCustomerPhotos([]);\n      \n      // Close the expanded section on error\n      setExpandedTripId(null);\n    }\n  };\n\n\n\n  // Legacy functions kept for future compatibility (currently unused)\n  // const getCustomerTransactions = (customerId: string) => {\n  //   return customerTransactions.filter(t => \n  //     (t.customer_id === customerId || t.customerId === customerId)\n  //   );\n  // };\n\n  // const getCustomerRolling = (customerId: string) => {\n  //   return customerRolling.filter(r => \n  //     (r.customer_id === customerId || r.customerId === customerId)\n  //   );\n  // };\n\n  // Handle photo deletion\n  const handlePhotoDelete = async (photoId: string) => {\n    setIsSaving(true);\n    try {\n      const response = await apiClient.delete(`/customer-photos/${photoId}`);\n      \n      if (response.success) {\n        console.log('✅ Photo deleted successfully:', photoId);\n        // Refresh customer photos - the UI will automatically update to show the photo is gone\n        if (selectedTripForUpload) {\n          await loadTripDetails(selectedTripForUpload);\n        }\n      } else {\n        // Handle different error types\n        const errorMessage = response.message || 'Unknown error occurred';\n        showError('Failed to delete photo: ' + errorMessage);\n      }\n    } catch (error: any) {\n      console.error('Photo deletion error:', error);\n      \n      // Handle specific HTTP errors\n      if (error.message && error.message.includes('403')) {\n        showError('Permission denied: You do not have permission to delete this photo. Only the uploader or admin can delete photos.');\n      } else if (error.message && error.message.includes('404')) {\n        showError('Photo not found: This photo may have already been deleted.');\n      } else if (error.message && error.message.includes('401')) {\n        showError('Authentication required: Please log in again to delete photos.');\n      } else {\n        showError('Failed to delete photo: ' + (error.message || 'Network or server error'));\n      }\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  // Handle photo upload for transaction/rolling using customer_photos table\n  const handlePhotoUpload = async () => {\n    if (!uploadPhoto || !selectedCustomer || !uploadDate) {\n      showError('Please fill in all required fields');\n      return;\n    }\n\n    setIsSaving(true);\n    try {\n      const reader = new FileReader();\n      reader.onload = async (e) => {\n        try {\n          const photoData = e.target?.result as string;\n          \n          // 使用新的customer_photos表结构，照片存储为JSON格式\n          const photoJson = {\n            data: photoData,                // 照片数据\n            filename: uploadPhoto.name,     // 文件名\n            size: uploadPhoto.size,         // 文件大小\n            type: uploadPhoto.type,         // 文件类型\n            uploaded_at: new Date().toISOString()\n          };\n          \n          const customerPhotoData: any = {\n            customer_id: selectedCustomer.customer?.id,\n            trip_id: selectedTripForUpload.id,\n            photo_type: uploadType,          // 'transaction' 或 'rolling'\n            photo: photoJson,                // 存储为JSON格式\n            uploaded_by: (user as any).staff_id || user.id,\n            transaction_date: uploadDate     // 交易日期\n            // status 字段由数据库默认设置为 'pending'，不需要手动指定\n          };\n\n          // 使用新的API端点\n          const endpoint = '/customer-photos';\n          \n          console.log(`Uploading ${uploadType} photo for customer:`, selectedCustomer.customer_name || selectedCustomer.name);\n          \n          // Debug log for selectedCustomer structure\n          console.log(\"🔍 Selected Customer Object:\", selectedCustomer);\n          console.log(\"🔍 Customer ID fields:\", {\n            \"selectedCustomer.id\": selectedCustomer.id,\n            \"selectedCustomer.customer_id\": selectedCustomer.customer_id,\n            \"selectedCustomer.customer?.id\": selectedCustomer.customer?.id\n          });\n          \n          // Debug log for photo upload payload\n          console.log(\"📸 Uploading photo payload:\", {\n            customer_id: customerPhotoData.customer_id,\n            trip_id: customerPhotoData.trip_id,\n            photo_type: customerPhotoData.photo_type,\n            photo: customerPhotoData.photo,\n            transaction_date: customerPhotoData.transaction_date,\n          });\n          \n          const response = await apiClient.post(endpoint, customerPhotoData);\n\n          if (response.success) {\n            setIsUploadDialogOpen(false);\n            setUploadPhoto(null);\n            setUploadDate(new Date().toISOString().split('T')[0]); // 重置日期为今天\n            setSelectedCustomer(null);\n            \n            // 显示成功消息\n            setSuccessMessage(`${uploadType === 'transaction' ? 'Transaction' : 'Rolling'} photo uploaded successfully and pending approval`);\n            // 3秒后自动清除成功消息\n            setTimeout(() => setSuccessMessage(''), 3000);\n            \n            // 刷新客户数据\n            await loadTripDetails(selectedTripForUpload);\n          } else {\n            showError(`Failed to upload ${uploadType} photo: ` + response.message);\n          }\n        } catch (error) {\n          console.error(`${uploadType} photo upload error:`, error);\n          showError(`Failed to upload ${uploadType} photo`);\n        } finally {\n          setIsSaving(false);\n        }\n      };\n      reader.readAsDataURL(uploadPhoto);\n    } catch (error) {\n      console.error(`${uploadType} upload error:`, error);\n      showError(`Failed to upload ${uploadType}`);\n      setIsSaving(false);\n    }\n  };\n\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-sm text-gray-600\">Loading staff information...</p>\n        </div>\n      </div>\n    );\n  }\n\n  const currentShift = getCurrentShift();\n\n  return (\n    <DSContainer>\n      {/* Success Message */}\n      {successMessage && (\n        <DSNotification\n          type=\"success\"\n          title=\"Success\"\n          message={successMessage}\n          onClose={() => setSuccessMessage('')}\n        />\n      )}\n      \n      {/* Header */}\n      <DSHeader\n        title=\"Staff Self-Service\"\n        subtitle={`Welcome, ${currentStaff?.name || user.username}`}\n        badges={[\n          { text: `Staff ID: ${user.id}`, variant: 'gray' },\n          { text: `${assignedTrips.length} Assigned Trips`, variant: 'primary' }\n        ]}\n        actions={\n          <DSButton\n            variant=\"outline\"\n            size=\"mobile\"\n            onClick={loadStaffData}\n            disabled={isLoading}\n            icon={<RefreshCw className={iconSizes.sm} />}\n          >\n            <span className=\"hidden sm:inline\">Refresh</span>\n            <span className=\"sm:hidden\">Refresh Data</span>\n          </DSButton>\n        }\n      />\n\n      {/* Current Status Card */}\n      <Card>\n        <CardHeader className=\"pb-3 sm:pb-6\">\n          <CardTitle className=\"flex items-center space-x-2 text-base sm:text-lg\">\n            <Clock className=\"w-4 h-4 sm:w-5 sm:h-5\" />\n            <span>Current Status</span>\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"pt-0\">\n          <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0\">\n            <div className=\"flex-1 min-w-0\">\n              {isCheckedIn() ? (\n                <div className=\"space-y-2\">\n                  <div className=\"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-2\">\n                    <Badge className=\"bg-green-100 text-green-800 px-3 py-1 w-fit\">\n                      <CheckCircle className=\"w-3 h-3 sm:w-4 sm:h-4 mr-1\" />\n                      On Duty\n                    </Badge>\n                    <span className=\"text-xs sm:text-sm text-gray-600\">\n                      Since: {new Date((currentShift as any)!.check_in_time).toLocaleString()}\n                    </span>\n                  </div>\n                  <div className=\"text-xs text-gray-500\">\n                    <div className=\"sm:inline\">Shift Date: {(currentShift as any)!.shift_date}</div>\n                    <div className=\"sm:inline sm:ml-2\">\n                      Duration: {Math.floor((new Date().getTime() - new Date((currentShift as any)!.check_in_time).getTime()) / (1000 * 60))} min\n                    </div>\n                  </div>\n                </div>\n              ) : (\n                <div className=\"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-2\">\n                  <Badge variant=\"secondary\" className=\"px-3 py-1 w-fit\">\n                    <XCircle className=\"w-3 h-3 sm:w-4 sm:h-4 mr-1\" />\n                    Off Duty\n                  </Badge>\n                  <span className=\"text-xs sm:text-sm text-gray-600\">Ready to check in</span>\n                </div>\n              )}\n            </div>\n\n            <div className=\"flex flex-col sm:flex-row gap-2 sm:space-x-2\">\n              {isCheckedIn() ? (\n                <Dialog open={isCheckOutDialogOpen} onOpenChange={setIsCheckOutDialogOpen}>\n                  <DialogTrigger asChild>\n                    <Button variant=\"destructive\" disabled={isSaving} className=\"w-full sm:w-auto\">\n                      <LogOut className=\"w-3 h-3 sm:w-4 sm:h-4 mr-2\" />\n                      <span className=\"hidden sm:inline\">Check Out</span>\n                      <span className=\"sm:hidden\">Check Out</span>\n                    </Button>\n                  </DialogTrigger>\n                  <DialogContent>\n                    <DialogHeader>\n                      <DialogTitle>Check Out</DialogTitle>\n                      <DialogDescription>\n                        Upload a photo as proof of check-out and add any end-of-shift notes.\n                      </DialogDescription>\n                    </DialogHeader>\n                    <div className=\"space-y-4\">\n                      <div>\n                        <Label htmlFor=\"checkOutPhoto\">Check-out Photo (Required)</Label>\n                        <Input\n                          id=\"checkOutPhoto\"\n                          type=\"file\"\n                          accept=\"image/*\"\n                          onChange={(e) => setCheckOutPhoto(e.target.files?.[0] || null)}\n                          className=\"mt-1\"\n                          required\n                          disabled={isSaving}\n                        />\n                      </div>\n                      <div>\n                        <Label htmlFor=\"checkOutNotes\">End of Shift Notes (Optional)</Label>\n                        <Textarea\n                          id=\"checkOutNotes\"\n                          value={checkOutNotes}\n                          onChange={(e) => setCheckOutNotes(e.target.value)}\n                          placeholder=\"Any end-of-shift notes...\"\n                          rows={3}\n                          disabled={isSaving}\n                        />\n                      </div>\n                      <div className=\"flex justify-end space-x-2\">\n                        <Button type=\"button\" variant=\"outline\" onClick={() => setIsCheckOutDialogOpen(false)} disabled={isSaving}>\n                          Cancel\n                        </Button>\n                        <Button onClick={handleCheckOut} disabled={!checkOutPhoto || isSaving}>\n                          {isSaving ? (\n                            <>\n                              <Activity className=\"w-4 h-4 mr-2 animate-spin\" />\n                              Saving...\n                            </>\n                          ) : (\n                            <>\n                              <LogOut className=\"w-4 h-4 mr-2\" />\n                              Check Out\n                            </>\n                          )}\n                        </Button>\n                      </div>\n                    </div>\n                  </DialogContent>\n                </Dialog>\n              ) : (\n                <Dialog open={isCheckInDialogOpen} onOpenChange={setIsCheckInDialogOpen}>\n                  <DialogTrigger asChild>\n                    <Button disabled={isSaving} className=\"w-full sm:w-auto\">\n                      <LogIn className=\"w-3 h-3 sm:w-4 sm:h-4 mr-2\" />\n                      <span className=\"hidden sm:inline\">Check In</span>\n                      <span className=\"sm:hidden\">Check In</span>\n                    </Button>\n                  </DialogTrigger>\n                  <DialogContent>\n                    <DialogHeader>\n                      <DialogTitle>Check In</DialogTitle>\n                      <DialogDescription>\n                        Upload a photo as proof of check-in and add any notes for the shift.\n                      </DialogDescription>\n                    </DialogHeader>\n                    <div className=\"space-y-4\">\n                      <div>\n                        <Label htmlFor=\"checkInPhoto\">Check-in Photo (Required)</Label>\n                        <Input\n                          id=\"checkInPhoto\"\n                          type=\"file\"\n                          accept=\"image/*\"\n                          onChange={(e) => setCheckInPhoto(e.target.files?.[0] || null)}\n                          className=\"mt-1\"\n                          required\n                          disabled={isSaving}\n                        />\n                      </div>\n                      <div>\n                        <Label htmlFor=\"checkInNotes\">Notes (Optional)</Label>\n                        <Textarea\n                          id=\"checkInNotes\"\n                          value={checkInNotes}\n                          onChange={(e) => setCheckInNotes(e.target.value)}\n                          placeholder=\"Any notes for this shift...\"\n                          rows={3}\n                          disabled={isSaving}\n                        />\n                      </div>\n                      <div className=\"flex justify-end space-x-2\">\n                        <Button type=\"button\" variant=\"outline\" onClick={() => setIsCheckInDialogOpen(false)} disabled={isSaving}>\n                          Cancel\n                        </Button>\n                        <Button onClick={handleCheckIn} disabled={!checkInPhoto || isSaving}>\n                          {isSaving ? (\n                            <>\n                              <Activity className=\"w-4 h-4 mr-2 animate-spin\" />\n                              Saving...\n                            </>\n                          ) : (\n                            <>\n                              <LogIn className=\"w-4 h-4 mr-2\" />\n                              Check In\n                            </>\n                          )}\n                        </Button>\n                      </div>\n                    </div>\n                  </DialogContent>\n                </Dialog>\n              )}\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Tabbed Content */}\n      <Tabs defaultValue=\"trips\" className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-2 h-auto\">\n          <TabsTrigger value=\"trips\" className=\"flex items-center space-x-1 sm:space-x-2 py-2 sm:py-3\">\n            <MapPin className=\"w-3 h-3 sm:w-4 sm:h-4\" />\n            <span className=\"text-xs sm:text-sm\">My Trips</span>\n          </TabsTrigger>\n          <TabsTrigger value=\"shifts\" className=\"flex items-center space-x-1 sm:space-x-2 py-2 sm:py-3\">\n            <Calendar className=\"w-3 h-3 sm:w-4 sm:h-4\" />\n            <span className=\"text-xs sm:text-sm\">My Shifts</span>\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"trips\" className=\"mt-6\">\n          <Card>\n            <CardHeader className=\"pb-3 sm:pb-6\">\n              <CardTitle className=\"flex items-center space-x-2 text-base sm:text-lg\">\n                <MapPin className=\"w-4 h-4 sm:w-5 sm:h-5\" />\n                <span>Assigned Trips</span>\n              </CardTitle>\n              <CardDescription className=\"text-sm\">Trips you are assigned to manage</CardDescription>\n            </CardHeader>\n            <CardContent>\n              {assignedTrips.length === 0 ? (\n                <div className=\"text-center py-8\">\n                  <Users className=\"w-12 h-12 mx-auto text-gray-400 mb-4\" />\n                  <p className=\"text-gray-500\">No trips assigned.</p>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {assignedTrips.map((trip) => (\n                    <div key={trip.id} className=\"mb-4\">\n                      <Card className=\"border-l-4 border-l-blue-400\">\n                        <CardContent className=\"p-3 sm:p-4\">\n                          <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0 mb-3\">\n                            <div className=\"flex items-center space-x-2 min-w-0 flex-1\">\n                              <h4 className=\"font-medium text-sm sm:text-base truncate\">{trip.trip_name}</h4>\n                            </div>\n                            <Badge className={`text-xs w-fit ${\n                              trip.status === 'active' ? 'bg-green-100 text-green-800' :\n                              trip.status === 'in-progress' ? 'bg-blue-100 text-blue-800' :\n                              'bg-gray-100 text-gray-800'\n                            }`}>\n                              {trip.status}\n                            </Badge>\n                          </div>\n                          <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 text-sm\">\n                            <div>\n                              <Label className=\"text-xs text-gray-500\">Destination</Label>\n                              <p className=\"text-sm\">{trip.destination}</p>\n                            </div>\n                            <div>\n                              <Label className=\"text-xs text-gray-500\">Dates</Label>\n                              <p className=\"text-sm\">{new Date(trip.start_date).toLocaleDateString()} - {new Date(trip.end_date).toLocaleDateString()}</p>\n                            </div>\n                          </div>\n                          <div className=\"mt-3 flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0\">\n                            <div className=\"flex flex-wrap gap-2\">\n                              <Badge variant=\"outline\" className=\"text-xs\">\n                                {trip.activecustomerscount || 0} Active Customers\n                              </Badge>\n                            </div>\n                            <div className=\"flex flex-col sm:flex-row gap-2 sm:space-x-2\">\n                              <Button\n                                size=\"sm\"\n                                variant=\"outline\"\n                                onClick={() => {\n                                  // Toggle expanded state for this trip\n                                  setExpandedTripId(expandedTripId === trip.id ? null : trip.id);\n                                  // Load customer data if expanding and not already loaded\n                                  if (expandedTripId !== trip.id) {\n                                    loadTripDetails(trip);\n                                  }\n                                }}\n                                className=\"text-xs w-full sm:w-auto\"\n                              >\n                                {expandedTripId === trip.id ? (\n                                  <>\n                                    <ChevronUp className=\"w-3 h-3 mr-1\" />\n                                    <span className=\"hidden sm:inline\">Hide Customers</span>\n                                    <span className=\"sm:hidden\">Hide</span>\n                                  </>\n                                ) : (\n                                  <>\n                                    <ChevronDown className=\"w-3 h-3 mr-1\" />\n                                    <span className=\"hidden sm:inline\">View Customers</span>\n                                    <span className=\"sm:hidden\">View</span>\n                                  </>\n                                )}\n                              </Button>\n                            </div>\n                          </div>\n                        </CardContent>\n                      </Card>\n                      \n                      {/* Expandable Customer Section */}\n                      {expandedTripId === trip.id && (\n                        <div className=\"mt-3 pl-2 sm:pl-4 border-l-2 border-blue-200\">\n                          {tripCustomers.length === 0 ? (\n                            <div className=\"text-center py-6 bg-gray-50 rounded\">\n                              <Users className=\"w-6 h-6 sm:w-8 sm:h-8 mx-auto text-gray-400 mb-2\" />\n                              <p className=\"text-xs sm:text-sm text-gray-500\">Loading customers...</p>\n                            </div>\n                          ) : (\n                            <div className=\"space-y-2 sm:space-y-3\">\n                              {/* 调试信息 */}\n                              {tripCustomers.map((customer) => {\n                                \n                                // 使用正确的customer ID和name\n                                const customerId = customer.customer?.id || customer.customer_id;\n                                const customerName = customer.customer?.name || customer.name;\n                                \n                                \n                                // 筛选当前客户的照片\n                                const customerSpecificPhotos = customerPhotos.filter(photo => \n                                  photo.customer_id === customerId\n                                );\n                                \n                                // Debug: Photo matching (can be removed in production)\n                                // console.log(`🔍 Customer ${customerName} (${customerId}):`, {\n                                //   totalPhotos: customerPhotos.length,\n                                //   matchingPhotos: customerSpecificPhotos.length\n                                // });\n                                \n                                // 获取该客户最新的交易和滚码照片\n                                const transactionPhotos = customerSpecificPhotos.filter(p => p.photo_type === 'transaction');\n                                const rollingPhotos = customerSpecificPhotos.filter(p => p.photo_type === 'rolling');\n                                \n                                // Photo data available for future features (currently unused)\n                                // const latestTransactionPhoto = transactionPhotos.length > 0 ? \n                                //   [...transactionPhotos].sort((a, b) => {\n                                //     const dateA = new Date(a.upload_date);\n                                //     const dateB = new Date(b.upload_date);\n                                //     return dateB.getTime() - dateA.getTime();\n                                //   })[0] : null;\n                                \n                                // const latestRollingPhoto = rollingPhotos.length > 0 ? \n                                //   [...rollingPhotos].sort((a, b) => {\n                                //     const dateA = new Date(a.upload_date);\n                                //     const dateB = new Date(b.upload_date);\n                                //     return dateB.getTime() - dateA.getTime();\n                                //   })[0] : null;\n                                \n                                // Legacy data compatibility (currently unused)\n                                // const transactions = getCustomerTransactions(customerId);\n                                // const rolling = getCustomerRolling(customerId);\n                                \n                                // Fallback data for future use (currently unused but kept for potential features)\n                                // const fallbackTransaction = transactions.length > 0 ? \n                                //   [...transactions].sort((a, b) => {\n                                //     const dateA = new Date(a.created_at || a.timestamp);\n                                //     const dateB = new Date(b.created_at || b.timestamp);\n                                //     return dateB.getTime() - dateA.getTime();\n                                //   })[0] : null;\n                                \n                                // const fallbackRolling = rolling.length > 0 ? \n                                //   [...rolling].sort((a, b) => {\n                                //     const dateA = new Date(a.created_at || a.timestamp);\n                                //     const dateB = new Date(b.created_at || b.timestamp);\n                                //     return dateB.getTime() - dateA.getTime();\n                                //   })[0] : null;\n                                  \n                                // Helper function for photo validation (available for future use)\n                                // const isValidPhotoData = (photoData: string) => {\n                                //   if (!photoData) return false;\n                                //   // Check if it's a valid base64 image data URL and not just \"test\"\n                                //   return photoData.startsWith('data:image/') && \n                                //          !photoData.includes('base64,test') && \n                                //          photoData.length > 100; // Reasonable minimum length for actual image data\n                                // };\n                                \n                                // Get valid photo data or null (currently unused but available for future features)\n                                // const validTransactionPhotoData = latestTransactionPhoto?.photo?.data && \n                                //   isValidPhotoData(latestTransactionPhoto.photo.data) ? \n                                //   latestTransactionPhoto.photo.data : null;\n                                  \n                                // const validRollingPhotoData = latestRollingPhoto?.photo?.data && \n                                //   isValidPhotoData(latestRollingPhoto.photo.data) ? \n                                //   latestRollingPhoto.photo.data : null;\n                                \n                                // Debug: Photo display validation (can be removed in production)\n                                // console.log(`📷 ${customerName} photos:`, {\n                                //   validTransactionPhotoData: validTransactionPhotoData ? 'Valid' : 'Invalid/Missing',\n                                //   validRollingPhotoData: validRollingPhotoData ? 'Valid' : 'Invalid/Missing'\n                                // });\n                                \n                                return (\n                                  <Card key={customerId} className=\"border-l-4 border-l-gray-300\">\n                                    <CardContent className=\"p-2 sm:p-3\">\n                                      <div className=\"flex flex-col sm:flex-row sm:justify-between sm:items-center space-y-2 sm:space-y-0 mb-3\">\n                                        <h5 className=\"text-sm sm:text-base font-medium truncate\">\n                                          {customerName || `Customer`}\n                                        </h5>\n                                        <Badge variant=\"outline\" className=\"bg-green-50 text-green-700 border-green-200 text-xs w-fit\">\n                                          Active\n                                        </Badge>\n                                      </div>\n                                      \n                                      <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4\">\n                                        {/* Transaction Photo Section */}\n                                        <div className=\"border rounded p-2 sm:p-3\">\n                                          <h6 className=\"text-xs sm:text-sm font-medium mb-2\">Transaction</h6>\n                                          <div className=\"mb-3\">\n                                            <PhotoDisplay\n                                              photos={transactionPhotos}\n                                              type=\"transaction\"\n                                              size=\"medium\"\n                                              maxPhotos={4}\n                                              onPhotoDelete={handlePhotoDelete}\n                                              showDelete={user.role === 'admin' || transactionPhotos.some(photo => \n                                                photo.uploaded_by === ((user as any).staff_id)\n                                              )}\n                                              showDownload={true}\n                                              userRole={user.role}\n                                              customerName={customerName}\n                                            />\n                                          </div>\n                                          \n                                          <DSButton\n                                            variant=\"outline\"\n                                            size=\"mobile\"\n                                            onClick={() => {\n                                              setSelectedCustomer(customer);\n                                              setUploadType('transaction');\n                                              setIsUploadDialogOpen(true);\n                                            }}\n                                            icon={<Camera className={iconSizes.sm} />}\n                                          >\n                                            <span className=\"hidden sm:inline\">Upload Transaction Photo</span>\n                                            <span className=\"sm:hidden\">Upload Transaction</span>\n                                          </DSButton>\n                                        </div>\n                                        \n                                        {/* Rolling Photo Section */}\n                                        <div className=\"border rounded p-2 sm:p-3\">\n                                          <h6 className=\"text-xs sm:text-sm font-medium mb-2\">Rolling</h6>\n                                          <div className=\"mb-3\">\n                                            <PhotoDisplay\n                                              photos={rollingPhotos}\n                                              type=\"rolling\"\n                                              size=\"medium\"\n                                              maxPhotos={4}\n                                              onPhotoDelete={handlePhotoDelete}\n                                              showDelete={user.role === 'admin' || rollingPhotos.some(photo => \n                                                photo.uploaded_by === ((user as any).staff_id)\n                                              )}\n                                              showDownload={true}\n                                              userRole={user.role}\n                                              customerName={customerName}\n                                            />\n                                          </div>\n                                          \n                                          <DSButton\n                                            variant=\"outline\"\n                                            size=\"mobile\"\n                                            onClick={() => {\n                                              setSelectedCustomer(customer);\n                                              setUploadType('rolling');\n                                              setIsUploadDialogOpen(true);\n                                            }}\n                                            icon={<Camera className={iconSizes.sm} />}\n                                          >\n                                            <span className=\"hidden sm:inline\">Upload Rolling Photo</span>\n                                            <span className=\"sm:hidden\">Upload Rolling</span>\n                                          </DSButton>\n                                        </div>\n                                      </div>\n                                    </CardContent>\n                                  </Card>\n                                );\n                              })}\n                            </div>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"shifts\" className=\"mt-4 sm:mt-6\">\n          <Card>\n            <CardHeader className=\"pb-3 sm:pb-6\">\n              <CardTitle className=\"flex items-center space-x-2 text-base sm:text-lg\">\n                <Calendar className=\"w-4 h-4 sm:w-5 sm:h-5\" />\n                <span>Shift History</span>\n              </CardTitle>\n              <CardDescription className=\"text-sm\">Your recent shifts and attendance</CardDescription>\n            </CardHeader>\n            <CardContent>\n              {shifts.length === 0 ? (\n                <div className=\"text-center py-8\">\n                  <Clock className=\"w-12 h-12 mx-auto text-gray-400 mb-4\" />\n                  <p className=\"text-gray-500\">No shift history found.</p>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {shifts\n                    .sort((a, b) => {\n                      // Sort by newest date/time first\n                      const dateA = new Date((a as any).check_in_time || (a as any).shift_date || a.checkInTime || a.shiftDate);\n                      const dateB = new Date((b as any).check_in_time || (b as any).shift_date || b.checkInTime || b.shiftDate);\n                      return dateB.getTime() - dateA.getTime();\n                    })\n                    .slice(0, 10)\n                    .map((shift) => (\n                    <Card key={shift.id} className=\"border-l-4 border-l-blue-400\">\n                      <CardContent className=\"p-3 sm:p-4\">\n                        <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0 mb-3\">\n                          <div className=\"flex items-center space-x-2\">\n                            <Calendar className=\"w-3 h-3 sm:w-4 sm:h-4 text-gray-400\" />\n                            <span className=\"font-medium text-sm sm:text-base\">{(shift as any).shift_date}</span>\n                          </div>\n                          <Badge className={`text-xs w-fit ${shift.status === 'checked-in' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}`}>\n                            {shift.status === 'checked-in' ? 'On Duty' : 'Completed'}\n                          </Badge>\n                        </div>\n                        \n                        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 text-sm\">\n                          <div>\n                            <Label className=\"text-xs text-gray-500\">Check-in Time</Label>\n                            <p>{new Date((shift as any).check_in_time).toLocaleString()}</p>\n                            {(shift as any).check_in_photo && (\n                              <div className=\"mt-2\">\n                                <ImageWithFallback\n                                  src={(shift as any).check_in_photo}\n                                  alt=\"Check-in proof\"\n                                  className=\"w-12 h-12 sm:w-16 sm:h-16 object-cover rounded border\"\n                                />\n                              </div>\n                            )}\n                          </div>\n                          \n                          {(shift as any).check_out_time && (\n                            <div>\n                              <Label className=\"text-xs text-gray-500\">Check-out Time</Label>\n                              <p>{new Date((shift as any).check_out_time).toLocaleString()}</p>\n                              {(shift as any).check_out_photo && (\n                                <div className=\"mt-2\">\n                                  <ImageWithFallback\n                                    src={(shift as any).check_out_photo}\n                                    alt=\"Check-out proof\"\n                                    className=\"w-12 h-12 sm:w-16 sm:h-16 object-cover rounded border\"\n                                  />\n                                </div>\n                              )}\n                            </div>\n                          )}\n                        </div>\n                        \n                        {shift.notes && (\n                          <div className=\"mt-3 p-2 bg-gray-50 rounded text-xs\">\n                            <Label className=\"text-gray-500\">Notes</Label>\n                            <p className=\"text-gray-700 mt-1\">{shift.notes}</p>\n                          </div>\n                        )}\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n\n      {/* Upload Dialog */}\n      <Dialog open={isUploadDialogOpen} onOpenChange={setIsUploadDialogOpen}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center space-x-2\">\n              {uploadType === 'transaction' ? (\n                <DollarSign className=\"w-5 h-5\" />\n              ) : (\n                <Camera className=\"w-5 h-5\" />\n              )}\n              <span>Upload {uploadType === 'transaction' ? 'Transaction' : 'Rolling'} Photo</span>\n            </DialogTitle>\n            <DialogDescription>\n              Upload proof photo for {selectedTripForUpload?.trip_name}\n            </DialogDescription>\n          </DialogHeader>\n          \n          <div className=\"space-y-4\">\n            {/* Selected Customer Info */}\n            {selectedCustomer && (\n              <div className=\"p-3 bg-blue-50 rounded border\">\n                <Label className=\"text-sm font-medium text-blue-800\">Selected Customer</Label>\n                <div className=\"mt-1\">\n                  <p className=\"font-medium\">{selectedCustomer.customer_name || selectedCustomer.name}</p>\n                </div>\n              </div>\n            )}\n\n            {/* Date Input */}\n            <div>\n              <Label htmlFor=\"uploadDate\">Date (Required)</Label>\n              <Input\n                id=\"uploadDate\"\n                type=\"date\"\n                value={uploadDate}\n                onChange={(e) => setUploadDate(e.target.value)}\n                disabled={isSaving}\n                required\n                className=\"mb-2\"\n              />\n            </div>\n\n            {/* Photo Upload */}\n            <div>\n              <Label htmlFor=\"uploadPhoto\">Upload Photo</Label>\n              <Input\n                id=\"uploadPhoto\"\n                type=\"file\"\n                accept=\"image/*\"\n                onChange={(e) => {\n                  if (e.target.files && e.target.files[0]) {\n                    setUploadPhoto(e.target.files[0]);\n                  }\n                }}\n                disabled={isSaving}\n                required\n              />\n            </div>\n\n            {/* Photo Preview */}\n            {uploadPhoto && (\n              <div className=\"mt-2\">\n                <Label className=\"text-sm mb-1 block\">Photo Preview</Label>\n                <div className=\"border rounded p-2 bg-gray-50\">\n                  <img \n                    src={URL.createObjectURL(uploadPhoto)} \n                    alt=\"Preview\" \n                    className=\"max-h-40 mx-auto object-contain\"\n                  />\n                </div>\n              </div>\n            )}\n\n\n            {/* Action Buttons */}\n            <div className=\"flex justify-end space-x-2\">\n              <Button \n                type=\"button\" \n                variant=\"outline\" \n                onClick={() => setIsUploadDialogOpen(false)} \n                disabled={isSaving}\n              >\n                Cancel\n              </Button>\n              <Button \n                onClick={handlePhotoUpload} \n                disabled={!uploadPhoto || !uploadDate || isSaving}\n              >\n                {isSaving ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    Uploading...\n                  </>\n                ) : (\n                  'Upload'\n                )}\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </DSContainer>\n  );\n}\n\nexport const StaffSelfService = withErrorHandler(StaffSelfServiceComponent);\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;AAC/D,SAASC,MAAM,QAAQ,aAAa;AACpC,SAASC,KAAK,QAAQ,YAAY;AAClC,SAASC,KAAK,QAAQ,YAAY;AAClC,SAASC,IAAI,EAAEC,WAAW,EAAEC,eAAe,EAAEC,UAAU,EAAEC,SAAS,QAAQ,WAAW;AACrF,SAASC,MAAM,EAAEC,aAAa,EAAEC,iBAAiB,EAAEC,YAAY,EAAEC,WAAW,EAAEC,aAAa,QAAQ,aAAa;AAChH,SAASC,KAAK,QAAQ,YAAY;AAClC,SAASC,QAAQ,QAAQ,eAAe;AACxC,SAASC,IAAI,EAAEC,WAAW,EAAEC,QAAQ,EAAEC,WAAW,QAAQ,WAAW;AAEpE,SAASC,KAAK,EAAEC,WAAW,EAAEC,OAAO,EAAEC,SAAS,EAAEC,KAAK,EAAEC,MAAM,EAAEC,QAAQ,EAAEC,QAAQ,EAAEC,MAAM,EAAEC,KAAK,EAAEC,MAAM,EAAEC,UAAU,EAAEC,OAAO,EAAEC,SAAS,EAAEC,WAAW,QAAQ,cAAc;AAC5K,SAASC,iBAAiB,QAAQ,2BAA2B;AAC7D,SAASC,YAAY,QAAQ,uBAAuB;AACpD,SAASC,gBAAgB,QAA+B,oBAAoB;AAC5E,SAASC,SAAS,QAAQ,wBAAwB;AAClD,SACEC,WAAW,EACXC,QAAQ,EAERC,QAAQ,EAERC,cAAc,EAIdC,SAAS,QAEJ,uBAAuB;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAM/B,SAASC,yBAAyBA,CAAC;EAAEC,IAAI;EAAEC,SAAS;EAAEC;AAAkC,CAAC,EAAE;EAAAC,EAAA;EACzF,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAGzD,QAAQ,CAAe,IAAI,CAAC;EACpE,MAAM,CAAC0D,MAAM,EAAEC,SAAS,CAAC,GAAG3D,QAAQ,CAAe,EAAE,CAAC;EACtD,MAAM,CAAC4D,aAAa,EAAEC,gBAAgB,CAAC,GAAG7D,QAAQ,CAAQ,EAAE,CAAC;EAC7D,MAAM,CAAC8D,mBAAmB,EAAEC,sBAAsB,CAAC,GAAG/D,QAAQ,CAAC,KAAK,CAAC;EACrE,MAAM,CAACgE,oBAAoB,EAAEC,uBAAuB,CAAC,GAAGjE,QAAQ,CAAC,KAAK,CAAC;EACvE,MAAM,CAACkE,YAAY,EAAEC,eAAe,CAAC,GAAGnE,QAAQ,CAAc,IAAI,CAAC;EACnE,MAAM,CAACoE,aAAa,EAAEC,gBAAgB,CAAC,GAAGrE,QAAQ,CAAc,IAAI,CAAC;EACrE,MAAM,CAACsE,YAAY,EAAEC,eAAe,CAAC,GAAGvE,QAAQ,CAAC,EAAE,CAAC;EACpD,MAAM,CAACwE,aAAa,EAAEC,gBAAgB,CAAC,GAAGzE,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAM,CAAC0E,SAAS,EAAEC,YAAY,CAAC,GAAG3E,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAAC4E,QAAQ,EAAEC,WAAW,CAAC,GAAG7E,QAAQ,CAAC,KAAK,CAAC;EAC/C,MAAM,CAAC8E,qBAAqB,EAAEC,wBAAwB,CAAC,GAAG/E,QAAQ,CAAM,IAAI,CAAC;EAC7E,MAAM,CAACgF,aAAa,EAAEC,gBAAgB,CAAC,GAAGjF,QAAQ,CAAQ,EAAE,CAAC;EAC7D,MAAM,CAACkF,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGnF,QAAQ,CAAM,IAAI,CAAC;EACnE,MAAM,CAACoF,UAAU,EAAEC,aAAa,CAAC,GAAGrF,QAAQ,CAA4B,aAAa,CAAC;EACtF,MAAM,CAACsF,WAAW,EAAEC,cAAc,CAAC,GAAGvF,QAAQ,CAAc,IAAI,CAAC;EACjE,MAAM,CAACwF,UAAU,EAAEC,aAAa,CAAC,GAAGzF,QAAQ,CAAC,IAAI0F,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACtF,MAAM,CAACC,kBAAkB,EAAEC,qBAAqB,CAAC,GAAG9F,QAAQ,CAAC,KAAK,CAAC;EACnE,MAAM,GAAG+F,uBAAuB,CAAC,GAAG/F,QAAQ,CAAQ,EAAE,CAAC;EACvD,MAAM,GAAGgG,kBAAkB,CAAC,GAAGhG,QAAQ,CAAQ,EAAE,CAAC;EAClD,MAAM,CAACiG,cAAc,EAAEC,iBAAiB,CAAC,GAAGlG,QAAQ,CAAgB,IAAI,CAAC;EACzE,MAAM,CAACmG,cAAc,EAAEC,iBAAiB,CAAC,GAAGpG,QAAQ,CAAQ,EAAE,CAAC;EAC/D,MAAM,CAACqG,cAAc,EAAEC,iBAAiB,CAAC,GAAGtG,QAAQ,CAAS,EAAE,CAAC;;EAEhE;EACA,MAAMuG,aAAa,GAAGrG,WAAW,CAAC,YAAY;IAC5C,IAAI;MACFyE,YAAY,CAAC,IAAI,CAAC;MAClBrB,UAAU,CAAC,CAAC;;MAEZ;MACA,MAAMkD,OAAO,GAAIpD,IAAI,CAASqD,QAAQ,IAAIrD,IAAI,CAACsD,EAAE;MACjDC,OAAO,CAACC,GAAG,CAAC,kCAAkC,EAAEJ,OAAO,EAAE,UAAU,EAAEpD,IAAI,CAACsD,EAAE,CAAC;;MAE7E;MACA,MAAMG,aAAa,GAAG,MAAMpE,SAAS,CAACqE,GAAG,CAAC,WAAWN,OAAO,EAAE,CAAC;MAC/D,IAAIK,aAAa,CAACE,OAAO,EAAE;QACzBtD,eAAe,CAACoD,aAAa,CAACG,IAAI,CAAC;MACrC;;MAEA;MACA,MAAMC,cAAc,GAAG,MAAMxE,SAAS,CAACqE,GAAG,CAAC,WAAWN,OAAO,SAAS,CAAC;MACvE,IAAIS,cAAc,CAACF,OAAO,EAAE;QAC1BpD,SAAS,CAACsD,cAAc,CAACD,IAAI,CAAC;MAChC;;MAEA;MACA,MAAME,aAAa,GAAG,MAAMzE,SAAS,CAACqE,GAAG,CAAC,oBAAoB,CAAC;MAC/D,IAAII,aAAa,CAACH,OAAO,EAAE;QACzB;QACA;QACA,MAAMI,aAAa,GAAG,CAACD,aAAa,CAACF,IAAI,IAAI,EAAE,EAAEI,GAAG,CAAEC,IAAS,KAAM;UACnE,GAAGA,IAAI;UACPC,SAAS,EAAE,EAAE;UACbC,oBAAoB,EAAEF,IAAI,CAACE,oBAAoB,IAAI;QACrD,CAAC,CAAC,CAAC;QACH1D,gBAAgB,CAACsD,aAAa,CAAC;MACjC,CAAC,MAAM;QACLtD,gBAAgB,CAAC,EAAE,CAAC;MACtB;IAEF,CAAC,CAAC,OAAO2D,KAAK,EAAE;MACdb,OAAO,CAACa,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;MACjDnE,SAAS,CAAC,2BAA2B,CAAC;IACxC,CAAC,SAAS;MACRsB,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC,EAAE,CAACvB,IAAI,EAAEE,UAAU,EAAED,SAAS,CAAC,CAAC;EAEjCpD,SAAS,CAAC,MAAM;IACdsG,aAAa,CAAC,CAAC;EACjB,CAAC,EAAE,CAACA,aAAa,CAAC,CAAC;EAEnB,MAAMkB,eAAe,GAAGA,CAAA,KAAM;IAC5B,OAAO/D,MAAM,CAACgE,IAAI,CAACC,KAAK,IAAIA,KAAK,CAACC,MAAM,KAAK,YAAY,CAAC;EAC5D,CAAC;EAED,MAAMC,WAAW,GAAGA,CAAA,KAAM;IACxB,OAAOJ,eAAe,CAAC,CAAC,KAAKK,SAAS;EACxC,CAAC;EAED,MAAMC,aAAa,GAAG,MAAAA,CAAA,KAAY;IAChC,IAAI,CAAC7D,YAAY,EAAE;IAEnBW,WAAW,CAAC,IAAI,CAAC;IACjB,IAAI;MACF;MACA,MAAMmD,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;MAC/BD,MAAM,CAACE,MAAM,GAAG,MAAOC,CAAC,IAAK;QAC3B,IAAI;UAAA,IAAAC,SAAA;UACF,MAAMC,SAAS,IAAAD,SAAA,GAAGD,CAAC,CAACG,MAAM,cAAAF,SAAA,uBAARA,SAAA,CAAUG,MAAgB;UAE5C,MAAM/B,OAAO,GAAIpD,IAAI,CAASqD,QAAQ,IAAIrD,IAAI,CAACsD,EAAE;UACjD,MAAM8B,QAAQ,GAAG,MAAM/F,SAAS,CAACgG,IAAI,CAAC,WAAWjC,OAAO,WAAW,EAAE;YACnEkC,cAAc,EAAEL,SAAS;YACzBM,KAAK,EAAErE;UACT,CAAC,CAAC;UAEF,IAAIkE,QAAQ,CAACzB,OAAO,EAAE;YACpBhD,sBAAsB,CAAC,KAAK,CAAC;YAC7BI,eAAe,CAAC,IAAI,CAAC;YACrBI,eAAe,CAAC,EAAE,CAAC;YACnB+B,iBAAiB,CAAC,2CAA2C,CAAC;YAC9DsC,UAAU,CAAC,MAAMtC,iBAAiB,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC;YAC7C,MAAMC,aAAa,CAAC,CAAC,CAAC,CAAC;UACzB,CAAC,MAAM;YACLlD,SAAS,CAAC,mBAAmB,GAAGmF,QAAQ,CAACK,OAAO,CAAC;UACnD;QACF,CAAC,CAAC,OAAOrB,KAAK,EAAE;UACdb,OAAO,CAACa,KAAK,CAAC,iBAAiB,EAAEA,KAAK,CAAC;UACvCnE,SAAS,CAAC,iBAAiB,CAAC;QAC9B,CAAC,SAAS;UACRwB,WAAW,CAAC,KAAK,CAAC;QACpB;MACF,CAAC;MACDmD,MAAM,CAACc,aAAa,CAAC5E,YAAY,CAAC;IACpC,CAAC,CAAC,OAAOsD,KAAK,EAAE;MACdb,OAAO,CAACa,KAAK,CAAC,iBAAiB,EAAEA,KAAK,CAAC;MACvCnE,SAAS,CAAC,iBAAiB,CAAC;MAC5BwB,WAAW,CAAC,KAAK,CAAC;IACpB;EACF,CAAC;EAED,MAAMkE,cAAc,GAAG,MAAAA,CAAA,KAAY;IACjC,IAAI,CAAC3E,aAAa,EAAE;IAEpBS,WAAW,CAAC,IAAI,CAAC;IACjB,IAAI;MACF,MAAMmD,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;MAC/BD,MAAM,CAACE,MAAM,GAAG,MAAOC,CAAC,IAAK;QAC3B,IAAI;UAAA,IAAAa,UAAA;UACF,MAAMX,SAAS,IAAAW,UAAA,GAAGb,CAAC,CAACG,MAAM,cAAAU,UAAA,uBAARA,UAAA,CAAUT,MAAgB;UAE5C,MAAM/B,OAAO,GAAIpD,IAAI,CAASqD,QAAQ,IAAIrD,IAAI,CAACsD,EAAE;UACjD,MAAM8B,QAAQ,GAAG,MAAM/F,SAAS,CAACgG,IAAI,CAAC,WAAWjC,OAAO,YAAY,EAAE;YACpEyC,eAAe,EAAEZ,SAAS;YAC1BM,KAAK,EAAEnE;UACT,CAAC,CAAC;UAEF,IAAIgE,QAAQ,CAACzB,OAAO,EAAE;YACpB9C,uBAAuB,CAAC,KAAK,CAAC;YAC9BI,gBAAgB,CAAC,IAAI,CAAC;YACtBI,gBAAgB,CAAC,EAAE,CAAC;YACpB6B,iBAAiB,CAAC,6CAA6C,CAAC;YAChEsC,UAAU,CAAC,MAAMtC,iBAAiB,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC;YAC7C,MAAMC,aAAa,CAAC,CAAC,CAAC,CAAC;UACzB,CAAC,MAAM;YACLlD,SAAS,CAAC,oBAAoB,GAAGmF,QAAQ,CAACK,OAAO,CAAC;UACpD;QACF,CAAC,CAAC,OAAOrB,KAAK,EAAE;UACdb,OAAO,CAACa,KAAK,CAAC,kBAAkB,EAAEA,KAAK,CAAC;UACxCnE,SAAS,CAAC,kBAAkB,CAAC;QAC/B,CAAC,SAAS;UACRwB,WAAW,CAAC,KAAK,CAAC;QACpB;MACF,CAAC;MACDmD,MAAM,CAACc,aAAa,CAAC1E,aAAa,CAAC;IACrC,CAAC,CAAC,OAAOoD,KAAK,EAAE;MACdnE,SAAS,CAAC,kBAAkB,CAAC;MAC7BwB,WAAW,CAAC,KAAK,CAAC;IACpB;EACF,CAAC;;EAED;EACA,MAAMqE,eAAe,GAAG,MAAO7B,IAAS,IAAK;IAC3C,IAAI;MAEF;MACA,IAAI8B,eAAe,GAAG,KAAK;;MAG3B;MACA,MAAMC,qBAAqB,GAAI9B,SAAgB,IAAK;QAClD,OAAOA,SAAS,CAACF,GAAG,CAAEiC,QAAQ,IAAK;UACjC;UACA,MAAMC,gBAAgB,GAAG,CAAC,IAAI,EAAE,aAAa,EAAE,YAAY,EAAE,IAAI,EAAE,IAAI,CAAC;UACxE,MAAM5C,EAAE,GAAG4C,gBAAgB,CAAClC,GAAG,CAACmC,KAAK,IAAIF,QAAQ,CAACE,KAAK,CAAC,CAAC,CAAC7B,IAAI,CAAC8B,GAAG,IAAIA,GAAG,CAAC,IAAI,YAAY;;UAE1F;UACA,MAAMC,kBAAkB,GAAG,CACzB,MAAM,EAAE,eAAe,EAAE,cAAc,EAAE,WAAW,EAAE,UAAU,EAAE,MAAM,EACxE,YAAY,EAAE,WAAW,EAAE,WAAW,EAAE,UAAU,EAAE,cAAc,EAAE,aAAa,CAClF;UAED,IAAIC,IAAI,GAAGD,kBAAkB,CAACrC,GAAG,CAACmC,KAAK,IAAIF,QAAQ,CAACE,KAAK,CAAC,CAAC,CAAC7B,IAAI,CAAC8B,GAAG,IAAIA,GAAG,IAAIA,GAAG,CAACG,IAAI,CAAC,CAAC,CAAC;;UAE1F;UACA,IAAI,CAACD,IAAI,IAAIL,QAAQ,CAACA,QAAQ,EAAE;YAC9BK,IAAI,GAAGD,kBAAkB,CAACrC,GAAG,CAACmC,KAAK,IAAIF,QAAQ,CAACA,QAAQ,CAACE,KAAK,CAAC,CAAC,CAAC7B,IAAI,CAAC8B,GAAG,IAAIA,GAAG,IAAIA,GAAG,CAACG,IAAI,CAAC,CAAC,CAAC;UACjG;;UAEA;UACA,IAAI,CAACD,IAAI,EAAE;YACTA,IAAI,GAAG,YAAYhD,EAAE,EAAE;UACzB;;UAEA;UACA,OAAO;YACL,GAAG2C,QAAQ;YACX3C,EAAE;YACFgD,IAAI;YACJE,WAAW,EAAElD,EAAE;YACfmD,aAAa,EAAEH;UACjB,CAAC;QACH,CAAC,CAAC;MACJ,CAAC;;MAED;MACA,IAAI;QACF,MAAMI,iBAAiB,GAAG,MAAMrH,SAAS,CAACqE,GAAG,CAAC,UAAUO,IAAI,CAACX,EAAE,iBAAiB,CAAC;QACjF,IAAIoD,iBAAiB,CAAC/C,OAAO,EAAE;UAC7B;UACA,MAAMgD,mBAAmB,GAAGX,qBAAqB,CAACU,iBAAiB,CAAC9C,IAAI,IAAI,EAAE,CAAC;UAC/E/B,gBAAgB,CAAC8E,mBAAmB,CAAC;UACrCZ,eAAe,GAAG,IAAI;QACxB;MACF,CAAC,CAAC,OAAO3B,KAAK,EAAE;QACdb,OAAO,CAACC,GAAG,CAAC,qEAAqE,CAAC;MACpF;;MAEA;MACA,IAAI,CAACuC,eAAe,EAAE;QACpB,IAAI;UACF,MAAMa,qBAAqB,GAAG,MAAMvH,SAAS,CAACqE,GAAG,CAAC,UAAUO,IAAI,CAACX,EAAE,YAAY,CAAC;UAChF,IAAIsD,qBAAqB,CAACjD,OAAO,EAAE;YACjC;YACA,MAAMgD,mBAAmB,GAAGX,qBAAqB,CAACY,qBAAqB,CAAChD,IAAI,IAAI,EAAE,CAAC;YACnF/B,gBAAgB,CAAC8E,mBAAmB,CAAC;YACrCZ,eAAe,GAAG,IAAI;UACxB;QACF,CAAC,CAAC,OAAO3B,KAAK,EAAE;UACdb,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC;QAC/C;MACF;;MAEA;MACA,IAAI,CAACuC,eAAe,IAAI9B,IAAI,CAACC,SAAS,EAAE;QACtC,MAAMyC,mBAAmB,GAAGX,qBAAqB,CAAC/B,IAAI,CAACC,SAAS,IAAI,EAAE,CAAC;QACvErC,gBAAgB,CAAC8E,mBAAmB,CAAC;QACrCZ,eAAe,GAAG,IAAI;MACxB;;MAEA;MACA,IAAIA,eAAe,EAAE;QACnB,IAAI;UACF;UACA,MAAM,CAACc,oBAAoB,EAAEC,eAAe,CAAC,GAAG,MAAMC,OAAO,CAACC,GAAG,CAAC,CAChE3H,SAAS,CAACqE,GAAG,CAAC,yBAAyBO,IAAI,CAACX,EAAE,EAAE,CAAC,EACjDjE,SAAS,CAACqE,GAAG,CAAC,4BAA4BO,IAAI,CAACX,EAAE,EAAE,CAAC,CACrD,CAAC;UAEFC,OAAO,CAACC,GAAG,CAAC,wBAAwB,EAAEqD,oBAAoB,CAAC;UAC3DtD,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEsD,eAAe,CAAC;UAEjD,IAAID,oBAAoB,CAAClD,OAAO,EAAE;YAChChB,uBAAuB,CAACkE,oBAAoB,CAACjD,IAAI,IAAI,EAAE,CAAC;UAC1D;UAEA,IAAIkD,eAAe,CAACnD,OAAO,EAAE;YAC3Bf,kBAAkB,CAACkE,eAAe,CAAClD,IAAI,IAAI,EAAE,CAAC;UAChD;;UAEA;UACA,IAAI;YACF,MAAMqD,cAAc,GAAG,MAAM5H,SAAS,CAACqE,GAAG,CAAC,4BAA4BO,IAAI,CAACX,EAAE,EAAE,CAAC;YACjFC,OAAO,CAACC,GAAG,CAAC,2BAA2B,EAAEyD,cAAc,CAAC;YACxD,IAAIA,cAAc,CAACtD,OAAO,EAAE;cAC1BX,iBAAiB,CAACiE,cAAc,CAACrD,IAAI,IAAI,EAAE,CAAC;YAC9C,CAAC,MAAM;cACLZ,iBAAiB,CAAC,EAAE,CAAC;YACvB;UACF,CAAC,CAAC,OAAOoB,KAAK,EAAE;YACdb,OAAO,CAACC,GAAG,CAAC,sEAAsE,EAAEY,KAAK,CAAC;YAC1FpB,iBAAiB,CAAC,EAAE,CAAC;UACvB;QAEF,CAAC,CAAC,OAAOoB,KAAK,EAAE;UACdb,OAAO,CAACC,GAAG,CAAC,sCAAsC,EAAEY,KAAK,CAAC;UAC1DzB,uBAAuB,CAAC,EAAE,CAAC;UAC3BC,kBAAkB,CAAC,EAAE,CAAC;UACtBI,iBAAiB,CAAC,EAAE,CAAC;QACvB;MACF,CAAC,MAAM;QACL;QACAO,OAAO,CAACC,GAAG,CAAC,2CAA2C,CAAC;QACxD3B,gBAAgB,CAAC,EAAE,CAAC;QACpBc,uBAAuB,CAAC,EAAE,CAAC;QAC3BC,kBAAkB,CAAC,EAAE,CAAC;QACtBI,iBAAiB,CAAC,EAAE,CAAC;MACvB;;MAEA;MACArB,wBAAwB,CAACsC,IAAI,CAAC;IAEhC,CAAC,CAAC,OAAOG,KAAK,EAAE;MACdb,OAAO,CAACa,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;MACnDnE,SAAS,CAAC,6BAA6B,CAAC;;MAExC;MACA,IAAIgE,IAAI,CAACC,SAAS,EAAE;QAClBrC,gBAAgB,CAACoC,IAAI,CAACC,SAAS,CAAC;MAClC;MACAvB,uBAAuB,CAAC,EAAE,CAAC;MAC3BC,kBAAkB,CAAC,EAAE,CAAC;MACtBI,iBAAiB,CAAC,EAAE,CAAC;;MAErB;MACAF,iBAAiB,CAAC,IAAI,CAAC;IACzB;EACF,CAAC;;EAID;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;;EAEA;EACA,MAAMoE,iBAAiB,GAAG,MAAOC,OAAe,IAAK;IACnD1F,WAAW,CAAC,IAAI,CAAC;IACjB,IAAI;MACF,MAAM2D,QAAQ,GAAG,MAAM/F,SAAS,CAAC+H,MAAM,CAAC,oBAAoBD,OAAO,EAAE,CAAC;MAEtE,IAAI/B,QAAQ,CAACzB,OAAO,EAAE;QACpBJ,OAAO,CAACC,GAAG,CAAC,+BAA+B,EAAE2D,OAAO,CAAC;QACrD;QACA,IAAIzF,qBAAqB,EAAE;UACzB,MAAMoE,eAAe,CAACpE,qBAAqB,CAAC;QAC9C;MACF,CAAC,MAAM;QACL;QACA,MAAM2F,YAAY,GAAGjC,QAAQ,CAACK,OAAO,IAAI,wBAAwB;QACjExF,SAAS,CAAC,0BAA0B,GAAGoH,YAAY,CAAC;MACtD;IACF,CAAC,CAAC,OAAOjD,KAAU,EAAE;MACnBb,OAAO,CAACa,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;;MAE7C;MACA,IAAIA,KAAK,CAACqB,OAAO,IAAIrB,KAAK,CAACqB,OAAO,CAAC6B,QAAQ,CAAC,KAAK,CAAC,EAAE;QAClDrH,SAAS,CAAC,mHAAmH,CAAC;MAChI,CAAC,MAAM,IAAImE,KAAK,CAACqB,OAAO,IAAIrB,KAAK,CAACqB,OAAO,CAAC6B,QAAQ,CAAC,KAAK,CAAC,EAAE;QACzDrH,SAAS,CAAC,4DAA4D,CAAC;MACzE,CAAC,MAAM,IAAImE,KAAK,CAACqB,OAAO,IAAIrB,KAAK,CAACqB,OAAO,CAAC6B,QAAQ,CAAC,KAAK,CAAC,EAAE;QACzDrH,SAAS,CAAC,gEAAgE,CAAC;MAC7E,CAAC,MAAM;QACLA,SAAS,CAAC,0BAA0B,IAAImE,KAAK,CAACqB,OAAO,IAAI,yBAAyB,CAAC,CAAC;MACtF;IACF,CAAC,SAAS;MACRhE,WAAW,CAAC,KAAK,CAAC;IACpB;EACF,CAAC;;EAED;EACA,MAAM8F,iBAAiB,GAAG,MAAAA,CAAA,KAAY;IACpC,IAAI,CAACrF,WAAW,IAAI,CAACJ,gBAAgB,IAAI,CAACM,UAAU,EAAE;MACpDnC,SAAS,CAAC,oCAAoC,CAAC;MAC/C;IACF;IAEAwB,WAAW,CAAC,IAAI,CAAC;IACjB,IAAI;MACF,MAAMmD,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;MAC/BD,MAAM,CAACE,MAAM,GAAG,MAAOC,CAAC,IAAK;QAC3B,IAAI;UAAA,IAAAyC,UAAA,EAAAC,qBAAA,EAAAC,sBAAA;UACF,MAAMzC,SAAS,IAAAuC,UAAA,GAAGzC,CAAC,CAACG,MAAM,cAAAsC,UAAA,uBAARA,UAAA,CAAUrC,MAAgB;;UAE5C;UACA,MAAMwC,SAAS,GAAG;YAChB/D,IAAI,EAAEqB,SAAS;YAAiB;YAChC2C,QAAQ,EAAE1F,WAAW,CAACoE,IAAI;YAAM;YAChCuB,IAAI,EAAE3F,WAAW,CAAC2F,IAAI;YAAU;YAChCC,IAAI,EAAE5F,WAAW,CAAC4F,IAAI;YAAU;YAChCC,WAAW,EAAE,IAAIzF,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;UACtC,CAAC;UAED,MAAMyF,iBAAsB,GAAG;YAC7BxB,WAAW,GAAAiB,qBAAA,GAAE3F,gBAAgB,CAACmE,QAAQ,cAAAwB,qBAAA,uBAAzBA,qBAAA,CAA2BnE,EAAE;YAC1C2E,OAAO,EAAEvG,qBAAqB,CAAC4B,EAAE;YACjC4E,UAAU,EAAElG,UAAU;YAAW;YACjCmG,KAAK,EAAER,SAAS;YAAiB;YACjCS,WAAW,EAAGpI,IAAI,CAASqD,QAAQ,IAAIrD,IAAI,CAACsD,EAAE;YAC9C+E,gBAAgB,EAAEjG,UAAU,CAAK;YACjC;UACF,CAAC;;UAED;UACA,MAAMkG,QAAQ,GAAG,kBAAkB;UAEnC/E,OAAO,CAACC,GAAG,CAAC,aAAaxB,UAAU,sBAAsB,EAAEF,gBAAgB,CAAC2E,aAAa,IAAI3E,gBAAgB,CAACwE,IAAI,CAAC;;UAEnH;UACA/C,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAE1B,gBAAgB,CAAC;UAC7DyB,OAAO,CAACC,GAAG,CAAC,wBAAwB,EAAE;YACpC,qBAAqB,EAAE1B,gBAAgB,CAACwB,EAAE;YAC1C,8BAA8B,EAAExB,gBAAgB,CAAC0E,WAAW;YAC5D,+BAA+B,GAAAkB,sBAAA,GAAE5F,gBAAgB,CAACmE,QAAQ,cAAAyB,sBAAA,uBAAzBA,sBAAA,CAA2BpE;UAC9D,CAAC,CAAC;;UAEF;UACAC,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAE;YACzCgD,WAAW,EAAEwB,iBAAiB,CAACxB,WAAW;YAC1CyB,OAAO,EAAED,iBAAiB,CAACC,OAAO;YAClCC,UAAU,EAAEF,iBAAiB,CAACE,UAAU;YACxCC,KAAK,EAAEH,iBAAiB,CAACG,KAAK;YAC9BE,gBAAgB,EAAEL,iBAAiB,CAACK;UACtC,CAAC,CAAC;UAEF,MAAMjD,QAAQ,GAAG,MAAM/F,SAAS,CAACgG,IAAI,CAACiD,QAAQ,EAAEN,iBAAiB,CAAC;UAElE,IAAI5C,QAAQ,CAACzB,OAAO,EAAE;YACpBjB,qBAAqB,CAAC,KAAK,CAAC;YAC5BP,cAAc,CAAC,IAAI,CAAC;YACpBE,aAAa,CAAC,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACvDT,mBAAmB,CAAC,IAAI,CAAC;;YAEzB;YACAmB,iBAAiB,CAAC,GAAGlB,UAAU,KAAK,aAAa,GAAG,aAAa,GAAG,SAAS,mDAAmD,CAAC;YACjI;YACAwD,UAAU,CAAC,MAAMtC,iBAAiB,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC;;YAE7C;YACA,MAAM4C,eAAe,CAACpE,qBAAqB,CAAC;UAC9C,CAAC,MAAM;YACLzB,SAAS,CAAC,oBAAoB+B,UAAU,UAAU,GAAGoD,QAAQ,CAACK,OAAO,CAAC;UACxE;QACF,CAAC,CAAC,OAAOrB,KAAK,EAAE;UACdb,OAAO,CAACa,KAAK,CAAC,GAAGpC,UAAU,sBAAsB,EAAEoC,KAAK,CAAC;UACzDnE,SAAS,CAAC,oBAAoB+B,UAAU,QAAQ,CAAC;QACnD,CAAC,SAAS;UACRP,WAAW,CAAC,KAAK,CAAC;QACpB;MACF,CAAC;MACDmD,MAAM,CAACc,aAAa,CAACxD,WAAW,CAAC;IACnC,CAAC,CAAC,OAAOkC,KAAK,EAAE;MACdb,OAAO,CAACa,KAAK,CAAC,GAAGpC,UAAU,gBAAgB,EAAEoC,KAAK,CAAC;MACnDnE,SAAS,CAAC,oBAAoB+B,UAAU,EAAE,CAAC;MAC3CP,WAAW,CAAC,KAAK,CAAC;IACpB;EACF,CAAC;EAGD,IAAIH,SAAS,EAAE;IACb,oBACE1B,OAAA;MAAK2I,SAAS,EAAC,uCAAuC;MAAAC,QAAA,eACpD5I,OAAA;QAAK2I,SAAS,EAAC,aAAa;QAAAC,QAAA,gBAC1B5I,OAAA;UAAK2I,SAAS,EAAC;QAA2E;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eACjGhJ,OAAA;UAAG2I,SAAS,EAAC,uBAAuB;UAAAC,QAAA,EAAC;QAA4B;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAClE;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAEV;EAEA,MAAMC,YAAY,GAAGxE,eAAe,CAAC,CAAC;EAEtC,oBACEzE,OAAA,CAACN,WAAW;IAAAkJ,QAAA,GAETvF,cAAc,iBACbrD,OAAA,CAACH,cAAc;MACbqI,IAAI,EAAC,SAAS;MACdgB,KAAK,EAAC,SAAS;MACfrD,OAAO,EAAExC,cAAe;MACxB8F,OAAO,EAAEA,CAAA,KAAM7F,iBAAiB,CAAC,EAAE;IAAE;MAAAuF,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtC,CACF,eAGDhJ,OAAA,CAACL,QAAQ;MACPuJ,KAAK,EAAC,oBAAoB;MAC1BE,QAAQ,EAAE,YAAY,CAAA5I,YAAY,aAAZA,YAAY,uBAAZA,YAAY,CAAEkG,IAAI,KAAItG,IAAI,CAACiJ,QAAQ,EAAG;MAC5DC,MAAM,EAAE,CACN;QAAEC,IAAI,EAAE,aAAanJ,IAAI,CAACsD,EAAE,EAAE;QAAE8F,OAAO,EAAE;MAAO,CAAC,EACjD;QAAED,IAAI,EAAE,GAAG3I,aAAa,CAAC6I,MAAM,iBAAiB;QAAED,OAAO,EAAE;MAAU,CAAC,CACtE;MACFE,OAAO,eACL1J,OAAA,CAACJ,QAAQ;QACP4J,OAAO,EAAC,SAAS;QACjBvB,IAAI,EAAC,QAAQ;QACb0B,OAAO,EAAEpG,aAAc;QACvBqG,QAAQ,EAAElI,SAAU;QACpBmI,IAAI,eAAE7J,OAAA,CAACtB,SAAS;UAACiK,SAAS,EAAE7I,SAAS,CAACgK;QAAG;UAAAjB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAE;QAAAJ,QAAA,gBAE7C5I,OAAA;UAAM2I,SAAS,EAAC,kBAAkB;UAAAC,QAAA,EAAC;QAAO;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eACjDhJ,OAAA;UAAM2I,SAAS,EAAC,WAAW;UAAAC,QAAA,EAAC;QAAY;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvC;IACX;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACF,CAAC,eAGFhJ,OAAA,CAAC1C,IAAI;MAAAsL,QAAA,gBACH5I,OAAA,CAACvC,UAAU;QAACkL,SAAS,EAAC,cAAc;QAAAC,QAAA,eAClC5I,OAAA,CAACtC,SAAS;UAACiL,SAAS,EAAC,kDAAkD;UAAAC,QAAA,gBACrE5I,OAAA,CAACzB,KAAK;YAACoK,SAAS,EAAC;UAAuB;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eAC3ChJ,OAAA;YAAA4I,QAAA,EAAM;UAAc;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAClB;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACF,CAAC,eACbhJ,OAAA,CAACzC,WAAW;QAACoL,SAAS,EAAC,MAAM;QAAAC,QAAA,eAC3B5I,OAAA;UAAK2I,SAAS,EAAC,qFAAqF;UAAAC,QAAA,gBAClG5I,OAAA;YAAK2I,SAAS,EAAC,gBAAgB;YAAAC,QAAA,EAC5B/D,WAAW,CAAC,CAAC,gBACZ7E,OAAA;cAAK2I,SAAS,EAAC,WAAW;cAAAC,QAAA,gBACxB5I,OAAA;gBAAK2I,SAAS,EAAC,+EAA+E;gBAAAC,QAAA,gBAC5F5I,OAAA,CAAC/B,KAAK;kBAAC0K,SAAS,EAAC,6CAA6C;kBAAAC,QAAA,gBAC5D5I,OAAA,CAACxB,WAAW;oBAACmK,SAAS,EAAC;kBAA4B;oBAAAE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC,WAExD;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC,eACRhJ,OAAA;kBAAM2I,SAAS,EAAC,kCAAkC;kBAAAC,QAAA,GAAC,SAC1C,EAAC,IAAIlG,IAAI,CAAEuG,YAAY,CAAUc,aAAa,CAAC,CAACC,cAAc,CAAC,CAAC;gBAAA;kBAAAnB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACnE,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACJ,CAAC,eACNhJ,OAAA;gBAAK2I,SAAS,EAAC,uBAAuB;gBAAAC,QAAA,gBACpC5I,OAAA;kBAAK2I,SAAS,EAAC,WAAW;kBAAAC,QAAA,GAAC,cAAY,EAAEK,YAAY,CAAUgB,UAAU;gBAAA;kBAAApB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eAChFhJ,OAAA;kBAAK2I,SAAS,EAAC,mBAAmB;kBAAAC,QAAA,GAAC,YACvB,EAACsB,IAAI,CAACC,KAAK,CAAC,CAAC,IAAIzH,IAAI,CAAC,CAAC,CAAC0H,OAAO,CAAC,CAAC,GAAG,IAAI1H,IAAI,CAAEuG,YAAY,CAAUc,aAAa,CAAC,CAACK,OAAO,CAAC,CAAC,KAAK,IAAI,GAAG,EAAE,CAAC,CAAC,EAAC,MACzH;gBAAA;kBAAAvB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC,gBAENhJ,OAAA;cAAK2I,SAAS,EAAC,+EAA+E;cAAAC,QAAA,gBAC5F5I,OAAA,CAAC/B,KAAK;gBAACuL,OAAO,EAAC,WAAW;gBAACb,SAAS,EAAC,iBAAiB;gBAAAC,QAAA,gBACpD5I,OAAA,CAACvB,OAAO;kBAACkK,SAAS,EAAC;gBAA4B;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,YAEpD;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC,eACRhJ,OAAA;gBAAM2I,SAAS,EAAC,kCAAkC;gBAAAC,QAAA,EAAC;cAAiB;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACxE;UACN;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CAAC,eAENhJ,OAAA;YAAK2I,SAAS,EAAC,8CAA8C;YAAAC,QAAA,EAC1D/D,WAAW,CAAC,CAAC,gBACZ7E,OAAA,CAACrC,MAAM;cAAC0M,IAAI,EAAErJ,oBAAqB;cAACsJ,YAAY,EAAErJ,uBAAwB;cAAA2H,QAAA,gBACxE5I,OAAA,CAAChC,aAAa;gBAACuM,OAAO;gBAAA3B,QAAA,eACpB5I,OAAA,CAAC7C,MAAM;kBAACqM,OAAO,EAAC,aAAa;kBAACI,QAAQ,EAAEhI,QAAS;kBAAC+G,SAAS,EAAC,kBAAkB;kBAAAC,QAAA,gBAC5E5I,OAAA,CAACpB,MAAM;oBAAC+J,SAAS,EAAC;kBAA4B;oBAAAE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC,eACjDhJ,OAAA;oBAAM2I,SAAS,EAAC,kBAAkB;oBAAAC,QAAA,EAAC;kBAAS;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAM,CAAC,eACnDhJ,OAAA;oBAAM2I,SAAS,EAAC,WAAW;oBAAAC,QAAA,EAAC;kBAAS;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAM,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACtC;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACI,CAAC,eAChBhJ,OAAA,CAACpC,aAAa;gBAAAgL,QAAA,gBACZ5I,OAAA,CAAClC,YAAY;kBAAA8K,QAAA,gBACX5I,OAAA,CAACjC,WAAW;oBAAA6K,QAAA,EAAC;kBAAS;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAa,CAAC,eACpChJ,OAAA,CAACnC,iBAAiB;oBAAA+K,QAAA,EAAC;kBAEnB;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAmB,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACR,CAAC,eACfhJ,OAAA;kBAAK2I,SAAS,EAAC,WAAW;kBAAAC,QAAA,gBACxB5I,OAAA;oBAAA4I,QAAA,gBACE5I,OAAA,CAAC3C,KAAK;sBAACmN,OAAO,EAAC,eAAe;sBAAA5B,QAAA,EAAC;oBAA0B;sBAAAC,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAO,CAAC,eACjEhJ,OAAA,CAAC5C,KAAK;sBACJsG,EAAE,EAAC,eAAe;sBAClBwE,IAAI,EAAC,MAAM;sBACXuC,MAAM,EAAC,SAAS;sBAChBC,QAAQ,EAAGvF,CAAC;wBAAA,IAAAwF,eAAA;wBAAA,OAAKtJ,gBAAgB,CAAC,EAAAsJ,eAAA,GAAAxF,CAAC,CAACG,MAAM,CAACsF,KAAK,cAAAD,eAAA,uBAAdA,eAAA,CAAiB,CAAC,CAAC,KAAI,IAAI,CAAC;sBAAA,CAAC;sBAC/DhC,SAAS,EAAC,MAAM;sBAChBkC,QAAQ;sBACRjB,QAAQ,EAAEhI;oBAAS;sBAAAiH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACpB,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACC,CAAC,eACNhJ,OAAA;oBAAA4I,QAAA,gBACE5I,OAAA,CAAC3C,KAAK;sBAACmN,OAAO,EAAC,eAAe;sBAAA5B,QAAA,EAAC;oBAA6B;sBAAAC,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAO,CAAC,eACpEhJ,OAAA,CAAC9B,QAAQ;sBACPwF,EAAE,EAAC,eAAe;sBAClBoH,KAAK,EAAEtJ,aAAc;sBACrBkJ,QAAQ,EAAGvF,CAAC,IAAK1D,gBAAgB,CAAC0D,CAAC,CAACG,MAAM,CAACwF,KAAK,CAAE;sBAClDC,WAAW,EAAC,2BAA2B;sBACvCC,IAAI,EAAE,CAAE;sBACRpB,QAAQ,EAAEhI;oBAAS;sBAAAiH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACpB,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACC,CAAC,eACNhJ,OAAA;oBAAK2I,SAAS,EAAC,4BAA4B;oBAAAC,QAAA,gBACzC5I,OAAA,CAAC7C,MAAM;sBAAC+K,IAAI,EAAC,QAAQ;sBAACsB,OAAO,EAAC,SAAS;sBAACG,OAAO,EAAEA,CAAA,KAAM1I,uBAAuB,CAAC,KAAK,CAAE;sBAAC2I,QAAQ,EAAEhI,QAAS;sBAAAgH,QAAA,EAAC;oBAE3G;sBAAAC,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ,CAAC,eACThJ,OAAA,CAAC7C,MAAM;sBAACwM,OAAO,EAAE5D,cAAe;sBAAC6D,QAAQ,EAAE,CAACxI,aAAa,IAAIQ,QAAS;sBAAAgH,QAAA,EACnEhH,QAAQ,gBACP5B,OAAA,CAAAE,SAAA;wBAAA0I,QAAA,gBACE5I,OAAA,CAACnB,QAAQ;0BAAC8J,SAAS,EAAC;wBAA2B;0BAAAE,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAE,CAAC,aAEpD;sBAAA,eAAE,CAAC,gBAEHhJ,OAAA,CAAAE,SAAA;wBAAA0I,QAAA,gBACE5I,OAAA,CAACpB,MAAM;0BAAC+J,SAAS,EAAC;wBAAc;0BAAAE,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAE,CAAC,aAErC;sBAAA,eAAE;oBACH;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACK,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACN,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACH,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACO,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACV,CAAC,gBAEThJ,OAAA,CAACrC,MAAM;cAAC0M,IAAI,EAAEvJ,mBAAoB;cAACwJ,YAAY,EAAEvJ,sBAAuB;cAAA6H,QAAA,gBACtE5I,OAAA,CAAChC,aAAa;gBAACuM,OAAO;gBAAA3B,QAAA,eACpB5I,OAAA,CAAC7C,MAAM;kBAACyM,QAAQ,EAAEhI,QAAS;kBAAC+G,SAAS,EAAC,kBAAkB;kBAAAC,QAAA,gBACtD5I,OAAA,CAACrB,KAAK;oBAACgK,SAAS,EAAC;kBAA4B;oBAAAE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC,eAChDhJ,OAAA;oBAAM2I,SAAS,EAAC,kBAAkB;oBAAAC,QAAA,EAAC;kBAAQ;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAM,CAAC,eAClDhJ,OAAA;oBAAM2I,SAAS,EAAC,WAAW;oBAAAC,QAAA,EAAC;kBAAQ;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAM,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACrC;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACI,CAAC,eAChBhJ,OAAA,CAACpC,aAAa;gBAAAgL,QAAA,gBACZ5I,OAAA,CAAClC,YAAY;kBAAA8K,QAAA,gBACX5I,OAAA,CAACjC,WAAW;oBAAA6K,QAAA,EAAC;kBAAQ;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAa,CAAC,eACnChJ,OAAA,CAACnC,iBAAiB;oBAAA+K,QAAA,EAAC;kBAEnB;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAmB,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACR,CAAC,eACfhJ,OAAA;kBAAK2I,SAAS,EAAC,WAAW;kBAAAC,QAAA,gBACxB5I,OAAA;oBAAA4I,QAAA,gBACE5I,OAAA,CAAC3C,KAAK;sBAACmN,OAAO,EAAC,cAAc;sBAAA5B,QAAA,EAAC;oBAAyB;sBAAAC,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAO,CAAC,eAC/DhJ,OAAA,CAAC5C,KAAK;sBACJsG,EAAE,EAAC,cAAc;sBACjBwE,IAAI,EAAC,MAAM;sBACXuC,MAAM,EAAC,SAAS;sBAChBC,QAAQ,EAAGvF,CAAC;wBAAA,IAAA8F,gBAAA;wBAAA,OAAK9J,eAAe,CAAC,EAAA8J,gBAAA,GAAA9F,CAAC,CAACG,MAAM,CAACsF,KAAK,cAAAK,gBAAA,uBAAdA,gBAAA,CAAiB,CAAC,CAAC,KAAI,IAAI,CAAC;sBAAA,CAAC;sBAC9DtC,SAAS,EAAC,MAAM;sBAChBkC,QAAQ;sBACRjB,QAAQ,EAAEhI;oBAAS;sBAAAiH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACpB,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACC,CAAC,eACNhJ,OAAA;oBAAA4I,QAAA,gBACE5I,OAAA,CAAC3C,KAAK;sBAACmN,OAAO,EAAC,cAAc;sBAAA5B,QAAA,EAAC;oBAAgB;sBAAAC,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAO,CAAC,eACtDhJ,OAAA,CAAC9B,QAAQ;sBACPwF,EAAE,EAAC,cAAc;sBACjBoH,KAAK,EAAExJ,YAAa;sBACpBoJ,QAAQ,EAAGvF,CAAC,IAAK5D,eAAe,CAAC4D,CAAC,CAACG,MAAM,CAACwF,KAAK,CAAE;sBACjDC,WAAW,EAAC,6BAA6B;sBACzCC,IAAI,EAAE,CAAE;sBACRpB,QAAQ,EAAEhI;oBAAS;sBAAAiH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACpB,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACC,CAAC,eACNhJ,OAAA;oBAAK2I,SAAS,EAAC,4BAA4B;oBAAAC,QAAA,gBACzC5I,OAAA,CAAC7C,MAAM;sBAAC+K,IAAI,EAAC,QAAQ;sBAACsB,OAAO,EAAC,SAAS;sBAACG,OAAO,EAAEA,CAAA,KAAM5I,sBAAsB,CAAC,KAAK,CAAE;sBAAC6I,QAAQ,EAAEhI,QAAS;sBAAAgH,QAAA,EAAC;oBAE1G;sBAAAC,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ,CAAC,eACThJ,OAAA,CAAC7C,MAAM;sBAACwM,OAAO,EAAE5E,aAAc;sBAAC6E,QAAQ,EAAE,CAAC1I,YAAY,IAAIU,QAAS;sBAAAgH,QAAA,EACjEhH,QAAQ,gBACP5B,OAAA,CAAAE,SAAA;wBAAA0I,QAAA,gBACE5I,OAAA,CAACnB,QAAQ;0BAAC8J,SAAS,EAAC;wBAA2B;0BAAAE,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAE,CAAC,aAEpD;sBAAA,eAAE,CAAC,gBAEHhJ,OAAA,CAAAE,SAAA;wBAAA0I,QAAA,gBACE5I,OAAA,CAACrB,KAAK;0BAACgK,SAAS,EAAC;wBAAc;0BAAAE,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAE,CAAC,YAEpC;sBAAA,eAAE;oBACH;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACK,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACN,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACH,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACO,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACV;UACT;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACK,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACV,CAAC,eAGPhJ,OAAA,CAAC7B,IAAI;MAAC+M,YAAY,EAAC,OAAO;MAACvC,SAAS,EAAC,QAAQ;MAAAC,QAAA,gBAC3C5I,OAAA,CAAC3B,QAAQ;QAACsK,SAAS,EAAC,gCAAgC;QAAAC,QAAA,gBAClD5I,OAAA,CAAC1B,WAAW;UAACwM,KAAK,EAAC,OAAO;UAACnC,SAAS,EAAC,uDAAuD;UAAAC,QAAA,gBAC1F5I,OAAA,CAACjB,MAAM;YAAC4J,SAAS,EAAC;UAAuB;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eAC5ChJ,OAAA;YAAM2I,SAAS,EAAC,oBAAoB;YAAAC,QAAA,EAAC;UAAQ;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACzC,CAAC,eACdhJ,OAAA,CAAC1B,WAAW;UAACwM,KAAK,EAAC,QAAQ;UAACnC,SAAS,EAAC,uDAAuD;UAAAC,QAAA,gBAC3F5I,OAAA,CAAClB,QAAQ;YAAC6J,SAAS,EAAC;UAAuB;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eAC9ChJ,OAAA;YAAM2I,SAAS,EAAC,oBAAoB;YAAAC,QAAA,EAAC;UAAS;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC1C,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CAAC,eAEXhJ,OAAA,CAAC5B,WAAW;QAAC0M,KAAK,EAAC,OAAO;QAACnC,SAAS,EAAC,MAAM;QAAAC,QAAA,eACzC5I,OAAA,CAAC1C,IAAI;UAAAsL,QAAA,gBACH5I,OAAA,CAACvC,UAAU;YAACkL,SAAS,EAAC,cAAc;YAAAC,QAAA,gBAClC5I,OAAA,CAACtC,SAAS;cAACiL,SAAS,EAAC,kDAAkD;cAAAC,QAAA,gBACrE5I,OAAA,CAACjB,MAAM;gBAAC4J,SAAS,EAAC;cAAuB;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,eAC5ChJ,OAAA;gBAAA4I,QAAA,EAAM;cAAc;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAClB,CAAC,eACZhJ,OAAA,CAACxC,eAAe;cAACmL,SAAS,EAAC,SAAS;cAAAC,QAAA,EAAC;YAAgC;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAiB,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC7E,CAAC,eACbhJ,OAAA,CAACzC,WAAW;YAAAqL,QAAA,EACThI,aAAa,CAAC6I,MAAM,KAAK,CAAC,gBACzBzJ,OAAA;cAAK2I,SAAS,EAAC,kBAAkB;cAAAC,QAAA,gBAC/B5I,OAAA,CAAChB,KAAK;gBAAC2J,SAAS,EAAC;cAAsC;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,eAC1DhJ,OAAA;gBAAG2I,SAAS,EAAC,eAAe;gBAAAC,QAAA,EAAC;cAAkB;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAG,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAChD,CAAC,gBAENhJ,OAAA;cAAK2I,SAAS,EAAC,WAAW;cAAAC,QAAA,EACvBhI,aAAa,CAACwD,GAAG,CAAEC,IAAI,iBACtBrE,OAAA;gBAAmB2I,SAAS,EAAC,MAAM;gBAAAC,QAAA,gBACjC5I,OAAA,CAAC1C,IAAI;kBAACqL,SAAS,EAAC,8BAA8B;kBAAAC,QAAA,eAC5C5I,OAAA,CAACzC,WAAW;oBAACoL,SAAS,EAAC,YAAY;oBAAAC,QAAA,gBACjC5I,OAAA;sBAAK2I,SAAS,EAAC,0FAA0F;sBAAAC,QAAA,gBACvG5I,OAAA;wBAAK2I,SAAS,EAAC,4CAA4C;wBAAAC,QAAA,eACzD5I,OAAA;0BAAI2I,SAAS,EAAC,2CAA2C;0BAAAC,QAAA,EAAEvE,IAAI,CAAC8G;wBAAS;0BAAAtC,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAK;sBAAC;wBAAAH,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAC5E,CAAC,eACNhJ,OAAA,CAAC/B,KAAK;wBAAC0K,SAAS,EAAE,iBAChBtE,IAAI,CAACO,MAAM,KAAK,QAAQ,GAAG,6BAA6B,GACxDP,IAAI,CAACO,MAAM,KAAK,aAAa,GAAG,2BAA2B,GAC3D,2BAA2B,EAC1B;wBAAAgE,QAAA,EACAvE,IAAI,CAACO;sBAAM;wBAAAiE,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OACP,CAAC;oBAAA;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACL,CAAC,eACNhJ,OAAA;sBAAK2I,SAAS,EAAC,wDAAwD;sBAAAC,QAAA,gBACrE5I,OAAA;wBAAA4I,QAAA,gBACE5I,OAAA,CAAC3C,KAAK;0BAACsL,SAAS,EAAC,uBAAuB;0BAAAC,QAAA,EAAC;wBAAW;0BAAAC,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAO,CAAC,eAC5DhJ,OAAA;0BAAG2I,SAAS,EAAC,SAAS;0BAAAC,QAAA,EAAEvE,IAAI,CAAC+G;wBAAW;0BAAAvC,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAI,CAAC;sBAAA;wBAAAH,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAC1C,CAAC,eACNhJ,OAAA;wBAAA4I,QAAA,gBACE5I,OAAA,CAAC3C,KAAK;0BAACsL,SAAS,EAAC,uBAAuB;0BAAAC,QAAA,EAAC;wBAAK;0BAAAC,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAO,CAAC,eACtDhJ,OAAA;0BAAG2I,SAAS,EAAC,SAAS;0BAAAC,QAAA,GAAE,IAAIlG,IAAI,CAAC2B,IAAI,CAACgH,UAAU,CAAC,CAACC,kBAAkB,CAAC,CAAC,EAAC,KAAG,EAAC,IAAI5I,IAAI,CAAC2B,IAAI,CAACkH,QAAQ,CAAC,CAACD,kBAAkB,CAAC,CAAC;wBAAA;0BAAAzC,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAI,CAAC;sBAAA;wBAAAH,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OACzH,CAAC;oBAAA;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACH,CAAC,eACNhJ,OAAA;sBAAK2I,SAAS,EAAC,0FAA0F;sBAAAC,QAAA,gBACvG5I,OAAA;wBAAK2I,SAAS,EAAC,sBAAsB;wBAAAC,QAAA,eACnC5I,OAAA,CAAC/B,KAAK;0BAACuL,OAAO,EAAC,SAAS;0BAACb,SAAS,EAAC,SAAS;0BAAAC,QAAA,GACzCvE,IAAI,CAACE,oBAAoB,IAAI,CAAC,EAAC,mBAClC;wBAAA;0BAAAsE,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAAO;sBAAC;wBAAAH,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OACL,CAAC,eACNhJ,OAAA;wBAAK2I,SAAS,EAAC,8CAA8C;wBAAAC,QAAA,eAC3D5I,OAAA,CAAC7C,MAAM;0BACL8K,IAAI,EAAC,IAAI;0BACTuB,OAAO,EAAC,SAAS;0BACjBG,OAAO,EAAEA,CAAA,KAAM;4BACb;4BACAzG,iBAAiB,CAACD,cAAc,KAAKoB,IAAI,CAACX,EAAE,GAAG,IAAI,GAAGW,IAAI,CAACX,EAAE,CAAC;4BAC9D;4BACA,IAAIT,cAAc,KAAKoB,IAAI,CAACX,EAAE,EAAE;8BAC9BwC,eAAe,CAAC7B,IAAI,CAAC;4BACvB;0BACF,CAAE;0BACFsE,SAAS,EAAC,0BAA0B;0BAAAC,QAAA,EAEnC3F,cAAc,KAAKoB,IAAI,CAACX,EAAE,gBACzB1D,OAAA,CAAAE,SAAA;4BAAA0I,QAAA,gBACE5I,OAAA,CAACZ,SAAS;8BAACuJ,SAAS,EAAC;4BAAc;8BAAAE,QAAA,EAAAC,YAAA;8BAAAC,UAAA;8BAAAC,YAAA;4BAAA,OAAE,CAAC,eACtChJ,OAAA;8BAAM2I,SAAS,EAAC,kBAAkB;8BAAAC,QAAA,EAAC;4BAAc;8BAAAC,QAAA,EAAAC,YAAA;8BAAAC,UAAA;8BAAAC,YAAA;4BAAA,OAAM,CAAC,eACxDhJ,OAAA;8BAAM2I,SAAS,EAAC,WAAW;8BAAAC,QAAA,EAAC;4BAAI;8BAAAC,QAAA,EAAAC,YAAA;8BAAAC,UAAA;8BAAAC,YAAA;4BAAA,OAAM,CAAC;0BAAA,eACvC,CAAC,gBAEHhJ,OAAA,CAAAE,SAAA;4BAAA0I,QAAA,gBACE5I,OAAA,CAACX,WAAW;8BAACsJ,SAAS,EAAC;4BAAc;8BAAAE,QAAA,EAAAC,YAAA;8BAAAC,UAAA;8BAAAC,YAAA;4BAAA,OAAE,CAAC,eACxChJ,OAAA;8BAAM2I,SAAS,EAAC,kBAAkB;8BAAAC,QAAA,EAAC;4BAAc;8BAAAC,QAAA,EAAAC,YAAA;8BAAAC,UAAA;8BAAAC,YAAA;4BAAA,OAAM,CAAC,eACxDhJ,OAAA;8BAAM2I,SAAS,EAAC,WAAW;8BAAAC,QAAA,EAAC;4BAAI;8BAAAC,QAAA,EAAAC,YAAA;8BAAAC,UAAA;8BAAAC,YAAA;4BAAA,OAAM,CAAC;0BAAA,eACvC;wBACH;0BAAAH,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OACK;sBAAC;wBAAAH,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OACN,CAAC;oBAAA;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACH,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACK;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACV,CAAC,EAGN/F,cAAc,KAAKoB,IAAI,CAACX,EAAE,iBACzB1D,OAAA;kBAAK2I,SAAS,EAAC,8CAA8C;kBAAAC,QAAA,EAC1D5G,aAAa,CAACyH,MAAM,KAAK,CAAC,gBACzBzJ,OAAA;oBAAK2I,SAAS,EAAC,qCAAqC;oBAAAC,QAAA,gBAClD5I,OAAA,CAAChB,KAAK;sBAAC2J,SAAS,EAAC;oBAAkD;sBAAAE,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAE,CAAC,eACtEhJ,OAAA;sBAAG2I,SAAS,EAAC,kCAAkC;sBAAAC,QAAA,EAAC;oBAAoB;sBAAAC,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAG,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACrE,CAAC,gBAENhJ,OAAA;oBAAK2I,SAAS,EAAC,wBAAwB;oBAAAC,QAAA,EAEpC5G,aAAa,CAACoC,GAAG,CAAEiC,QAAQ,IAAK;sBAAA,IAAAmF,kBAAA,EAAAC,mBAAA;sBAE/B;sBACA,MAAMC,UAAU,GAAG,EAAAF,kBAAA,GAAAnF,QAAQ,CAACA,QAAQ,cAAAmF,kBAAA,uBAAjBA,kBAAA,CAAmB9H,EAAE,KAAI2C,QAAQ,CAACO,WAAW;sBAChE,MAAM+E,YAAY,GAAG,EAAAF,mBAAA,GAAApF,QAAQ,CAACA,QAAQ,cAAAoF,mBAAA,uBAAjBA,mBAAA,CAAmB/E,IAAI,KAAIL,QAAQ,CAACK,IAAI;;sBAG7D;sBACA,MAAMkF,sBAAsB,GAAGzI,cAAc,CAAC0I,MAAM,CAACtD,KAAK,IACxDA,KAAK,CAAC3B,WAAW,KAAK8E,UACxB,CAAC;;sBAED;sBACA;sBACA;sBACA;sBACA;;sBAEA;sBACA,MAAMI,iBAAiB,GAAGF,sBAAsB,CAACC,MAAM,CAACE,CAAC,IAAIA,CAAC,CAACzD,UAAU,KAAK,aAAa,CAAC;sBAC5F,MAAM0D,aAAa,GAAGJ,sBAAsB,CAACC,MAAM,CAACE,CAAC,IAAIA,CAAC,CAACzD,UAAU,KAAK,SAAS,CAAC;;sBAEpF;sBACA;sBACA;sBACA;sBACA;sBACA;sBACA;;sBAEA;sBACA;sBACA;sBACA;sBACA;sBACA;;sBAEA;sBACA;sBACA;;sBAEA;sBACA;sBACA;sBACA;sBACA;sBACA;sBACA;;sBAEA;sBACA;sBACA;sBACA;sBACA;sBACA;;sBAEA;sBACA;sBACA;sBACA;sBACA;sBACA;sBACA;sBACA;;sBAEA;sBACA;sBACA;sBACA;;sBAEA;sBACA;sBACA;;sBAEA;sBACA;sBACA;sBACA;sBACA;;sBAEA,oBACEtI,OAAA,CAAC1C,IAAI;wBAAkBqL,SAAS,EAAC,8BAA8B;wBAAAC,QAAA,eAC7D5I,OAAA,CAACzC,WAAW;0BAACoL,SAAS,EAAC,YAAY;0BAAAC,QAAA,gBACjC5I,OAAA;4BAAK2I,SAAS,EAAC,0FAA0F;4BAAAC,QAAA,gBACvG5I,OAAA;8BAAI2I,SAAS,EAAC,2CAA2C;8BAAAC,QAAA,EACtD+C,YAAY,IAAI;4BAAU;8BAAA9C,QAAA,EAAAC,YAAA;8BAAAC,UAAA;8BAAAC,YAAA;4BAAA,OACzB,CAAC,eACLhJ,OAAA,CAAC/B,KAAK;8BAACuL,OAAO,EAAC,SAAS;8BAACb,SAAS,EAAC,2DAA2D;8BAAAC,QAAA,EAAC;4BAE/F;8BAAAC,QAAA,EAAAC,YAAA;8BAAAC,UAAA;8BAAAC,YAAA;4BAAA,OAAO,CAAC;0BAAA;4BAAAH,QAAA,EAAAC,YAAA;4BAAAC,UAAA;4BAAAC,YAAA;0BAAA,OACL,CAAC,eAENhJ,OAAA;4BAAK2I,SAAS,EAAC,gDAAgD;4BAAAC,QAAA,gBAE7D5I,OAAA;8BAAK2I,SAAS,EAAC,2BAA2B;8BAAAC,QAAA,gBACxC5I,OAAA;gCAAI2I,SAAS,EAAC,qCAAqC;gCAAAC,QAAA,EAAC;8BAAW;gCAAAC,QAAA,EAAAC,YAAA;gCAAAC,UAAA;gCAAAC,YAAA;8BAAA,OAAI,CAAC,eACpEhJ,OAAA;gCAAK2I,SAAS,EAAC,MAAM;gCAAAC,QAAA,eACnB5I,OAAA,CAACT,YAAY;kCACX0M,MAAM,EAAEH,iBAAkB;kCAC1B5D,IAAI,EAAC,aAAa;kCAClBD,IAAI,EAAC,QAAQ;kCACbiE,SAAS,EAAE,CAAE;kCACbC,aAAa,EAAE7E,iBAAkB;kCACjC8E,UAAU,EAAEhM,IAAI,CAACiM,IAAI,KAAK,OAAO,IAAIP,iBAAiB,CAACQ,IAAI,CAAC/D,KAAK,IAC/DA,KAAK,CAACC,WAAW,KAAOpI,IAAI,CAASqD,QACvC,CAAE;kCACF8I,YAAY,EAAE,IAAK;kCACnBC,QAAQ,EAAEpM,IAAI,CAACiM,IAAK;kCACpBV,YAAY,EAAEA;gCAAa;kCAAA9C,QAAA,EAAAC,YAAA;kCAAAC,UAAA;kCAAAC,YAAA;gCAAA,OAC5B;8BAAC;gCAAAH,QAAA,EAAAC,YAAA;gCAAAC,UAAA;gCAAAC,YAAA;8BAAA,OACC,CAAC,eAENhJ,OAAA,CAACJ,QAAQ;gCACP4J,OAAO,EAAC,SAAS;gCACjBvB,IAAI,EAAC,QAAQ;gCACb0B,OAAO,EAAEA,CAAA,KAAM;kCACbxH,mBAAmB,CAACkE,QAAQ,CAAC;kCAC7BhE,aAAa,CAAC,aAAa,CAAC;kCAC5BS,qBAAqB,CAAC,IAAI,CAAC;gCAC7B,CAAE;gCACF+G,IAAI,eAAE7J,OAAA,CAACf,MAAM;kCAAC0J,SAAS,EAAE7I,SAAS,CAACgK;gCAAG;kCAAAjB,QAAA,EAAAC,YAAA;kCAAAC,UAAA;kCAAAC,YAAA;gCAAA,OAAE,CAAE;gCAAAJ,QAAA,gBAE1C5I,OAAA;kCAAM2I,SAAS,EAAC,kBAAkB;kCAAAC,QAAA,EAAC;gCAAwB;kCAAAC,QAAA,EAAAC,YAAA;kCAAAC,UAAA;kCAAAC,YAAA;gCAAA,OAAM,CAAC,eAClEhJ,OAAA;kCAAM2I,SAAS,EAAC,WAAW;kCAAAC,QAAA,EAAC;gCAAkB;kCAAAC,QAAA,EAAAC,YAAA;kCAAAC,UAAA;kCAAAC,YAAA;gCAAA,OAAM,CAAC;8BAAA;gCAAAH,QAAA,EAAAC,YAAA;gCAAAC,UAAA;gCAAAC,YAAA;8BAAA,OAC7C,CAAC;4BAAA;8BAAAH,QAAA,EAAAC,YAAA;8BAAAC,UAAA;8BAAAC,YAAA;4BAAA,OACR,CAAC,eAGNhJ,OAAA;8BAAK2I,SAAS,EAAC,2BAA2B;8BAAAC,QAAA,gBACxC5I,OAAA;gCAAI2I,SAAS,EAAC,qCAAqC;gCAAAC,QAAA,EAAC;8BAAO;gCAAAC,QAAA,EAAAC,YAAA;gCAAAC,UAAA;gCAAAC,YAAA;8BAAA,OAAI,CAAC,eAChEhJ,OAAA;gCAAK2I,SAAS,EAAC,MAAM;gCAAAC,QAAA,eACnB5I,OAAA,CAACT,YAAY;kCACX0M,MAAM,EAAED,aAAc;kCACtB9D,IAAI,EAAC,SAAS;kCACdD,IAAI,EAAC,QAAQ;kCACbiE,SAAS,EAAE,CAAE;kCACbC,aAAa,EAAE7E,iBAAkB;kCACjC8E,UAAU,EAAEhM,IAAI,CAACiM,IAAI,KAAK,OAAO,IAAIL,aAAa,CAACM,IAAI,CAAC/D,KAAK,IAC3DA,KAAK,CAACC,WAAW,KAAOpI,IAAI,CAASqD,QACvC,CAAE;kCACF8I,YAAY,EAAE,IAAK;kCACnBC,QAAQ,EAAEpM,IAAI,CAACiM,IAAK;kCACpBV,YAAY,EAAEA;gCAAa;kCAAA9C,QAAA,EAAAC,YAAA;kCAAAC,UAAA;kCAAAC,YAAA;gCAAA,OAC5B;8BAAC;gCAAAH,QAAA,EAAAC,YAAA;gCAAAC,UAAA;gCAAAC,YAAA;8BAAA,OACC,CAAC,eAENhJ,OAAA,CAACJ,QAAQ;gCACP4J,OAAO,EAAC,SAAS;gCACjBvB,IAAI,EAAC,QAAQ;gCACb0B,OAAO,EAAEA,CAAA,KAAM;kCACbxH,mBAAmB,CAACkE,QAAQ,CAAC;kCAC7BhE,aAAa,CAAC,SAAS,CAAC;kCACxBS,qBAAqB,CAAC,IAAI,CAAC;gCAC7B,CAAE;gCACF+G,IAAI,eAAE7J,OAAA,CAACf,MAAM;kCAAC0J,SAAS,EAAE7I,SAAS,CAACgK;gCAAG;kCAAAjB,QAAA,EAAAC,YAAA;kCAAAC,UAAA;kCAAAC,YAAA;gCAAA,OAAE,CAAE;gCAAAJ,QAAA,gBAE1C5I,OAAA;kCAAM2I,SAAS,EAAC,kBAAkB;kCAAAC,QAAA,EAAC;gCAAoB;kCAAAC,QAAA,EAAAC,YAAA;kCAAAC,UAAA;kCAAAC,YAAA;gCAAA,OAAM,CAAC,eAC9DhJ,OAAA;kCAAM2I,SAAS,EAAC,WAAW;kCAAAC,QAAA,EAAC;gCAAc;kCAAAC,QAAA,EAAAC,YAAA;kCAAAC,UAAA;kCAAAC,YAAA;gCAAA,OAAM,CAAC;8BAAA;gCAAAH,QAAA,EAAAC,YAAA;gCAAAC,UAAA;gCAAAC,YAAA;8BAAA,OACzC,CAAC;4BAAA;8BAAAH,QAAA,EAAAC,YAAA;8BAAAC,UAAA;8BAAAC,YAAA;4BAAA,OACR,CAAC;0BAAA;4BAAAH,QAAA,EAAAC,YAAA;4BAAAC,UAAA;4BAAAC,YAAA;0BAAA,OACH,CAAC;wBAAA;0BAAAH,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OACK;sBAAC,GAhFL0C,UAAU;wBAAA7C,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAiFf,CAAC;oBAEX,CAAC;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACC;gBACN;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACE,CACN;cAAA,GAnPO3E,IAAI,CAACX,EAAE;gBAAAmF,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAoPZ,CACN;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACC;UACN;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACU,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACV;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACI,CAAC,eAEdhJ,OAAA,CAAC5B,WAAW;QAAC0M,KAAK,EAAC,QAAQ;QAACnC,SAAS,EAAC,cAAc;QAAAC,QAAA,eAClD5I,OAAA,CAAC1C,IAAI;UAAAsL,QAAA,gBACH5I,OAAA,CAACvC,UAAU;YAACkL,SAAS,EAAC,cAAc;YAAAC,QAAA,gBAClC5I,OAAA,CAACtC,SAAS;cAACiL,SAAS,EAAC,kDAAkD;cAAAC,QAAA,gBACrE5I,OAAA,CAAClB,QAAQ;gBAAC6J,SAAS,EAAC;cAAuB;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,eAC9ChJ,OAAA;gBAAA4I,QAAA,EAAM;cAAa;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACjB,CAAC,eACZhJ,OAAA,CAACxC,eAAe;cAACmL,SAAS,EAAC,SAAS;cAAAC,QAAA,EAAC;YAAiC;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAiB,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC9E,CAAC,eACbhJ,OAAA,CAACzC,WAAW;YAAAqL,QAAA,EACTlI,MAAM,CAAC+I,MAAM,KAAK,CAAC,gBAClBzJ,OAAA;cAAK2I,SAAS,EAAC,kBAAkB;cAAAC,QAAA,gBAC/B5I,OAAA,CAACzB,KAAK;gBAACoK,SAAS,EAAC;cAAsC;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,eAC1DhJ,OAAA;gBAAG2I,SAAS,EAAC,eAAe;gBAAAC,QAAA,EAAC;cAAuB;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAG,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACrD,CAAC,gBAENhJ,OAAA;cAAK2I,SAAS,EAAC,WAAW;cAAAC,QAAA,EACvBlI,MAAM,CACJ+L,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;gBACd;gBACA,MAAMC,KAAK,GAAG,IAAIlK,IAAI,CAAEgK,CAAC,CAAS3C,aAAa,IAAK2C,CAAC,CAASzC,UAAU,IAAIyC,CAAC,CAACG,WAAW,IAAIH,CAAC,CAACI,SAAS,CAAC;gBACzG,MAAMC,KAAK,GAAG,IAAIrK,IAAI,CAAEiK,CAAC,CAAS5C,aAAa,IAAK4C,CAAC,CAAS1C,UAAU,IAAI0C,CAAC,CAACE,WAAW,IAAIF,CAAC,CAACG,SAAS,CAAC;gBACzG,OAAOC,KAAK,CAAC3C,OAAO,CAAC,CAAC,GAAGwC,KAAK,CAACxC,OAAO,CAAC,CAAC;cAC1C,CAAC,CAAC,CACD4C,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CACZ5I,GAAG,CAAEO,KAAK,iBACX3E,OAAA,CAAC1C,IAAI;gBAAgBqL,SAAS,EAAC,8BAA8B;gBAAAC,QAAA,eAC3D5I,OAAA,CAACzC,WAAW;kBAACoL,SAAS,EAAC,YAAY;kBAAAC,QAAA,gBACjC5I,OAAA;oBAAK2I,SAAS,EAAC,0FAA0F;oBAAAC,QAAA,gBACvG5I,OAAA;sBAAK2I,SAAS,EAAC,6BAA6B;sBAAAC,QAAA,gBAC1C5I,OAAA,CAAClB,QAAQ;wBAAC6J,SAAS,EAAC;sBAAqC;wBAAAE,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAE,CAAC,eAC5DhJ,OAAA;wBAAM2I,SAAS,EAAC,kCAAkC;wBAAAC,QAAA,EAAGjE,KAAK,CAASsF;sBAAU;wBAAApB,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAO,CAAC;oBAAA;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAClF,CAAC,eACNhJ,OAAA,CAAC/B,KAAK;sBAAC0K,SAAS,EAAE,iBAAiBhE,KAAK,CAACC,MAAM,KAAK,YAAY,GAAG,6BAA6B,GAAG,2BAA2B,EAAG;sBAAAgE,QAAA,EAC9HjE,KAAK,CAACC,MAAM,KAAK,YAAY,GAAG,SAAS,GAAG;oBAAW;sBAAAiE,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACnD,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACL,CAAC,eAENhJ,OAAA;oBAAK2I,SAAS,EAAC,wDAAwD;oBAAAC,QAAA,gBACrE5I,OAAA;sBAAA4I,QAAA,gBACE5I,OAAA,CAAC3C,KAAK;wBAACsL,SAAS,EAAC,uBAAuB;wBAAAC,QAAA,EAAC;sBAAa;wBAAAC,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAO,CAAC,eAC9DhJ,OAAA;wBAAA4I,QAAA,EAAI,IAAIlG,IAAI,CAAEiC,KAAK,CAASoF,aAAa,CAAC,CAACC,cAAc,CAAC;sBAAC;wBAAAnB,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAI,CAAC,EAC9DrE,KAAK,CAASe,cAAc,iBAC5B1F,OAAA;wBAAK2I,SAAS,EAAC,MAAM;wBAAAC,QAAA,eACnB5I,OAAA,CAACV,iBAAiB;0BAChB2N,GAAG,EAAGtI,KAAK,CAASe,cAAe;0BACnCwH,GAAG,EAAC,gBAAgB;0BACpBvE,SAAS,EAAC;wBAAuD;0BAAAE,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAClE;sBAAC;wBAAAH,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OACC,CACN;oBAAA;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACE,CAAC,EAEJrE,KAAK,CAASwI,cAAc,iBAC5BnN,OAAA;sBAAA4I,QAAA,gBACE5I,OAAA,CAAC3C,KAAK;wBAACsL,SAAS,EAAC,uBAAuB;wBAAAC,QAAA,EAAC;sBAAc;wBAAAC,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAO,CAAC,eAC/DhJ,OAAA;wBAAA4I,QAAA,EAAI,IAAIlG,IAAI,CAAEiC,KAAK,CAASwI,cAAc,CAAC,CAACnD,cAAc,CAAC;sBAAC;wBAAAnB,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAAI,CAAC,EAC/DrE,KAAK,CAASsB,eAAe,iBAC7BjG,OAAA;wBAAK2I,SAAS,EAAC,MAAM;wBAAAC,QAAA,eACnB5I,OAAA,CAACV,iBAAiB;0BAChB2N,GAAG,EAAGtI,KAAK,CAASsB,eAAgB;0BACpCiH,GAAG,EAAC,iBAAiB;0BACrBvE,SAAS,EAAC;wBAAuD;0BAAAE,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OAClE;sBAAC;wBAAAH,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OACC,CACN;oBAAA;sBAAAH,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACE,CACN;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACE,CAAC,EAELrE,KAAK,CAACgB,KAAK,iBACV3F,OAAA;oBAAK2I,SAAS,EAAC,qCAAqC;oBAAAC,QAAA,gBAClD5I,OAAA,CAAC3C,KAAK;sBAACsL,SAAS,EAAC,eAAe;sBAAAC,QAAA,EAAC;oBAAK;sBAAAC,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAO,CAAC,eAC9ChJ,OAAA;sBAAG2I,SAAS,EAAC,oBAAoB;sBAAAC,QAAA,EAAEjE,KAAK,CAACgB;oBAAK;sBAAAkD,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAI,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAChD,CACN;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACU;cAAC,GAlDLrE,KAAK,CAACjB,EAAE;gBAAAmF,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAmDb,CACP;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACC;UACN;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACU,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACV;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACI,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACV,CAAC,eAGPhJ,OAAA,CAACrC,MAAM;MAAC0M,IAAI,EAAExH,kBAAmB;MAACyH,YAAY,EAAExH,qBAAsB;MAAA8F,QAAA,eACpE5I,OAAA,CAACpC,aAAa;QAAC+K,SAAS,EAAC,UAAU;QAAAC,QAAA,gBACjC5I,OAAA,CAAClC,YAAY;UAAA8K,QAAA,gBACX5I,OAAA,CAACjC,WAAW;YAAC4K,SAAS,EAAC,6BAA6B;YAAAC,QAAA,GACjDxG,UAAU,KAAK,aAAa,gBAC3BpC,OAAA,CAACd,UAAU;cAACyJ,SAAS,EAAC;YAAS;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,gBAElChJ,OAAA,CAACf,MAAM;cAAC0J,SAAS,EAAC;YAAS;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAC9B,eACDhJ,OAAA;cAAA4I,QAAA,GAAM,SAAO,EAACxG,UAAU,KAAK,aAAa,GAAG,aAAa,GAAG,SAAS,EAAC,QAAM;YAAA;cAAAyG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACzE,CAAC,eACdhJ,OAAA,CAACnC,iBAAiB;YAAA+K,QAAA,GAAC,yBACM,EAAC9G,qBAAqB,aAArBA,qBAAqB,uBAArBA,qBAAqB,CAAEqJ,SAAS;UAAA;YAAAtC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACvC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACR,CAAC,eAEfhJ,OAAA;UAAK2I,SAAS,EAAC,WAAW;UAAAC,QAAA,GAEvB1G,gBAAgB,iBACflC,OAAA;YAAK2I,SAAS,EAAC,+BAA+B;YAAAC,QAAA,gBAC5C5I,OAAA,CAAC3C,KAAK;cAACsL,SAAS,EAAC,mCAAmC;cAAAC,QAAA,EAAC;YAAiB;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eAC9EhJ,OAAA;cAAK2I,SAAS,EAAC,MAAM;cAAAC,QAAA,eACnB5I,OAAA;gBAAG2I,SAAS,EAAC,aAAa;gBAAAC,QAAA,EAAE1G,gBAAgB,CAAC2E,aAAa,IAAI3E,gBAAgB,CAACwE;cAAI;gBAAAmC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACrF,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CACN,eAGDhJ,OAAA;YAAA4I,QAAA,gBACE5I,OAAA,CAAC3C,KAAK;cAACmN,OAAO,EAAC,YAAY;cAAA5B,QAAA,EAAC;YAAe;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACnDhJ,OAAA,CAAC5C,KAAK;cACJsG,EAAE,EAAC,YAAY;cACfwE,IAAI,EAAC,MAAM;cACX4C,KAAK,EAAEtI,UAAW;cAClBkI,QAAQ,EAAGvF,CAAC,IAAK1C,aAAa,CAAC0C,CAAC,CAACG,MAAM,CAACwF,KAAK,CAAE;cAC/ClB,QAAQ,EAAEhI,QAAS;cACnBiJ,QAAQ;cACRlC,SAAS,EAAC;YAAM;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACjB,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACC,CAAC,eAGNhJ,OAAA;YAAA4I,QAAA,gBACE5I,OAAA,CAAC3C,KAAK;cAACmN,OAAO,EAAC,aAAa;cAAA5B,QAAA,EAAC;YAAY;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACjDhJ,OAAA,CAAC5C,KAAK;cACJsG,EAAE,EAAC,aAAa;cAChBwE,IAAI,EAAC,MAAM;cACXuC,MAAM,EAAC,SAAS;cAChBC,QAAQ,EAAGvF,CAAC,IAAK;gBACf,IAAIA,CAAC,CAACG,MAAM,CAACsF,KAAK,IAAIzF,CAAC,CAACG,MAAM,CAACsF,KAAK,CAAC,CAAC,CAAC,EAAE;kBACvCrI,cAAc,CAAC4C,CAAC,CAACG,MAAM,CAACsF,KAAK,CAAC,CAAC,CAAC,CAAC;gBACnC;cACF,CAAE;cACFhB,QAAQ,EAAEhI,QAAS;cACnBiJ,QAAQ;YAAA;cAAAhC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACT,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACC,CAAC,EAGL1G,WAAW,iBACVtC,OAAA;YAAK2I,SAAS,EAAC,MAAM;YAAAC,QAAA,gBACnB5I,OAAA,CAAC3C,KAAK;cAACsL,SAAS,EAAC,oBAAoB;cAAAC,QAAA,EAAC;YAAa;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eAC3DhJ,OAAA;cAAK2I,SAAS,EAAC,+BAA+B;cAAAC,QAAA,eAC5C5I,OAAA;gBACEiN,GAAG,EAAEG,GAAG,CAACC,eAAe,CAAC/K,WAAW,CAAE;gBACtC4K,GAAG,EAAC,SAAS;gBACbvE,SAAS,EAAC;cAAiC;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC5C;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACC,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CACN,eAIDhJ,OAAA;YAAK2I,SAAS,EAAC,4BAA4B;YAAAC,QAAA,gBACzC5I,OAAA,CAAC7C,MAAM;cACL+K,IAAI,EAAC,QAAQ;cACbsB,OAAO,EAAC,SAAS;cACjBG,OAAO,EAAEA,CAAA,KAAM7G,qBAAqB,CAAC,KAAK,CAAE;cAC5C8G,QAAQ,EAAEhI,QAAS;cAAAgH,QAAA,EACpB;YAED;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,eACThJ,OAAA,CAAC7C,MAAM;cACLwM,OAAO,EAAEhC,iBAAkB;cAC3BiC,QAAQ,EAAE,CAACtH,WAAW,IAAI,CAACE,UAAU,IAAIZ,QAAS;cAAAgH,QAAA,EAEjDhH,QAAQ,gBACP5B,OAAA,CAAAE,SAAA;gBAAA0I,QAAA,gBACE5I,OAAA,CAACb,OAAO;kBAACwJ,SAAS,EAAC;gBAA2B;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,gBAEnD;cAAA,eAAE,CAAC,GAEH;YACD;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACK,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACO;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACV,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAElB;AAACzI,EAAA,CAnnCQJ,yBAAyB;AAAAmN,EAAA,GAAzBnN,yBAAyB;AAqnClC,OAAO,MAAMoN,gBAAgB,GAAG/N,gBAAgB,CAACW,yBAAyB,CAAC;AAACqN,GAAA,GAA/DD,gBAAgB;AAAA,IAAAD,EAAA,EAAAE,GAAA;AAAAC,YAAA,CAAAH,EAAA;AAAAG,YAAA,CAAAD,GAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}